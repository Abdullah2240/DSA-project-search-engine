{"doc_id": 0, "url": "https://www.jstage.jst.go.jp/article/pfr/15/0/15_2402039/_pdf", "title": "Radiation Resistant Camera System for Monitoring Deuterium Plasma Discharges in the Large Helical Device", "title_tokens": ["radiation", "resistant", "camera", "system", "for", "monitoring", "deuterium", "plasma", "discharges", "in", "the", "large", "helical", "device"], "page_rank": {"cited_by_count": 801215}, "body_tokens": ["plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "radiation", "resistant", "camera", "system", "for", "monitoring", "deuterium", "plasma", "discharges", "in", "the", "large", "helical", "device", "mamoru", "shoji", "and", "lhd", "experiment", "group", "national", "institute", "for", "fusion", "science", "national", "institutes", "of", "natural", "sciences", "toki", "509", "5292", "japan", "received", "28", "november", "2019", "accepted", "may", "2020", "radiation", "resistant", "camera", "system", "was", "constructed", "for", "monitoring", "deuterium", "plasma", "discharges", "in", "the", "large", "helical", "device", "lhd", "this", "system", "has", "contributed", "to", "safe", "operation", "during", "two", "experimental", "campaigns", "withoutserious", "problems", "due", "to", "radiation", "neutrons", "and", "gamma", "rays", "the", "cameras", "steadily", "functioned", "even", "in", "the", "plasmadischarge", "with", "the", "maximum", "neutron", "emission", "rate", "in", "fy", "2017", "though", "some", "bright", "specks", "temporarily", "appearedon", "the", "images", "the", "cameras", "have", "been", "installed", "in", "shield", "boxes", "which", "consist", "of", "lead", "boxes", "covered", "with", "10", "borated", "polyethylene", "blocks", "in", "all", "directions", "for", "optimizing", "the", "design", "of", "the", "shield", "box", "the", "radiation", "uxdistribution", "was", "calculated", "by", "mcnp", "code", "which", "reveals", "the", "reduction", "of", "the", "radiation", "ux", "and", "the", "changeof", "the", "energy", "spectra", "in", "the", "shield", "box", "thanks", "to", "the", "optimization", "signi", "cant", "extension", "of", "the", "lifetime", "of", "the", "cameras", "has", "been", "realized", "investigation", "of", "the", "in", "uence", "of", "the", "radiation", "on", "the", "ccd", "image", "sensor", "shows", "that", "the", "number", "of", "bright", "specks", "generally", "increases", "with", "the", "radiation", "ux", "to", "the", "camera", "which", "also", "indicates", "thatsome", "bright", "specks", "disappear", "by", "the", "self", "annealing", "process", "on", "the", "image", "sensor", "this", "phenomenon", "also", "highlycontributes", "to", "the", "further", "extension", "of", "the", "lifetime", "of", "the", "radiation", "resistant", "cameras", "circlecopyrt2020", "the", "japan", "society", "of", "plasma", "science", "and", "nuclear", "fusion", "research", "keywords", "radiation", "resistant", "camera", "neutron", "gamma", "ray", "ccd", "deuterium", "plasma", "lhd", "doi", "10", "1585", "pfr", "15", "2402039", "introduction", "the", "rst", "deuterium", "experimental", "campaign", "started", "in", "march", "2017", "in", "the", "large", "helical", "device", "lhd", "and", "it", "continued", "for", "the", "following", "four", "months", "neu", "trons", "are", "yielded", "in", "deuterium", "plasmas", "and", "gamma", "raysare", "also", "collaterally", "yielded", "by", "interactions", "of", "neutronswith", "the", "peripheral", "components", "and", "the", "torus", "hall", "be", "fore", "the", "experimental", "campaign", "about", "thirty", "chargecoupled", "device", "ccd", "cameras", "which", "had", "been", "directlymounted", "at", "viewports", "on", "the", "vacuum", "vessel", "have", "beenused", "for", "monitoring", "lhd", "plasmas", "and", "plasma", "wall", "inter", "actions", "it", "has", "been", "well", "known", "that", "the", "ccd", "imagesensors", "are", "very", "sensitive", "to", "and", "easily", "damaged", "by", "radi", "ation", "neutrons", "and", "rays", "in", "the", "experimental", "campaign", "it", "is", "predicted", "that", "the", "cameras", "must", "be", "replacedat", "frequent", "intervals", "because", "of", "the", "following", "two", "facts", "one", "is", "that", "the", "estimated", "maximum", "neutron", "uence", "at", "theviewports", "is", "about", "10", "9n", "cm2per", "one", "deuterium", "plasma", "discharge", "the", "other", "fact", "is", "that", "the", "number", "of", "dam", "aged", "ccd", "image", "sensors", "per", "this", "neutron", "uence", "is", "esti", "mated", "to", "be", "about", "10", "3pixels", "which", "is", "derived", "from", "the", "experimental", "data", "reported", "in", "the", "reference", "these", "twofacts", "result", "in", "that", "all", "the", "image", "sensors", "in", "standard", "ccdcameras", "having", "10", "5pixels", "are", "damaged", "in", "about", "80", "deuterium", "plasma", "discharges", "this", "estimation", "means", "thatall", "the", "cameras", "have", "to", "be", "replaced", "by", "two", "times", "per", "one", "author", "mail", "shoji", "nifs", "ac", "jp", "this", "article", "is", "based", "on", "the", "presentation", "at", "the", "28th", "international", "toki", "conference", "on", "plasma", "and", "fusion", "research", "itc28", "day", "plasma", "discharge", "operation", "in", "lhd", "producing", "large", "amounts", "of", "radioactive", "wastes", "and", "signi", "cantly", "lowers", "theoperating", "rate", "thus", "it", "was", "an", "urgent", "task", "to", "develop", "ra", "diation", "resistant", "camera", "system", "for", "monitoring", "deuteriumplasma", "discharges", "in", "the", "next", "section", "the", "speci", "cation", "of", "the", "radiation", "resistant", "camera", "system", "is", "described", "analyses", "of", "gen", "eral", "monte", "carlo", "particle", "transport", "simulation", "codeversion", "mcnp", "for", "optimizing", "the", "design", "of", "the", "shieldbox", "for", "protecting", "the", "cameras", "from", "the", "radiation", "is", "pre", "sented", "in", "section", "the", "successful", "results", "of", "the", "acquiredplasma", "images", "at", "the", "plasma", "discharge", "with", "the", "maximumneutron", "emission", "yield", "is", "depicted", "in", "section", "in", "the", "nextsection", "the", "investigation", "of", "the", "in", "uence", "of", "the", "radiationon", "the", "image", "sensor", "is", "presented", "which", "will", "provide", "valu", "able", "information", "for", "applying", "the", "ccd", "camera", "in", "futurenuclear", "fusion", "reactor", "plants", "setup", "of", "the", "radiation", "resistant", "camera", "system", "for", "protecting", "the", "cameras", "from", "neutrons", "and", "gamma", "rays", "ve", "shield", "boxes", "were", "installed", "on", "lhd", "diagnosticstages", "in", "the", "torus", "hall", "as", "illustrated", "in", "fig", "these", "lo", "cations", "are", "far", "from", "the", "lhd", "center", "by", "more", "than", "12", "inorder", "to", "reduce", "the", "in", "uence", "of", "high", "energy", "neutrons", "tothe", "cameras", "the", "cameras", "are", "covered", "with", "lead", "pb", "box", "15", "mm", "in", "thickness", "surrounded", "with", "10", "boratedpolyethylene", "blocks", "100", "mm", "in", "thickness", "in", "all", "directionswhich", "is", "the", "maximum", "tolerable", "thickness", "due", "the", "spatial", "circlecopyrt2020", "the", "japan", "society", "of", "plasma", "science", "and", "nuclear", "fusion", "research2402039", "plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "fig", "the", "top", "view", "of", "the", "setup", "of", "the", "radiation", "resistant", "camera", "system", "for", "monitoring", "deuterium", "plasmas", "in", "lhd", "limit", "on", "the", "site", "the", "polyethylene", "blocks", "are", "for", "protect", "ing", "the", "cameras", "from", "the", "neutrons", "and", "the", "lead", "box", "is", "forreducing", "the", "gamma", "ray", "ux", "secondly", "yielded", "by", "the", "in", "teractions", "of", "neutrons", "with", "the", "polyethylene", "blocks", "twobended", "slit", "halls", "on", "the", "up", "and", "bottom", "sides", "are", "opened", "forair", "ventilation", "and", "as", "ducts", "for", "power", "supply", "cables", "image", "bers", "signal", "lines", "and", "optical", "bers", "etc", "the", "lead", "box", "in", "cludes", "optics", "for", "connecting", "the", "image", "bers", "to", "the", "ccdcameras", "toshiba", "ik", "cu44", "ik", "c44", "ik", "m44", "hitachikp", "d20a", "and", "kp", "d20b", "camera", "controllers", "toshibaik", "um44", "media", "converters", "nanahoshi", "kagaku", "vp", "205sc", "and", "serial", "device", "server", "moxa", "nport5410", "forcontrolling", "the", "cameras", "eight", "optical", "lenses", "were", "mounted", "at", "the", "viewports", "on", "the", "vacuum", "vessel", "in", "the", "rst", "deuterium", "experimen", "tal", "campaign", "in", "fy", "2017", "in", "the", "next", "experimental", "cam", "paign", "in", "fy", "2018", "three", "optical", "lenses", "were", "additionallymounted", "plasma", "images", "at", "the", "viewports", "are", "transferredto", "the", "cameras", "via", "the", "radiation", "resistant", "image", "bers", "with30", "000", "pixels", "and", "approximately", "10", "20", "in", "length", "thevideo", "output", "signal", "ntsc", "from", "the", "camera", "controllersare", "transferred", "to", "the", "control", "room", "via", "the", "media", "convert", "ers", "through", "the", "optical", "bers", "the", "signal", "is", "captured", "by", "avideo", "encoder", "and", "stored", "in", "raid", "disks", "or", "data", "acquisi", "tion", "daq", "system", "for", "lhd", "optimization", "of", "the", "design", "of", "the", "shield", "box", "the", "general", "monte", "carlo", "particle", "transport", "simu", "lation", "code", "version", "mcnp", "was", "applied", "for", "op", "timizing", "the", "structure", "of", "the", "shield", "box", "in", "which", "an", "lhdmodel", "for", "one", "helical", "coil", "pitch", "angle", "36", "degrees", "in", "thetoroidal", "direction", "is", "included", "with", "cylindrical", "torus", "hallmodel", "for", "calculating", "the", "radiation", "ux", "distribution", "in", "thehall", "figure", "illustrates", "the", "side", "and", "top", "cross", "sectionalview", "of", "the", "three", "dimensional", "model", "of", "the", "shield", "boxwhich", "consists", "of", "lead", "box", "and", "10", "borated", "polyethy", "lene", "blocks", "with", "the", "slit", "halls", "in", "this", "model", "the", "helical", "fig", "the", "side", "and", "top", "cross", "sectional", "view", "of", "the", "three", "dimensional", "model", "of", "the", "shield", "box", "for", "the", "mcnp", "code", "symmetry", "of", "the", "plasma", "and", "the", "peripheral", "components", "is", "assumed", "neutrons", "with", "an", "energy", "of", "45", "mev", "by", "thebulk", "deuterium", "deuterium", "reaction", "are", "yielded", "from", "circu", "lar", "shaped", "torus", "plasma", "locating", "at", "the", "center", "of", "the", "vac", "uum", "vessel", "figures", "and", "give", "the", "simulation", "result", "of", "the", "vertical", "cross", "section", "of", "the", "neutron", "and", "gamma", "ray", "ux", "distribution", "in", "the", "torus", "hall", "at", "toroidal", "angle", "crossing", "the", "shield", "box", "for", "neutron", "emission", "rate", "of", "re", "spectively", "this", "shield", "box", "is", "chosen", "as", "representativeone", "for", "the", "simulation", "because", "of", "no", "signi", "cant", "toroidalvariation", "of", "neutron", "ux", "in", "the", "torus", "hall", "around", "lhd", "figure", "shows", "that", "the", "neutron", "ux", "is", "reduced", "at", "theposition", "of", "the", "shield", "box", "by", "approximately", "one", "order", "ofmagnitude", "compared", "to", "that", "in", "the", "vacuum", "vessel", "on", "theother", "hand", "as", "illustrated", "in", "fig", "while", "the", "gamma", "ray", "ux", "decreases", "by", "about", "one", "order", "of", "magnitude", "around", "theshield", "box", "the", "10", "borated", "polyethylene", "blocks", "enhancethe", "gamma", "ray", "ux", "at", "the", "lhd", "side", "in", "the", "shield", "box", "thissimulation", "result", "indicates", "that", "lead", "box", "is", "essential", "for", "pro", "tecting", "the", "cameras", "from", "the", "enhanced", "gamma", "rays", "the", "side", "and", "top", "cross", "sectional", "view", "of", "the", "neutron", "and", "gamma", "ray", "ux", "distribution", "around", "the", "shield", "box", "2are", "presented", "in", "figs", "and", "these", "simulationsshow", "that", "the", "neutron", "and", "gamma", "ray", "ux", "in", "the", "leadbox", "is", "reduced", "by", "factor", "of", "about", "30", "and", "10", "comparedto", "those", "around", "the", "shield", "box", "lhd", "side", "respectively", "figures", "and", "present", "the", "calculated", "neutron", "andgamma", "ray", "spectra", "at", "the", "shield", "box", "respectively", "thesolid", "black", "lines", "represent", "the", "background", "spectra", "whichis", "calculated", "for", "no", "shield", "box", "the", "colored", "dotted", "linesare", "the", "calculated", "spectra", "at", "the", "inside", "of", "the", "lead", "box", "showing", "that", "the", "neutron", "ux", "is", "attenuated", "in", "the", "wide", "neu", "tron", "energy", "range", "by", "factor", "of", "about", "40", "compared", "to", "thebackground", "ux", "the", "gamma", "ray", "ux", "in", "the", "high", "energy", "2402039", "plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "fig", "the", "simulation", "of", "the", "vertical", "cross", "section", "of", "the", "neutron", "and", "the", "gamma", "ray", "ux", "distribution", "in", "the", "torus", "hall", "for", "neutron", "emission", "rate", "of", "in", "the", "lhd", "deuterium", "plasma", "range", "mev", "is", "reduced", "by", "factor", "of", "about", "or", "and", "the", "ux", "in", "the", "low", "energy", "range", "4m", "lowered", "by", "about", "one", "order", "of", "magnitude", "compared", "to", "theback", "ground", "ux", "solid", "black", "line", "the", "shielding", "perfor", "mance", "of", "the", "lead", "box", "for", "the", "gamma", "rays", "is", "investigatedby", "changing", "the", "thickness", "of", "the", "lead", "plates", "componentsof", "the", "lead", "box", "colored", "broken", "lines", "in", "figs", "and", "give", "the", "calculated", "neutron", "and", "gamma", "ray", "spectra", "inthe", "shield", "box", "in", "the", "case", "where", "the", "thickness", "of", "the", "lead", "plates", "is", "changed", "from", "to", "25", "mm", "the", "calculationsshow", "that", "the", "thicker", "lead", "plates", "are", "ective", "for", "reducing", "gamma", "ray", "ux", "in", "the", "high", "energy", "range", "the", "incrementof", "the", "reduction", "ratio", "for", "25", "mm", "is", "about", "20", "compared", "tothat", "for", "15", "mm", "lead", "plate", "is", "heavy", "and", "toxic", "materialwhich", "has", "to", "be", "handled", "with", "care", "considering", "this", "com", "plicatedness", "the", "thickness", "of", "the", "lead", "plate", "adopted", "in", "the", "2402039", "plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "fig", "the", "simulation", "of", "the", "side", "and", "top", "cross", "section", "of", "the", "neutron", "and", "the", "gamma", "ray", "ux", "distribution", "in", "the", "shield", "box", "shield", "box", "15", "mm", "seems", "to", "be", "reasonable", "the", "neutron", "and", "gamma", "ray", "spectra", "at", "space", "be", "tween", "polyethylene", "blocks", "and", "the", "lead", "box", "indicated", "infig", "are", "shown", "as", "blue", "broken", "line", "in", "figs", "and", "respectively", "the", "gamma", "ray", "ux", "in", "the", "low", "energyrange", "is", "higher", "than", "that", "of", "the", "background", "ux", "solidblack", "line", "this", "is", "because", "the", "gamma", "rays", "are", "yieldedin", "the", "polyethylene", "blocks", "in", "the", "lhd", "side", "as", "shown", "infig", "on", "the", "other", "hand", "the", "ux", "in", "the", "high", "energyrange", "is", "lower", "than", "the", "background", "ux", "by", "more", "than", "factor", "of", "two", "although", "the", "ux", "is", "higher", "than", "that", "inside", "ofthe", "lead", "box", "with", "the", "thickness", "of", "15", "25", "mm", "this", "simu", "lation", "result", "suggests", "that", "the", "space", "between", "the", "polyethy", "lene", "blocks", "and", "the", "lead", "box", "which", "is", "located", "behind", "leadplates", "from", "the", "lhd", "side", "can", "be", "ectively", "used", "for", "space", "for", "protecting", "devices", "from", "high", "energy", "gamma", "rays", "not", "from", "low", "energy", "rays", "2402039", "plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "fig", "the", "calculated", "neutron", "spectra", "at", "the", "shield", "box", "and", "the", "calculated", "gamma", "ray", "spectra", "at", "the", "shield", "box", "the", "solid", "black", "lines", "represent", "the", "background", "spectra", "the", "colored", "dotted", "lines", "present", "the", "spectra", "in", "the", "lead", "box", "with", "various", "thicknesses", "of", "the", "lead", "plates", "the", "blue", "broken", "lines", "indicates", "the", "spectra", "at", "space", "between", "polyethylene", "blocks", "and", "the", "lead", "box", "images", "in", "the", "deuterium", "plasma", "discharge", "with", "the", "maximumneutron", "emission", "rate", "in", "the", "deuterium", "plasma", "discharges", "in", "the", "experimen", "tal", "campaign", "in", "fy", "2017", "the", "maximum", "neutron", "emissionrate", "of", "10", "15", "was", "achieved", "plasma", "images", "taken", "with", "the", "radiation", "resistant", "camera", "systems", "at", "the", "maxi", "mum", "neutron", "emission", "rate", "are", "shown", "in", "fig", "the", "posi", "tions", "of", "the", "optical", "lenses", "for", "the", "cameras", "are", "illustrated", "infig", "from", "the", "simulation", "results", "by", "the", "mcnp", "code", "infig", "the", "neutron", "and", "gamma", "ray", "uxes", "inside", "of", "the", "leadbox", "are", "calculated", "to", "be", "10", "7and", "10", "7cm", "respectively", "it", "was", "found", "that", "the", "cameras", "operate", "withoutany", "problems", "even", "in", "the", "plasma", "discharge", "with", "the", "max", "imum", "neutron", "emission", "rate", "some", "small", "bright", "specks", "which", "are", "indicated", "by", "arrows", "appeared", "in", "the", "images", "asshown", "in", "fig", "while", "these", "specks", "disappeared", "in", "thenext", "frame", "new", "bright", "specks", "emerged", "at", "di", "erent", "posi", "tions", "these", "temporal", "bright", "specks", "have", "not", "disturbed", "themonitoring", "of", "the", "plasma", "proving", "the", "durability", "of", "the", "ra", "diation", "resistant", "camera", "systems", "in", "the", "deuterium", "plasmadischarges", "investigation", "of", "the", "in", "uence", "of", "the", "cumulative", "radiation", "flux", "on", "theimage", "sensor", "it", "was", "believed", "that", "the", "bright", "specks", "on", "ccd", "image", "sensors", "permanently", "remain", "after", "the", "exposure", "to", "radia", "tion", "ux", "positive", "correlation", "between", "the", "number", "ofthe", "specks", "and", "the", "cumulative", "exposed", "neutron", "ux", "wasreported", "the", "background", "images", "which", "are", "taken", "be", "fore", "the", "ignition", "of", "plasma", "discharges", "are", "good", "indicatorto", "check", "the", "in", "uence", "of", "the", "radiation", "on", "the", "image", "sen", "sor", "the", "change", "of", "the", "background", "image", "as", "the", "increaseof", "the", "cumulative", "radiation", "ux", "was", "investigated", "the", "ab", "solute", "neutron", "emission", "yield", "has", "been", "routinely", "monitoredwith", "neutron", "diagnostic", "system", "the", "radiation", "ux", "ex", "posed", "to", "the", "camera", "system", "is", "derived", "by", "multiplying", "thesimulation", "result", "fig", "by", "the", "observed", "emission", "yield", "figures", "and", "present", "the", "change", "of", "the", "backgroundimages", "as", "the", "cumulative", "radiation", "uxes", "in", "the", "two", "ex", "perimental", "campaigns", "fy", "2017", "and", "fy", "2018", "respec", "tively", "the", "images", "taken", "with", "the", "camera", "hitachi", "kp", "d20b", "mounted", "at", "the", "tangential", "port", "are", "shown", "as", "arepresentative", "for", "highlighting", "the", "bright", "specks", "bright", "ness", "and", "contrast", "of", "the", "images", "are", "enhanced", "the", "guresclearly", "show", "that", "the", "number", "of", "specks", "generally", "increaseswith", "the", "cumulative", "radiation", "ux", "the", "parameters", "nand", "are", "the", "cumulative", "neutron", "and", "gamma", "ray", "uxes", "ex", "posed", "to", "the", "cameras", "in", "each", "experimental", "campaign", "re", "spectively", "the", "camera", "was", "turned", "at", "the", "end", "of", "the", "ex", "perimental", "campaign", "in", "fy2017", "and", "it", "was", "turned", "on", "be", "fore", "the", "next", "campaign", "in", "fy", "2018", "the", "number", "of", "specksat", "the", "beginning", "in", "fy", "2018", "left", "gure", "in", "fig", "islower", "than", "that", "at", "the", "end", "of", "the", "previous", "campaign", "right", "gure", "in", "fig", "for", "example", "one", "of", "the", "specks", "appear", "ing", "in", "fy", "2017", "indicated", "by", "blue", "arrow", "disappeared", "atthe", "beginning", "in", "fy2018", "this", "phenomenon", "can", "be", "ex", "plained", "by", "the", "so", "called", "self", "annealing", "which", "was", "reportedin", "the", "ccd", "camera", "mounted", "in", "the", "jet", "tokamak", "10", "inlhd", "this", "self", "annealing", "is", "found", "in", "some", "pixels", "even", "in", "2402039", "plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "fig", "plasma", "images", "taken", "with", "the", "radiation", "resistant", "camera", "systems", "at", "the", "time", "of", "the", "maximum", "neutron", "emission", "rate", "in", "deuterium", "plasma", "discharge", "in", "fy", "2017", "fig", "the", "change", "of", "the", "background", "images", "taken", "before", "the", "ignition", "of", "the", "plasma", "discharges", "as", "the", "cumulative", "radiation", "uxes", "in", "the", "two", "experimental", "campaigns", "fy", "2017", "and", "fy", "2018", "respectively", "2402039", "plasma", "and", "fusion", "research", "regular", "articles", "olume", "15", "2402039", "2020", "one", "experimental", "campaign", "as", "shown", "by", "an", "orange", "arrow", "in", "fig", "the", "self", "annealing", "has", "highly", "contributed", "to", "theextension", "of", "the", "lifetime", "of", "the", "camera", "systems", "summary", "radiation", "resistant", "camera", "systems", "for", "monitoring", "deuterium", "plasma", "discharges", "have", "been", "successfully", "con", "structed", "investigation", "using", "the", "mcnp", "code", "reveals", "thatthe", "neutron", "and", "gamma", "ray", "uxes", "in", "the", "lead", "box", "are", "re", "duced", "by", "factor", "of", "about", "30", "and", "10", "compared", "to", "thosearound", "the", "shield", "box", "respectively", "the", "calculations", "of", "theenergy", "spectra", "show", "that", "the", "neutron", "ux", "decreases", "in", "allenergy", "ranges", "by", "more", "than", "one", "order", "of", "magnitude", "and", "the", "gamma", "ray", "ux", "in", "the", "high", "energy", "range", "is", "reduced", "by", "factor", "of", "two", "or", "three", "although", "the", "ux", "in", "the", "lowenergy", "range", "is", "signi", "cantly", "lowered", "by", "about", "one", "orderof", "magnitude", "the", "simulation", "indicates", "that", "the", "thickness", "15", "mm", "of", "the", "lead", "plates", "is", "reasonable", "because", "the", "thickerplates", "25", "mm", "lower", "the", "gamma", "ray", "ux", "in", "the", "high", "en", "ergy", "range", "only", "by", "about", "20", "the", "radiation", "resistant", "cam", "eras", "have", "succeeded", "in", "operating", "without", "serious", "problemsin", "the", "deuterium", "plasma", "discharge", "with", "the", "maximum", "neu", "tron", "emission", "rate", "though", "some", "temporary", "bright", "specksappeared", "on", "the", "images", "the", "investigation", "of", "the", "change", "ofthe", "background", "images", "in", "the", "two", "experimental", "campaignsin", "fy", "2017", "and", "2018", "shows", "that", "the", "number", "of", "specks", "gen", "erally", "increases", "with", "the", "cumulative", "radiation", "ux", "and", "in", "dicates", "that", "some", "specks", "disappear", "by", "self", "annealing", "thisphenomenon", "has", "highly", "contributed", "to", "the", "signi", "cant", "ex", "tension", "of", "the", "lifetime", "of", "the", "cameras", "in", "deuterium", "experi", "mental", "campaigns", "in", "lhd", "acknowledgments", "this", "work", "is", "performed", "under", "the", "auspices", "of", "the", "nifs", "budgets", "ufex301", "and", "ulpp801", "the", "author", "would", "like", "to", "thank", "dr", "ogawa", "and", "prof", "nishitanifor", "the", "use", "of", "the", "computational", "resource", "for", "the", "mcnpcode", "he", "is", "also", "grateful", "for", "the", "support", "for", "computingthe", "neutron", "and", "gamma", "ray", "ux", "in", "the", "shield", "box", "usingthe", "mcnp", "code", "and", "expresses", "special", "thanks", "to", "the", "nifstechnical", "sta", "for", "their", "support", "for", "the", "installation", "of", "the", "radiation", "resistant", "camera", "system", "and", "the", "shield", "box", "in", "thelhd", "torus", "hall", "takeiri", "et", "al", "ieee", "trans", "plasma", "sci", "46", "2348", "2018", "nishitani", "et", "al", "plasma", "fusion", "res", "14", "3405048", "2019", "shoji", "et", "al", "nucl", "fusion", "55", "053014", "2015", "shoji", "et", "al", "plasma", "fusion", "res", "series", "440", "2000", "tanimura", "et", "al", "258", "263", "1812", "1998", "nishitani", "et", "al", "plasma", "fusion", "res", "11", "2405057", "2016", "pelowits", "ed", "mcnp6", "users", "manual", "la", "cp", "13", "00634", "los", "alamos", "national", "laboratory", "2013", "nishitani", "et", "al", "progress", "in", "nuclear", "science", "and", "tech", "nology", "48", "2019", "isobe", "et", "al", "ieee", "trans", "plasma", "sci", "46", "2050", "2018", "10", "huber", "et", "al", "fusion", "eng", "des", "123", "669", "2017", "2402039"], "citations": ["[1]", "[2]", "[5]", "[6]", "[7]", "[8]", "[9]", "[10]", "[3]", "[4]"]}
{"doc_id": 1, "url": "https://www.jbc.org/article/S0021-9258(19)52451-6/pdf", "title": "PROTEIN MEASUREMENT WITH THE FOLIN PHENOL REAGENT", "title_tokens": ["protein", "measurement", "with", "the", "folin", "phenol", "reagent"], "page_rank": {"cited_by_count": 316796}}
{"doc_id": 2, "url": "https://www.tandfonline.com/doi/abs/10.1191/1478088706qp063oa", "title": "Using thematic analysis in psychology", "title_tokens": ["using", "thematic", "analysis", "in", "psychology"], "page_rank": {"cited_by_count": 162353}}
{"doc_id": 3, "url": "https://link.springer.com/content/pdf/10.1023/A:1010933404324.pdf", "title": "Random Forests", "title_tokens": ["random", "forests"], "page_rank": {"cited_by_count": 115020}, "body_tokens": ["machine", "learning", "45", "32", "2001", "circlecopyrt2001", "kluwer", "academic", "publishers", "manufactured", "in", "the", "netherlands", "random", "forests", "leo", "breiman", "statistics", "department", "university", "of", "california", "berkeley", "ca", "94720", "editor", "robert", "schapire", "abstract", "random", "forests", "are", "combination", "of", "tree", "predictors", "such", "that", "each", "tree", "depends", "on", "the", "values", "of", "random", "vector", "sampled", "independently", "and", "with", "the", "same", "distribution", "for", "all", "trees", "in", "the", "forest", "the", "generalizationerror", "for", "forests", "converges", "to", "limit", "as", "the", "number", "of", "trees", "in", "the", "forest", "becomes", "large", "the", "generalizationerror", "of", "forest", "of", "tree", "classi", "ers", "depends", "on", "the", "strength", "of", "the", "individual", "trees", "in", "the", "forest", "and", "the", "corre", "lation", "between", "them", "using", "random", "selection", "of", "features", "to", "split", "each", "node", "yields", "error", "rates", "that", "comparefavorably", "to", "adaboost", "freund", "schapire", "machine", "learning", "proceedings", "of", "the", "thirteenth", "interna", "tional", "conference", "148", "156", "but", "are", "more", "robust", "with", "respect", "to", "noise", "internal", "estimates", "monitor", "error", "strength", "and", "correlation", "and", "these", "are", "used", "to", "show", "the", "response", "to", "increasing", "the", "number", "of", "features", "used", "inthe", "splitting", "internal", "estimates", "are", "also", "used", "to", "measure", "variable", "importance", "these", "ideas", "are", "also", "applicable", "toregression", "keywords", "classi", "cation", "regression", "ensemble", "random", "forests", "introductionsigni", "cant", "improvements", "in", "classi", "cation", "accuracy", "have", "resulted", "from", "growing", "an", "ensemble", "of", "trees", "and", "letting", "them", "vote", "for", "the", "most", "popular", "class", "in", "order", "to", "grow", "these", "ensembles", "often", "random", "vectors", "are", "generated", "that", "govern", "the", "growth", "of", "each", "tree", "in", "the", "ensemble", "an", "early", "example", "is", "bagging", "breiman", "1996", "where", "to", "grow", "each", "tree", "random", "selection", "without", "replacement", "is", "made", "from", "the", "examples", "in", "the", "training", "set", "another", "example", "is", "random", "split", "selection", "dietterich", "1998", "where", "at", "each", "node", "the", "split", "is", "selected", "at", "random", "from", "among", "the", "kbest", "splits", "breiman", "1999", "generates", "new", "training", "sets", "by", "randomizing", "the", "outputs", "in", "the", "original", "training", "set", "another", "approach", "is", "to", "selectthe", "training", "set", "from", "random", "set", "of", "weights", "on", "the", "examples", "in", "the", "training", "set", "ho", "1998", "has", "written", "number", "of", "papers", "on", "the", "random", "subspace", "method", "which", "does", "randomselection", "of", "subset", "of", "features", "to", "use", "to", "grow", "each", "tree", "in", "an", "important", "paper", "on", "written", "character", "recognition", "amit", "and", "geman", "1997", "de", "ne", "large", "number", "of", "geometric", "features", "and", "search", "over", "random", "selection", "of", "these", "for", "thebest", "split", "at", "each", "node", "this", "latter", "paper", "has", "been", "in", "uential", "in", "my", "thinking", "the", "common", "element", "in", "all", "of", "these", "procedures", "is", "that", "for", "the", "kth", "tree", "random", "vector", "theta1", "kis", "generated", "independent", "of", "the", "past", "random", "vectors", "theta11", "theta1k", "1but", "with", "the", "same", "distribution", "and", "tree", "is", "grown", "using", "the", "training", "set", "and", "theta1k", "resulting", "in", "classi", "er", "theta1k", "where", "xis", "an", "input", "vector", "for", "instance", "in", "bagging", "the", "random", "vector", "theta1is", "breiman", "generated", "as", "the", "counts", "in", "nboxes", "resulting", "from", "ndarts", "thrown", "at", "random", "at", "the", "boxes", "where", "nis", "number", "of", "examples", "in", "the", "training", "set", "in", "random", "split", "selection", "theta1consists", "of", "number", "of", "independent", "random", "integers", "between", "and", "the", "nature", "and", "dimensionality", "of", "theta1depends", "on", "its", "use", "in", "tree", "construction", "after", "large", "number", "of", "trees", "is", "generated", "they", "vote", "for", "the", "most", "popular", "class", "we", "call", "these", "procedures", "random", "forests", "de", "nition", "random", "forest", "is", "classi", "er", "consisting", "of", "collection", "of", "tree", "structured", "classi", "ers", "theta1k", "where", "the", "theta1k", "are", "independent", "identically", "distributed", "random", "vectors", "and", "each", "tree", "casts", "unit", "vote", "for", "the", "most", "popular", "class", "at", "input", "outline", "of", "paper", "section", "gives", "some", "theoretical", "background", "for", "random", "forests", "use", "of", "the", "strong", "law", "of", "large", "numbers", "shows", "that", "they", "always", "converge", "so", "that", "over", "tting", "is", "not", "problem", "we", "give", "simpli", "ed", "and", "extended", "version", "of", "the", "amit", "and", "geman", "1997", "analysis", "to", "show", "that", "the", "accuracy", "of", "random", "forest", "depends", "on", "the", "strength", "of", "the", "indivi", "dual", "tree", "classi", "ers", "and", "measure", "of", "the", "dependence", "between", "them", "see", "section", "for", "de", "nitions", "section", "introduces", "forests", "using", "the", "random", "selection", "of", "features", "at", "each", "node", "to", "determine", "the", "split", "an", "important", "question", "is", "how", "many", "features", "to", "select", "at", "each", "node", "forguidance", "internal", "estimates", "of", "the", "generalization", "error", "classi", "er", "strength", "and", "dependence", "are", "computed", "these", "are", "called", "out", "of", "bag", "estimates", "and", "are", "reviewed", "in", "section", "section5", "and", "give", "empirical", "results", "for", "two", "different", "forms", "of", "random", "features", "the", "rst", "uses", "random", "selection", "from", "the", "original", "inputs", "the", "second", "uses", "random", "linear", "combinations", "ofinputs", "the", "results", "compare", "favorably", "to", "adaboost", "the", "results", "turn", "out", "to", "be", "insensitive", "to", "the", "number", "of", "features", "selected", "to", "split", "each", "node", "usually", "selecting", "one", "or", "two", "features", "gives", "near", "optimum", "results", "to", "explore", "this", "and", "relateit", "to", "strength", "and", "correlation", "an", "empirical", "study", "is", "carried", "out", "in", "section", "adaboost", "has", "no", "random", "elements", "and", "grows", "an", "ensemble", "of", "trees", "by", "successive", "reweight", "ings", "of", "the", "training", "set", "where", "the", "current", "weights", "depend", "on", "the", "past", "history", "of", "the", "ensembleformation", "but", "just", "as", "deterministic", "random", "number", "generator", "can", "give", "good", "imitationof", "randomness", "my", "belief", "is", "that", "in", "its", "later", "stages", "adaboost", "is", "emulating", "random", "forest", "evidence", "for", "this", "conjecture", "is", "given", "in", "section", "important", "recent", "problems", "medical", "diagnosis", "and", "document", "retrieval", "often", "have", "the", "property", "that", "there", "are", "many", "input", "variables", "often", "in", "the", "hundreds", "or", "thousands", "with", "eachone", "containing", "only", "small", "amount", "of", "information", "single", "tree", "classi", "er", "will", "then", "have", "accuracy", "only", "slightly", "better", "than", "random", "choice", "of", "class", "but", "combining", "trees", "grownusing", "random", "features", "can", "produce", "improved", "accuracy", "in", "section", "we", "experiment", "on", "asimulated", "data", "set", "with", "000", "input", "variables", "000", "examples", "in", "the", "training", "set", "and", "000example", "test", "set", "accuracy", "comparable", "to", "the", "bayes", "rate", "is", "achieved", "in", "many", "applications", "understanding", "of", "the", "mechanism", "of", "the", "random", "forest", "black", "box", "is", "needed", "section", "10", "makes", "start", "on", "this", "by", "computing", "internal", "estimates", "of", "variableimportance", "and", "binding", "these", "together", "by", "reuse", "runs", "random", "forests", "section", "11", "looks", "at", "random", "forests", "for", "regression", "bound", "for", "the", "mean", "squared", "gener", "alization", "error", "is", "derived", "that", "shows", "that", "the", "decrease", "in", "error", "from", "the", "individual", "trees", "inthe", "forest", "depends", "on", "the", "correlation", "between", "residuals", "and", "the", "mean", "squared", "error", "of", "theindividual", "trees", "empirical", "results", "for", "regression", "are", "in", "section", "12", "concluding", "remarks", "aregiven", "in", "section", "13", "characterizing", "the", "accuracy", "of", "random", "forests", "random", "forests", "convergegiven", "an", "ensemble", "of", "classi", "ersh", "h2", "hk", "and", "with", "the", "training", "set", "drawn", "at", "random", "from", "the", "distribution", "of", "the", "random", "vector", "ne", "the", "margin", "function", "as", "mg", "avki", "hk", "max", "negationslash", "yavki", "hk", "where", "is", "the", "indicator", "function", "the", "margin", "measures", "the", "extent", "to", "which", "the", "average", "number", "of", "votes", "at", "yfor", "the", "right", "class", "exceeds", "the", "average", "vote", "for", "any", "other", "class", "the", "larger", "the", "margin", "the", "more", "con", "dence", "in", "the", "classi", "cation", "the", "generalization", "error", "is", "given", "by", "pe", "px", "mg", "where", "the", "subscripts", "yindicate", "that", "the", "probability", "is", "over", "the", "yspace", "in", "random", "forests", "hk", "theta1k", "for", "large", "number", "of", "trees", "it", "follows", "from", "the", "strong", "law", "of", "large", "numbers", "and", "the", "tree", "structure", "that", "theorem", "as", "the", "number", "of", "trees", "increases", "for", "almost", "surely", "all", "sequences", "theta11", "pe", "converges", "to", "px", "theta1", "theta1", "max", "negationslash", "yp", "theta1", "theta1", "proof", "see", "appendix", "this", "result", "explains", "why", "random", "forests", "do", "not", "over", "as", "more", "trees", "are", "added", "but", "produce", "limiting", "value", "of", "the", "generalization", "error", "strength", "and", "correlation", "for", "random", "forests", "an", "upper", "bound", "can", "be", "derived", "for", "the", "generalization", "error", "in", "terms", "of", "two", "parameters", "that", "are", "measures", "of", "how", "accurate", "the", "individual", "classi", "ers", "are", "and", "of", "the", "dependence", "between", "them", "the", "interplay", "between", "these", "two", "gives", "the", "foundation", "forunderstanding", "the", "workings", "of", "random", "forests", "we", "build", "on", "the", "analysis", "in", "amit", "and", "geman", "1997", "breiman", "de", "nition", "the", "margin", "function", "for", "random", "forest", "is", "mr", "theta1", "theta1", "max", "negationslash", "yp", "theta1", "theta1", "and", "the", "strength", "of", "the", "set", "of", "classi", "ers", "theta1", "is", "ex", "ymr", "assuming", "chebychev", "inequality", "gives", "pe", "var", "mr", "s2", "more", "revealing", "expression", "for", "the", "variance", "of", "mris", "derived", "in", "the", "following", "let", "arg", "max", "negationslash", "yp", "theta1", "theta1", "so", "mr", "theta1", "theta1", "theta1", "theta1", "theta1", "theta1", "theta1", "de", "nition", "the", "raw", "margin", "function", "is", "rmg", "theta1", "theta1", "theta1", "thus", "mr", "is", "the", "expectation", "of", "rmg", "theta1", "with", "respect", "to", "theta1", "for", "any", "function", "the", "identity", "theta1f", "theta1", "theta1", "theta1", "primef", "theta1", "theta1", "prime", "holds", "where", "theta1", "theta1", "primeare", "independent", "with", "the", "same", "distribution", "implying", "that", "mr", "theta1", "theta1", "primermg", "theta1", "rmg", "theta1", "prime", "using", "gives", "var", "mr", "theta1", "theta1", "prime", "cov", "yrmg", "theta1", "rmg", "theta1", "prime", "theta1", "theta1", "prime", "theta1", "theta1", "prime", "sd", "theta1", "sd", "theta1", "prime", "where", "theta1", "theta1", "prime", "is", "the", "correlation", "between", "rmg", "theta1", "andrmg", "theta1", "prime", "holding", "theta1", "theta1", "prime", "xed", "and", "sd", "theta1", "is", "the", "standard", "deviation", "of", "rmg", "theta1", "holding", "theta1", "xed", "then", "var", "mr", "theta1sd", "theta1", "theta1var", "theta1", "random", "forests", "where", "is", "the", "mean", "value", "of", "the", "correlation", "that", "is", "theta1", "theta1", "prime", "theta1", "theta1", "prime", "sd", "theta1", "sd", "theta1", "prime", "theta1", "theta1", "prime", "sd", "theta1", "sd", "theta1", "prime", "write", "theta1var", "theta1", "theta1", "ex", "yrmg", "theta1", "s2", "s2", "putting", "and", "together", "yields", "theorem", "an", "upper", "bound", "for", "the", "generalization", "error", "is", "given", "by", "pe", "s2", "s2", "although", "the", "bound", "is", "likely", "to", "be", "loose", "it", "ful", "lls", "the", "same", "suggestive", "function", "for", "random", "forests", "as", "vc", "type", "bounds", "do", "for", "other", "types", "of", "classi", "ers", "it", "shows", "that", "the", "two", "ingredients", "involved", "in", "the", "generalization", "error", "for", "random", "forests", "are", "the", "strength", "of", "the", "individualclassi", "ers", "in", "the", "forest", "and", "the", "correlation", "between", "them", "in", "terms", "of", "the", "raw", "margin", "func", "tions", "the", "s2", "ratio", "is", "the", "correlation", "divided", "by", "the", "square", "of", "the", "strength", "in", "understandingthe", "functioning", "of", "random", "forests", "this", "ratio", "will", "be", "helpful", "guide", "the", "smaller", "it", "is", "the", "better", "de", "nition", "the", "s2", "ratio", "for", "random", "forest", "is", "de", "ned", "as", "s2", "there", "are", "simpli", "cations", "in", "the", "two", "class", "situation", "the", "margin", "function", "is", "mr", "2p", "theta1", "theta1", "the", "requirement", "that", "the", "strength", "is", "positive", "see", "becomes", "similar", "to", "the", "familiar", "weak", "learning", "condition", "ex", "yp", "theta1", "theta1", "the", "raw", "margin", "function", "is", "theta1", "and", "the", "correlation", "is", "between", "theta1", "andi", "theta1", "prime", "in", "particular", "if", "the", "values", "for", "yare", "taken", "to", "be", "and", "then", "theta1", "theta1", "prime", "theta1", "theta1", "prime", "so", "that", "is", "the", "correlation", "between", "two", "different", "members", "of", "the", "forest", "averaged", "over", "the", "theta1", "theta1", "primedistribution", "for", "more", "than", "two", "classes", "the", "measure", "of", "strength", "de", "ned", "in", "depends", "on", "the", "forest", "as", "well", "as", "the", "individual", "trees", "since", "it", "is", "the", "forest", "that", "determines", "another", "approach", "10", "breiman", "is", "possible", "write", "pe", "px", "theta1", "theta1", "max", "negationslash", "yp", "theta1", "theta1", "summationdisplay", "jpx", "theta1", "theta1", "theta1", "theta1", "de", "ne", "sj", "ex", "theta1", "theta1", "theta1", "theta1", "to", "be", "the", "strength", "of", "the", "set", "of", "classi", "ers", "theta1", "relative", "to", "class", "note", "that", "this", "de", "nition", "of", "strength", "does", "not", "depend", "on", "the", "forest", "using", "chebyshev", "inequality", "assuming", "all", "sj", "leads", "to", "pe", "summationdisplay", "jvar", "theta1", "theta1", "theta1", "theta1", "s2", "and", "using", "identities", "similar", "to", "those", "used", "in", "deriving", "the", "variances", "in", "can", "be", "expressed", "in", "terms", "of", "average", "correlations", "did", "not", "use", "estimates", "of", "the", "quantities", "in", "in", "our", "empiricalstudy", "but", "think", "they", "would", "be", "interesting", "in", "multiple", "class", "problem", "using", "random", "features", "some", "random", "forests", "reported", "in", "the", "literature", "have", "consistently", "lower", "generalization", "error", "than", "others", "for", "instance", "random", "split", "selection", "dieterrich", "1998", "does", "better", "than", "bagging", "breiman", "introduction", "of", "random", "noise", "into", "the", "outputs", "breiman", "1998c", "also", "does", "better", "but", "none", "of", "these", "these", "three", "forests", "do", "as", "well", "as", "adaboost", "freund", "schapire", "1996", "orother", "algorithms", "that", "work", "by", "adaptive", "reweighting", "arcing", "of", "the", "training", "set", "see", "breiman", "1998b", "dieterrich", "1998", "bauer", "kohavi", "1999", "to", "improve", "accuracy", "the", "randomness", "injected", "has", "to", "minimize", "the", "correlation", "while", "maintaining", "strength", "the", "forests", "studied", "here", "consist", "of", "using", "randomly", "selected", "inputs", "orcombinations", "of", "inputs", "at", "each", "node", "to", "grow", "each", "tree", "the", "resulting", "forests", "give", "accuracythat", "compare", "favorably", "with", "adaboost", "this", "class", "of", "procedures", "has", "desirable", "characteristics", "its", "accuracy", "is", "as", "good", "as", "adaboost", "and", "sometimes", "better", "ii", "it", "relatively", "robust", "to", "outliers", "and", "noise", "iii", "it", "faster", "than", "bagging", "or", "boosting", "iv", "it", "gives", "useful", "internal", "estimates", "of", "error", "strength", "correlation", "and", "variable", "importance", "vi", "simple", "and", "easily", "parallelized", "amit", "and", "geman", "1997", "grew", "shallow", "trees", "for", "handwritten", "character", "recognition", "using", "random", "selection", "from", "large", "number", "of", "geometrically", "de", "ned", "features", "to", "de", "ne", "the", "split", "at", "each", "node", "although", "my", "implementation", "is", "different", "and", "not", "problem", "speci", "it", "was", "their", "work", "that", "provided", "the", "start", "for", "my", "ideas", "random", "forests", "11", "using", "out", "of", "bag", "estimates", "to", "monitor", "error", "strength", "and", "correlation", "in", "my", "experiments", "with", "random", "forests", "bagging", "is", "used", "in", "tandem", "with", "random", "feature", "selection", "each", "new", "training", "set", "is", "drawn", "with", "replacement", "from", "the", "original", "training", "set", "then", "tree", "is", "grown", "on", "the", "new", "training", "set", "using", "random", "feature", "selection", "the", "trees", "grownare", "not", "pruned", "there", "are", "two", "reasons", "for", "using", "bagging", "the", "rst", "is", "that", "the", "use", "of", "bagging", "seems", "to", "enhance", "accuracy", "when", "random", "features", "are", "used", "the", "second", "is", "that", "bagging", "can", "be", "used", "togive", "ongoing", "estimates", "of", "the", "generalization", "error", "pe", "of", "the", "combined", "ensemble", "of", "trees", "as", "well", "as", "estimates", "for", "the", "strength", "and", "correlation", "these", "estimates", "are", "done", "out", "of", "bag", "which", "is", "explained", "as", "follows", "assume", "method", "for", "constructing", "classi", "er", "from", "any", "training", "set", "given", "speci", "training", "set", "form", "boostrap", "training", "sets", "construct", "classi", "ersh", "tk", "and", "let", "these", "vote", "to", "form", "the", "bagged", "predictor", "for", "each", "xin", "the", "training", "set", "aggregate", "the", "votes", "only", "over", "those", "classi", "ers", "for", "which", "tkdoes", "not", "containing", "call", "this", "the", "out", "of", "bag", "classi", "er", "then", "the", "out", "of", "bag", "estimate", "for", "the", "generalization", "error", "is", "the", "error", "rate", "of", "the", "out", "of", "bag", "classi", "er", "on", "the", "training", "set", "tibshirani", "1996", "and", "wolpert", "and", "macready", "1996", "proposed", "using", "out", "of", "bag", "esti", "mates", "as", "an", "ingredient", "in", "estimates", "of", "generalization", "error", "wolpert", "and", "macready", "workedon", "regression", "type", "problems", "and", "proposed", "number", "of", "methods", "for", "estimating", "the", "gen", "eralization", "error", "of", "bagged", "predictors", "tibshirani", "used", "out", "of", "bag", "estimates", "of", "varianceto", "estimate", "generalization", "error", "for", "arbitrary", "classi", "ers", "the", "study", "of", "error", "estimates", "for", "bagged", "classi", "ers", "in", "breiman", "1996b", "gives", "empirical", "evidence", "to", "show", "that", "the", "out", "of", "bag", "estimate", "is", "as", "accurate", "as", "using", "test", "set", "of", "the", "same", "size", "as", "the", "training", "set", "therefore", "using", "the", "out", "of", "bag", "error", "estimate", "removes", "the", "need", "for", "set", "aside", "testset", "in", "each", "bootstrap", "training", "set", "about", "one", "third", "of", "the", "instances", "are", "left", "out", "therefore", "the", "out", "of", "bag", "estimates", "are", "based", "on", "combining", "only", "about", "one", "third", "as", "many", "classi", "ers", "as", "in", "the", "ongoing", "main", "combination", "since", "the", "error", "rate", "decreases", "as", "the", "number", "of", "combinationsincreases", "the", "out", "of", "bag", "estimates", "will", "tend", "to", "overestimate", "the", "current", "error", "rate", "to", "getunbiased", "out", "of", "bag", "estimates", "it", "is", "necessary", "to", "run", "past", "the", "point", "where", "the", "test", "set", "errorconverges", "but", "unlike", "cross", "validation", "where", "bias", "is", "present", "but", "its", "extent", "unknown", "theout", "of", "bag", "estimates", "are", "unbiased", "strength", "and", "correlation", "can", "also", "be", "estimated", "using", "out", "of", "bag", "methods", "this", "gives", "internal", "estimates", "that", "are", "helpful", "in", "understanding", "classi", "cation", "accuracy", "and", "how", "to", "improve", "it", "the", "details", "are", "given", "in", "appendix", "ii", "another", "application", "is", "to", "the", "measures", "ofvariable", "importance", "see", "section", "10", "random", "forests", "using", "random", "input", "selection", "the", "simplest", "random", "forest", "with", "random", "features", "is", "formed", "by", "selecting", "at", "random", "at", "each", "node", "small", "group", "of", "input", "variables", "to", "split", "on", "grow", "the", "tree", "using", "cart", "methodologyto", "maximum", "size", "and", "do", "not", "prune", "denote", "this", "procedure", "by", "forest", "ri", "the", "size", "fof", "the", "group", "is", "xed", "two", "values", "of", "fwere", "tried", "the", "rst", "used", "only", "one", "randomly", "selected", "12", "breiman", "table", "data", "set", "summary", "data", "set", "train", "size", "test", "size", "inputs", "classes", "glass", "214", "96", "breast", "cancer", "699", "92", "diabetes", "768", "82", "sonar", "208", "60", "owel", "990", "10", "11", "ionosphere", "351", "34", "vehicle", "846", "18", "soybean", "685", "35", "19", "german", "credit", "1000", "24", "image", "2310", "19", "ecoli", "336", "78", "otes", "435", "16", "liver", "345", "62", "letters", "15000", "5000", "16", "26", "sat", "images", "4435", "2000", "36", "6zip", "code", "7291", "2007", "256", "10", "waveform", "300", "3000", "21", "twonorm", "300", "3000", "20", "2threenorm", "300", "3000", "20", "2ringnorm", "300", "3000", "20", "variable", "the", "second", "took", "fto", "be", "the", "rst", "integer", "less", "than", "log2m", "where", "mis", "the", "number", "of", "inputs", "my", "experiments", "use", "13", "smaller", "sized", "data", "sets", "from", "the", "uci", "repository", "larger", "sets", "separated", "into", "training", "and", "test", "sets", "and", "synthetic", "data", "sets", "the", "rst", "10", "sets", "were", "selected", "because", "had", "used", "them", "in", "past", "research", "table", "gives", "brief", "summary", "on", "each", "of", "the", "13", "smaller", "sized", "data", "sets", "the", "following", "procedure", "was", "used", "random", "10", "of", "the", "data", "was", "set", "aside", "on", "the", "remaining", "data", "random", "forest", "was", "run", "twice", "growingand", "combining", "100", "trees", "once", "with", "and", "the", "second", "time", "with", "int", "log", "2m", "the", "set", "aside", "10", "was", "then", "put", "down", "each", "forest", "to", "get", "test", "set", "error", "for", "both", "the", "testset", "error", "selected", "corresponded", "to", "the", "lower", "value", "of", "the", "out", "of", "bag", "estimate", "in", "the", "tworuns", "this", "was", "repeated", "100", "times", "and", "the", "test", "set", "errors", "averaged", "the", "same", "procedure", "wasfollowed", "for", "the", "adaboost", "runs", "which", "are", "based", "on", "combining", "50", "trees", "the", "use", "for", "100", "trees", "in", "random", "forests", "and", "50", "for", "adaboost", "comes", "from", "two", "sources", "the", "out", "of", "bag", "estimates", "are", "based", "on", "only", "about", "third", "as", "many", "trees", "as", "are", "in", "the", "forest", "to", "get", "reliable", "estimates", "opted", "for", "100", "trees", "the", "second", "consideration", "is", "that", "growingrandom", "forests", "is", "many", "times", "faster", "than", "growing", "the", "trees", "based", "on", "all", "inputs", "needed", "inadaboost", "growing", "the", "100", "trees", "in", "random", "forests", "was", "considerably", "quicker", "than", "the", "50trees", "for", "adaboost", "random", "forests", "13", "table", "test", "set", "errors", "data", "set", "adaboost", "selection", "forest", "ri", "single", "input", "one", "tree", "glass", "22", "20", "21", "36", "breast", "cancer", "3diabetes", "26", "24", "24", "33", "1sonar", "15", "15", "18", "31", "7v", "owel", "30", "4ionosphere", "12", "7vehicle", "23", "25", "26", "33", "1german", "credit", "23", "24", "26", "33", "3image", "4ecoli", "14", "12", "13", "24", "5v", "otes", "4liver", "30", "25", "24", "40", "letters", "19", "sat", "images", "10", "17", "2zip", "code", "20", "waveform", "17", "17", "17", "34", "twonorm", "24", "7threenorm", "18", "17", "17", "38", "4ringnorm", "25", "in", "the", "runs", "on", "the", "larger", "data", "sets", "the", "random", "forest", "results", "for", "the", "rst", "two", "data", "sets", "were", "based", "on", "combining", "100", "trees", "the", "zip", "code", "procedure", "combined", "200", "for", "adaboost", "50", "trees", "were", "combined", "for", "the", "rst", "three", "data", "sets", "and", "100", "for", "zip", "code", "the", "synthetic", "data", "was", "described", "in", "breiman", "1996", "and", "also", "used", "in", "schapire", "et", "al", "1997", "there", "were", "50runs", "in", "each", "run", "new", "training", "set", "of", "size", "300", "and", "test", "set", "of", "size", "3000", "were", "generated", "inrandom", "forests", "100", "trees", "were", "combined", "in", "each", "run", "50", "in", "adaboost", "the", "results", "of", "these", "runs", "are", "given", "in", "table", "the", "second", "column", "are", "the", "results", "selected", "from", "the", "two", "group", "sizes", "by", "means", "of", "lowest", "out", "of", "bag", "error", "the", "third", "column", "is", "the", "test", "set", "error", "using", "just", "one", "random", "feature", "to", "growthe", "trees", "the", "fourth", "column", "contains", "the", "out", "of", "bag", "estimates", "of", "the", "generalization", "errorof", "the", "individual", "trees", "in", "the", "forest", "computed", "for", "the", "best", "setting", "single", "or", "selection", "thisestimate", "is", "computed", "by", "using", "the", "left", "out", "instances", "as", "test", "set", "in", "each", "tree", "grown", "andaveraging", "the", "result", "over", "all", "trees", "in", "the", "forest", "the", "error", "rates", "using", "random", "input", "selection", "compare", "favorably", "with", "adaboost", "the", "comparison", "might", "be", "even", "more", "favorable", "if", "the", "search", "is", "over", "more", "values", "of", "finstead", "of", "the", "preset", "two", "but", "the", "procedure", "is", "not", "overly", "sensitive", "to", "the", "value", "of", "the", "average", "absolute", "difference", "between", "the", "error", "rate", "using", "and", "the", "higher", "value", "of", "fis", "less", "than", "the", "difference", "is", "most", "pronounced", "on", "the", "three", "large", "data", "sets", "14", "breiman", "the", "single", "variable", "test", "set", "results", "were", "included", "because", "in", "some", "of", "the", "data", "sets", "using", "single", "random", "input", "variable", "did", "better", "than", "using", "several", "in", "the", "others", "results", "were", "onlyslightly", "better", "than", "use", "of", "single", "variable", "it", "was", "surprising", "that", "using", "single", "randomlychosen", "input", "variable", "to", "split", "on", "at", "each", "node", "could", "produce", "good", "accuracy", "random", "input", "selection", "can", "be", "much", "faster", "than", "either", "adaboost", "or", "bagging", "simple", "analysis", "shows", "that", "the", "ratio", "of", "ri", "compute", "time", "to", "the", "compute", "time", "of", "unpruned", "treeconstruction", "using", "all", "variables", "is", "log2", "mwhere", "fis", "the", "number", "of", "variables", "used", "in", "forest", "ri", "nis", "the", "number", "of", "instances", "and", "mthe", "number", "of", "input", "variables", "for", "zip", "code", "data", "using", "the", "ratio", "is", "025", "implying", "that", "forest", "ri", "is", "40", "times", "faster", "an", "empirical", "check", "con", "rmed", "this", "difference", "forest", "ri", "run", "on", "the", "zip", "code", "data", "takes", "minutes", "on", "250", "mhz", "macintosh", "to", "generate", "100", "trees", "compared", "to", "almost", "threehours", "for", "adaboost", "for", "data", "sets", "with", "many", "variables", "the", "compute", "time", "difference", "may", "besigni", "cant", "random", "forests", "using", "linear", "combinations", "of", "inputs", "if", "there", "are", "only", "few", "inputs", "say", "taking", "fan", "appreciable", "fraction", "of", "mmight", "lead", "an", "increase", "in", "strength", "but", "higher", "correlation", "another", "approach", "consists", "of", "de", "ning", "more", "features", "by", "taking", "random", "linear", "combinations", "of", "number", "of", "the", "input", "variables", "thatis", "feature", "is", "generated", "by", "specifying", "the", "number", "of", "variables", "to", "be", "combined", "at", "given", "node", "lvariables", "are", "randomly", "selected", "and", "added", "together", "with", "coef", "cients", "that", "are", "uniform", "random", "numbers", "on", "flinear", "combinations", "are", "generated", "and", "then", "search", "is", "made", "over", "these", "for", "the", "best", "split", "this", "procedure", "is", "called", "forest", "rc", "we", "use", "and", "with", "the", "choice", "for", "fbeing", "decided", "on", "by", "the", "out", "of", "bag", "estimate", "we", "selected", "because", "with", "different", "combinations", "of", "the", "input", "variables", "larger", "values", "of", "fshould", "not", "cause", "much", "of", "rise", "in", "correlation", "while", "increasing", "strength", "if", "the", "input", "variables", "in", "data", "set", "are", "incommensurable", "they", "are", "normalizedby", "subtracting", "means", "and", "dividing", "by", "standard", "deviations", "where", "the", "means", "and", "standarddeviations", "are", "determined", "from", "the", "training", "set", "the", "test", "set", "results", "are", "given", "in", "table", "3where", "the", "third", "column", "contains", "the", "results", "for", "the", "fourth", "column", "contains", "the", "results", "for", "individual", "trees", "computed", "as", "for", "table", "except", "for", "the", "three", "larger", "data", "sets", "use", "of", "is", "super", "ous", "achieves", "close", "to", "the", "minimum", "on", "the", "larger", "data", "sets", "gives", "better", "results", "forest", "rc", "does", "exceptionally", "well", "on", "the", "synthetic", "data", "sets", "overall", "it", "compares", "more", "favorably", "to", "adaboost", "thanforest", "ri", "in", "tables", "and", "there", "are", "some", "entries", "for", "which", "the", "selected", "entry", "is", "less", "than", "the", "one", "input", "value", "or", "with", "forest", "rc", "less", "than", "the", "two", "feature", "value", "the", "reason", "this", "happens", "isthat", "when", "the", "error", "rates", "corresponding", "to", "the", "two", "values", "of", "fare", "close", "together", "then", "the", "out", "of", "bag", "estimates", "will", "select", "value", "of", "falmost", "at", "random", "small", "investigation", "was", "carried", "out", "to", "see", "if", "performance", "on", "the", "three", "larger", "data", "sets", "could", "be", "improved", "based", "on", "the", "runs", "with", "the", "satellite", "data", "in", "section", "we", "conjectured", "thatthe", "strength", "keeps", "rising", "in", "the", "larger", "data", "sets", "while", "the", "correlation", "reaches", "an", "asymptotemore", "quickly", "therefore", "we", "did", "some", "runs", "with", "100", "on", "the", "larger", "data", "sets", "using", "100", "100", "and", "200", "trees", "in", "the", "three", "forests", "respectively", "on", "the", "satellite", "data", "the", "error", "dropped", "to", "random", "forests", "15", "table", "test", "set", "errors", "forest", "rc", "data", "set", "adaboost", "selection", "two", "features", "one", "tree", "glass", "22", "24", "23", "42", "breast", "cancer", "8diabetes", "26", "23", "23", "32", "1sonar", "15", "13", "13", "31", "7v", "owel", "30", "4ionosphere", "14", "2vehicle", "23", "23", "22", "39", "1german", "credit", "23", "22", "23", "32", "6image", "0ecoli", "14", "12", "12", "25", "3v", "otes", "6liver", "30", "27", "27", "40", "letters", "23", "sat", "images", "10", "17", "3zip", "code", "22", "waveform", "17", "16", "16", "33", "twonorm", "20", "9threenorm", "18", "16", "16", "34", "8ringnorm", "24", "on", "the", "letters", "data", "to", "but", "the", "zip", "code", "test", "set", "error", "did", "not", "decrease", "acting", "on", "an", "informed", "hunch", "tried", "forest", "ri", "with", "25", "the", "zip", "code", "test", "set", "error", "dropped", "to", "these", "are", "the", "lowest", "test", "set", "errors", "so", "far", "achieved", "on", "these", "three", "data", "sets", "by", "tree", "ensembles", "categorical", "variables", "some", "or", "all", "of", "the", "input", "variables", "may", "be", "categoricals", "and", "since", "we", "want", "to", "de", "ne", "additive", "combinations", "of", "variables", "we", "need", "to", "de", "ne", "how", "categoricals", "will", "be", "treated", "so", "they", "can", "be", "combined", "with", "numerical", "variables", "my", "approach", "is", "that", "each", "time", "categorical", "variableis", "selected", "to", "split", "on", "at", "node", "to", "select", "random", "subset", "of", "the", "categories", "of", "the", "variable", "and", "de", "ne", "substitute", "variable", "that", "is", "one", "when", "the", "categorical", "value", "of", "the", "variable", "is", "in", "the", "subset", "and", "zero", "outside", "since", "categorical", "variable", "with", "ivalues", "can", "be", "coded", "into", "dummy", "variables", "we", "make", "the", "variable", "times", "as", "probable", "as", "numeric", "variable", "to", "be", "selected", "in", "node", "splitting", "when", "many", "of", "the", "variables", "are", "categorical", "using", "low", "value", "of", "fresults", "in", "low", "correlation", "but", "also", "low", "strength", "fmust", "be", "increased", "to", "about", "two", "three", "times", "int", "log", "2m", "to", "get", "enough", "strength", "to", "provide", "good", "test", "set", "accuracy", "16", "breiman", "for", "instance", "on", "the", "dna", "data", "set", "having", "60", "four", "valued", "categorical", "values", "000", "exam", "ples", "in", "the", "training", "set", "and", "186", "in", "the", "test", "set", "using", "forest", "ri", "with", "20", "gave", "test", "set", "error", "rate", "of", "for", "adaboost", "the", "soybean", "data", "has", "685", "examples", "35", "variables", "19", "classes", "and", "15", "categorical", "variables", "using", "forest", "ri", "with", "12", "gives", "test", "set", "error", "of", "for", "adaboost", "using", "forest", "rc", "with", "combinations", "of", "and", "8g", "an", "error", "of", "one", "advantage", "of", "this", "approach", "is", "that", "it", "gets", "around", "the", "dif", "culty", "of", "what", "to", "do", "with", "categoricals", "that", "have", "many", "values", "in", "the", "two", "class", "problem", "this", "can", "be", "avoided", "by", "usingthe", "device", "proposed", "in", "breiman", "et", "al", "1985", "which", "reduces", "the", "search", "for", "the", "best", "categoricalsplit", "to", "an", "computation", "for", "more", "classes", "the", "search", "for", "the", "best", "categorical", "split", "is", "an", "computation", "in", "the", "random", "forest", "implementation", "the", "computation", "for", "any", "categorical", "variable", "involves", "only", "the", "selection", "of", "random", "subset", "of", "the", "categories", "empirical", "results", "on", "strength", "and", "correlation", "the", "purpose", "of", "this", "section", "is", "to", "look", "at", "the", "effect", "of", "strength", "and", "correlation", "on", "the", "gener", "alization", "error", "another", "aspect", "that", "we", "wanted", "to", "get", "more", "understanding", "of", "was", "the", "lack", "ofsensitivity", "in", "the", "generalization", "error", "to", "the", "group", "size", "to", "conduct", "an", "empirical", "study", "of", "the", "effects", "of", "strength", "and", "correlation", "in", "variety", "of", "data", "sets", "out", "of", "bag", "estimates", "of", "thestrength", "and", "correlation", "as", "described", "in", "section", "were", "used", "we", "begin", "by", "running", "forest", "ri", "on", "the", "sonar", "data", "60", "inputs", "208", "examples", "using", "from", "to", "50", "inputs", "in", "each", "iteration", "10", "of", "the", "data", "was", "split", "off", "as", "test", "set", "then", "the", "number", "of", "random", "inputs", "selected", "at", "each", "node", "was", "varied", "from", "to", "50", "for", "each", "value", "of", "100", "trees", "were", "grown", "to", "form", "random", "forest", "and", "the", "terminal", "values", "of", "test", "set", "error", "strength", "correlation", "etc", "recorded", "eighty", "iterations", "were", "done", "each", "time", "removing", "random", "10", "of", "the", "data", "for", "use", "as", "test", "set", "and", "all", "results", "averaged", "over", "the", "80", "repetitions", "altogether", "400", "000", "trees", "were", "grown", "in", "this", "experiment", "the", "top", "graph", "of", "gure", "plots", "the", "values", "of", "strength", "and", "correlation", "vs", "the", "result", "is", "fascinating", "past", "about", "the", "strength", "remains", "constant", "adding", "more", "inputs", "does", "not", "help", "but", "the", "correlation", "continues", "to", "increase", "the", "second", "graph", "plots", "the", "test", "set", "errorsand", "the", "out", "of", "bag", "estimates", "of", "the", "generalization", "error", "against", "the", "out", "of", "bag", "estimates", "are", "more", "stable", "both", "show", "the", "same", "behavior", "small", "drop", "from", "out", "to", "fabout", "and", "then", "general", "gradual", "increase", "this", "increase", "in", "error", "tallies", "with", "the", "beginning", "of", "the", "constancy", "region", "for", "the", "strength", "figure", "has", "plots", "for", "similar", "runs", "on", "the", "breast", "data", "set", "where", "features", "consisting", "of", "random", "combinations", "of", "three", "inputs", "are", "used", "the", "number", "of", "these", "features", "was", "variedfrom", "to", "25", "again", "the", "correlation", "shows", "slow", "rise", "while", "the", "strength", "stays", "virtuallyconstant", "so", "that", "the", "minimum", "error", "is", "at", "the", "surprise", "in", "these", "two", "gures", "is", "the", "relative", "constancy", "of", "the", "strength", "since", "the", "correlations", "are", "slowly", "but", "steadily", "increasing", "the", "lowest", "error", "occurs", "when", "only", "few", "inputs", "or", "features", "are", "used", "since", "the", "larger", "data", "sets", "seemed", "to", "have", "different", "behavior", "than", "the", "smaller", "we", "ran", "similar", "experiment", "on", "the", "satellite", "data", "set", "the", "number", "of", "features", "each", "consisting", "ofa", "random", "sum", "of", "two", "inputs", "was", "varied", "from", "to", "25", "and", "for", "each", "100", "classi", "ers", "were", "combined", "the", "results", "are", "shown", "in", "gure", "the", "results", "differ", "from", "those", "on", "the", "smaller", "random", "forests", "17", "figure", "effect", "of", "number", "of", "inputs", "on", "sonar", "data", "18", "breiman", "figure", "effect", "of", "the", "number", "of", "features", "on", "the", "breast", "data", "set", "random", "forests", "19", "figure", "effect", "of", "number", "of", "features", "on", "satellite", "data", "20", "breiman", "data", "sets", "both", "the", "correlation", "and", "strength", "show", "small", "but", "steady", "increase", "the", "error", "rates", "show", "slight", "decrease", "we", "conjecture", "that", "with", "larger", "and", "more", "complex", "data", "sets", "the", "strength", "continues", "to", "increase", "longer", "before", "it", "plateaus", "out", "our", "results", "indicate", "that", "better", "lower", "generalization", "error", "random", "forests", "have", "lower", "cor", "relation", "between", "classi", "ers", "and", "higher", "strength", "the", "randomness", "used", "in", "tree", "construction", "has", "to", "aim", "for", "low", "correlation", "while", "maintaining", "reasonable", "strength", "this", "conclusion", "has", "been", "hinted", "at", "in", "previous", "work", "dietterich", "1998", "has", "measures", "of", "dispersion", "of", "an", "ensembleand", "notes", "that", "more", "accurate", "ensembles", "have", "larger", "dispersion", "freund", "personal", "commu", "nication", "believes", "that", "one", "reason", "why", "adaboost", "works", "so", "well", "is", "that", "at", "each", "step", "it", "tries", "todecouple", "the", "next", "classi", "er", "from", "the", "current", "one", "amit", "et", "al", "1999", "give", "an", "analysis", "to", "show", "that", "the", "adaboost", "algorithm", "is", "aimed", "at", "keeping", "the", "covariance", "between", "classi", "ers", "small", "conjecture", "adaboost", "is", "random", "forest", "various", "classi", "ers", "can", "be", "modi", "ed", "to", "use", "both", "training", "set", "and", "set", "of", "weights", "on", "the", "training", "set", "consider", "the", "following", "random", "forest", "large", "collection", "of", "kdifferent", "sets", "of", "non", "negative", "sum", "one", "weights", "on", "the", "training", "set", "is", "de", "ned", "denote", "these", "weights", "by", "corresponding", "to", "these", "weights", "are", "probabilities", "whose", "sum", "is", "one", "draw", "from", "the", "integers", "kaccording", "to", "these", "probabilities", "the", "outcome", "is", "theta1", "theta1", "kgrow", "the", "classi", "erh", "theta1", "using", "the", "training", "set", "with", "weights", "in", "its", "original", "version", "adaboost", "freund", "schapire", "1996", "is", "deterministic", "algorithm", "that", "selects", "the", "weights", "on", "the", "training", "set", "for", "input", "to", "the", "next", "classi", "er", "based", "on", "the", "mis", "classi", "cations", "in", "the", "previous", "classi", "ers", "in", "our", "experiment", "random", "forests", "were", "produced", "as", "follows", "adaboost", "was", "run", "75", "times", "on", "data", "set", "producing", "sets", "of", "non", "negative", "sum", "oneweights", "50", "the", "rst", "25", "were", "discarded", "the", "probability", "for", "the", "kth", "set", "of", "weights", "is", "set", "proportional", "to", "log", "error", "error", "where", "error", "is", "thew", "weighted", "training", "set", "error", "of", "the", "kth", "classi", "er", "then", "the", "forest", "is", "run", "250", "times", "this", "was", "repeated", "100", "times", "on", "few", "data", "sets", "each", "time", "leaving", "out", "10", "as", "test", "set", "and", "then", "averaging", "the", "test", "set", "errors", "on", "each", "data", "set", "the", "adaboost", "error", "rate", "was", "very", "close", "tothe", "random", "forest", "error", "rate", "typical", "result", "is", "on", "the", "wisconsin", "breast", "cancer", "data", "whereadaboost", "produced", "an", "average", "of", "91", "error", "and", "the", "random", "forest", "produced", "94", "in", "the", "adaboost", "algorithm", "where", "is", "function", "determined", "by", "the", "base", "classi", "er", "denote", "the", "kth", "classi", "er", "by", "the", "vote", "of", "the", "kth", "classi", "er", "is", "weighted", "by", "wk", "so", "the", "normalized", "vote", "for", "class", "jatxequals", "summationdisplay", "ki", "wk", "wk", "slashbigg", "summationdisplay", "kq", "wk", "10", "for", "any", "function", "fde", "ned", "on", "the", "weight", "space", "de", "ne", "the", "operator", "tf", "we", "conjecture", "that", "tis", "ergodic", "with", "invariant", "measure", "dw", "then", "10", "will", "converge", "to", "eq", "where", "the", "distribution", "dw", "dw", "integraltext", "dv", "this", "conjecture", "is", "true", "then", "adaboost", "is", "equivalent", "to", "random", "forest", "where", "the", "weights", "onthe", "training", "set", "are", "selected", "at", "random", "from", "the", "distribution", "random", "forests", "21", "its", "truth", "would", "also", "explain", "why", "adaboost", "does", "not", "over", "as", "more", "trees", "are", "added", "to", "the", "ensemble", "an", "experimental", "fact", "that", "has", "been", "puzzling", "there", "is", "some", "experimental", "evidence", "that", "adaboost", "may", "over", "if", "run", "thousands", "of", "times", "grove", "schuurmans", "1998", "but", "these", "runs", "were", "done", "using", "very", "simple", "base", "classi", "er", "and", "may", "not", "carry", "over", "to", "the", "use", "of", "trees", "as", "the", "base", "classi", "ers", "my", "experience", "running", "adaboost", "out", "to", "0000", "trees", "on", "number", "of", "data", "sets", "is", "that", "the", "test", "set", "error", "converges", "to", "an", "asymptotic", "value", "the", "truth", "of", "this", "conjecture", "does", "not", "solve", "the", "problem", "of", "how", "adaboost", "selects", "the", "favorable", "distributions", "on", "the", "weight", "space", "that", "it", "does", "note", "that", "the", "distribution", "of", "theweights", "will", "depend", "on", "the", "training", "set", "in", "the", "usual", "random", "forest", "the", "distribution", "ofthe", "random", "vectors", "does", "not", "depend", "on", "the", "training", "set", "the", "effects", "of", "output", "noise", "dietterich", "1998", "showed", "that", "when", "fraction", "of", "the", "output", "labels", "in", "the", "training", "set", "are", "randomly", "altered", "the", "accuracy", "of", "adaboost", "degenerates", "while", "bagging", "and", "random", "splitselection", "are", "more", "immune", "to", "the", "noise", "since", "some", "noise", "in", "the", "outputs", "is", "often", "present", "robustness", "with", "respect", "to", "noise", "is", "desirable", "property", "following", "dietterich", "1998", "thefollowing", "experiment", "was", "done", "which", "changed", "about", "one", "in", "twenty", "class", "labels", "injecting5", "noise", "for", "each", "data", "set", "in", "the", "experiment", "10", "at", "random", "is", "split", "off", "as", "test", "set", "two", "runs", "are", "made", "on", "the", "remaining", "training", "set", "the", "rst", "run", "is", "on", "the", "training", "set", "as", "is", "the", "second", "run", "is", "on", "noisy", "version", "of", "the", "training", "set", "the", "noisy", "version", "is", "gotten", "by", "changing", "at", "random", "of", "the", "class", "labels", "into", "an", "alternate", "class", "label", "chosen", "uniformly", "from", "the", "other", "labels", "this", "is", "repeated", "50", "times", "using", "adaboost", "deterministic", "version", "forest", "ri", "and", "forest", "rc", "the", "test", "set", "results", "are", "averaged", "over", "the", "50", "repetitions", "and", "the", "percent", "increase", "due", "tothe", "noise", "computed", "in", "both", "random", "forests", "we", "used", "the", "number", "of", "features", "giving", "the", "lowesttest", "set", "error", "in", "the", "section", "and", "experiments", "because", "of", "the", "lengths", "of", "the", "runs", "onlythe", "smallest", "data", "sets", "are", "used", "table", "gives", "the", "increases", "in", "error", "rates", "due", "to", "the", "noise", "table", "increases", "in", "error", "rates", "due", "to", "noise", "data", "set", "adaboost", "forest", "ri", "forest", "rc", "glass", "breast", "cancer", "43", "11", "1diabetes", "8sonar", "15", "ionosphere", "27", "7soybean", "26", "5ecoli", "8v", "otes", "48", "6liver", "10", "22", "breiman", "adaboost", "deteriorates", "markedly", "with", "noise", "while", "the", "random", "forest", "procedures", "generally", "show", "small", "changes", "the", "effect", "on", "adaboost", "is", "curiously", "data", "set", "dependent", "withthe", "two", "multiclass", "data", "sets", "glass", "and", "ecoli", "along", "with", "diabetes", "least", "effected", "by", "the", "noise", "the", "adaboost", "algorithm", "iteratively", "increases", "the", "weights", "on", "the", "instances", "most", "recentlymisclassi", "ed", "instances", "having", "incorrect", "class", "labels", "will", "persist", "in", "being", "misclassi", "ed", "then", "adaboost", "will", "concentrate", "increasing", "weight", "on", "these", "noisy", "instances", "and", "becomewarped", "the", "random", "forest", "procedures", "do", "not", "concentrate", "weight", "on", "any", "subset", "of", "theinstances", "and", "the", "noise", "effect", "is", "smaller", "data", "with", "many", "weak", "inputs", "data", "sets", "with", "many", "weak", "inputs", "are", "becoming", "more", "common", "in", "medical", "diagnosis", "document", "retrieval", "etc", "the", "common", "characteristics", "is", "no", "single", "input", "or", "small", "groupof", "inputs", "can", "distinguish", "between", "the", "classes", "this", "type", "of", "data", "is", "dif", "cult", "for", "the", "usual", "classi", "ers", "neural", "nets", "and", "trees", "to", "see", "if", "there", "is", "possibility", "that", "forest", "ri", "methods", "can", "work", "the", "following", "10", "class", "000", "binary", "input", "data", "was", "generated", "rnd", "is", "uniform", "random", "number", "selected", "aneweach", "time", "it", "appears", "do", "10", "do", "1000", "rnd", "01", "end", "doend", "do", "do", "10", "do", "nint", "400", "rnd", "nint", "nearest", "integer", "nint", "1000", "rnd", "rnd", "end", "doend", "do", "do", "nint", "10", "rnd", "do", "1000", "if", "rnd", "then", "elsex", "end", "ify", "is", "the", "class", "label", "of", "the", "nth", "example", "end", "doend", "do", "random", "forests", "23", "this", "code", "generates", "set", "of", "probabilities", "where", "jis", "the", "class", "label", "and", "is", "the", "input", "number", "then", "the", "inputs", "for", "class", "example", "are", "string", "of", "binary", "variables", "withthe", "mth", "variable", "having", "probability", "of", "being", "one", "for", "the", "training", "set", "000", "000", "example", "test", "set", "was", "also", "constructed", "using", "the", "same", "examination", "of", "the", "code", "shows", "that", "each", "class", "has", "higher", "underlying", "probability", "at", "certain", "locations", "but", "the", "total", "over", "all", "classes", "of", "these", "locations", "is", "about2", "000", "so", "there", "is", "signi", "cant", "overlap", "assuming", "one", "knows", "all", "of", "the", "the", "bayes", "error", "rate", "for", "the", "particular", "computed", "in", "our", "run", "is", "since", "the", "inputs", "are", "independent", "of", "each", "other", "the", "naive", "bayes", "classi", "er", "which", "estimates", "the", "from", "the", "training", "data", "is", "supposedly", "optimal", "and", "has", "an", "error", "rate", "of", "this", "is", "not", "an", "endorsement", "of", "naive", "bayes", "since", "it", "would", "be", "easy", "to", "create", "dependence", "betweenthe", "inputs", "which", "would", "increase", "the", "naive", "bayes", "error", "rate", "stayed", "with", "this", "examplebecause", "the", "bayes", "error", "rate", "and", "the", "naive", "bayes", "error", "rate", "are", "easy", "to", "compute", "started", "with", "run", "of", "forest", "ri", "with", "it", "converged", "very", "slowly", "and", "by", "500", "iterations", "when", "it", "was", "stopped", "it", "had", "still", "not", "converged", "the", "test", "set", "error", "was", "10", "the", "strength", "was", "069", "and", "the", "correlation", "012", "with", "s2", "ratio", "of", "even", "though", "thestrength", "was", "low", "the", "almost", "zero", "correlation", "meant", "that", "we", "were", "adding", "small", "incrementsof", "accuracy", "as", "the", "iterations", "proceeded", "clearly", "what", "was", "desired", "was", "an", "increase", "in", "strength", "while", "keeping", "the", "correlation", "low", "forest", "ri", "was", "run", "again", "using", "int", "log", "2m", "10", "the", "results", "were", "encouraging", "it", "converged", "after", "000", "iterations", "the", "test", "set", "error", "was", "the", "strength", "was", "22", "thecorrelation", "045", "and", "s2", "91", "going", "with", "the", "trend", "forest", "ri", "was", "run", "with", "25", "and", "stopped", "after", "000", "iterations", "the", "test", "set", "error", "was", "strength", "was", "28", "correlation", "065", "and", "s2", "83", "it", "interesting", "that", "forest", "ri", "could", "produce", "error", "rates", "not", "far", "above", "the", "bayes", "error", "rate", "the", "individual", "classi", "ers", "are", "weak", "for", "the", "average", "tree", "error", "rate", "is", "80", "for", "10", "it", "is", "65", "and", "for", "25", "it", "is", "60", "forests", "seem", "to", "have", "the", "ability", "to", "work", "with", "very", "weak", "classi", "ers", "as", "long", "as", "their", "correlation", "is", "low", "comparison", "using", "adaboost", "was", "tried", "but", "can", "get", "adaboost", "to", "run", "on", "this", "data", "because", "the", "base", "classi", "ers", "are", "too", "weak", "10", "exploring", "the", "random", "forest", "mechanism", "forest", "of", "trees", "is", "impenetrable", "as", "far", "as", "simple", "interpretations", "of", "its", "mechanism", "go", "in", "some", "applications", "analysis", "of", "medical", "experiments", "for", "example", "it", "is", "critical", "to", "understand", "theinteraction", "of", "variables", "that", "is", "providing", "the", "predictive", "accuracy", "start", "on", "this", "problem", "ismade", "by", "using", "internal", "out", "of", "bag", "estimates", "and", "veri", "cation", "by", "reruns", "using", "only", "selected", "variables", "suppose", "there", "are", "minput", "variables", "after", "each", "tree", "is", "constructed", "the", "values", "of", "the", "mth", "variable", "in", "the", "out", "of", "bag", "examples", "are", "randomly", "permuted", "and", "the", "out", "of", "bag", "data", "is", "rundown", "the", "corresponding", "tree", "the", "classi", "cation", "given", "for", "each", "nthat", "is", "out", "of", "bag", "is", "saved", "this", "is", "repeated", "for", "at", "the", "end", "of", "the", "run", "the", "plurality", "of", "out", "of", "bag", "class", "votes", "for", "xnwith", "the", "mth", "variable", "noised", "up", "is", "compared", "with", "the", "true", "class", "label", "of", "xnto", "give", "misclassi", "cation", "rate", "24", "breiman", "figure", "measure", "of", "variable", "importance", "diabetes", "data", "the", "output", "is", "the", "percent", "increase", "in", "misclassi", "cation", "rate", "as", "compared", "to", "the", "out", "of", "bag", "rate", "with", "all", "variables", "intact", "we", "get", "these", "estimates", "by", "using", "single", "run", "of", "forest", "with1", "000", "trees", "and", "no", "test", "set", "the", "procedure", "is", "illustrated", "by", "examples", "in", "the", "diabetes", "data", "set", "using", "only", "single", "variables", "with", "the", "rise", "in", "error", "due", "to", "the", "noising", "of", "variables", "is", "given", "in", "gure", "the", "second", "variable", "appears", "by", "far", "the", "most", "important", "followed", "by", "variable", "and", "variable", "running", "the", "random", "forest", "in", "100", "repetitions", "using", "only", "variable", "and", "leaving", "out", "10", "each", "time", "to", "measure", "test", "set", "error", "gave", "an", "error", "of", "29", "compared", "with", "23", "using", "allvariables", "but", "when", "variable", "is", "added", "the", "error", "falls", "only", "to", "29", "when", "variable", "isadded", "to", "variable", "the", "error", "falls", "to", "26", "the", "reason", "that", "variable", "seems", "important", "yet", "is", "no", "help", "once", "variable", "is", "entered", "is", "characteristic", "of", "how", "dependent", "variables", "affect", "prediction", "error", "in", "random", "forests", "say", "there", "are", "two", "variables", "1andx2which", "are", "identical", "and", "carry", "signi", "cant", "predictive", "information", "because", "each", "gets", "picked", "with", "about", "the", "same", "frequency", "in", "random", "forest", "noising", "each", "separately", "will", "result", "in", "the", "same", "increase", "in", "error", "rate", "but", "once", "1is", "entered", "as", "predictive", "variable", "using", "x2in", "addition", "will", "not", "produce", "any", "decrease", "in", "error", "rate", "in", "the", "diabetes", "data", "set", "the", "8th", "variable", "carries", "some", "of", "the", "same", "information", "as", "the", "second", "so", "it", "does", "not", "add", "predictive", "accuracy", "when", "combined", "with", "the", "second", "the", "relative", "magnitudes", "of", "rises", "in", "error", "rates", "are", "fairly", "stable", "with", "respect", "to", "the", "input", "features", "used", "the", "experiment", "above", "was", "repeated", "using", "combinations", "of", "three", "inputs", "with", "the", "results", "are", "in", "gure", "another", "interesting", "example", "is", "the", "voting", "data", "this", "has", "435", "examples", "corresponding", "to", "435", "congressmen", "and", "16", "variables", "re", "ecting", "their", "yes", "no", "votes", "on", "16", "issues", "the", "class", "variable", "is", "republican", "or", "democrat", "to", "see", "which", "issues", "were", "most", "important", "we", "again", "ranthe", "noising", "variables", "program", "generating", "000", "trees", "the", "lowest", "error", "rate", "on", "the", "originaldata", "was", "gotten", "using", "single", "inputs", "with", "so", "these", "parameters", "were", "used", "in", "the", "run", "the", "results", "in", "gure", "variable", "stands", "out", "the", "error", "triples", "if", "variable", "is", "noised", "we", "reran", "this", "data", "set", "using", "only", "variable", "the", "test", "set", "error", "is", "about", "the", "same", "as", "if", "all", "variables", "were", "used", "the", "random", "forests", "25", "figure", "measure", "of", "variable", "importance", "diabetes", "data", "figure", "measure", "of", "variable", "importance", "votes", "data", "vote", "on", "separates", "republicans", "from", "democrats", "almost", "as", "well", "as", "the", "vote", "on", "combined", "with", "the", "votes", "on", "all", "other", "15", "issues", "the", "approach", "given", "in", "this", "section", "is", "only", "beginning", "more", "research", "will", "be", "necessary", "to", "understand", "how", "to", "give", "more", "complete", "picture", "11", "random", "forests", "for", "regression", "random", "forests", "for", "regression", "are", "formed", "by", "growing", "trees", "depending", "on", "random", "vector", "theta1such", "that", "the", "tree", "predictor", "theta1", "takes", "on", "numerical", "values", "as", "opposed", "to", "class", "labels", "the", "output", "values", "are", "numerical", "and", "we", "assume", "that", "the", "training", "set", "is", "independently", "drawnfrom", "the", "distribution", "of", "the", "random", "vector", "the", "mean", "squared", "generalization", "error", "for", "any", "numerical", "predictor", "is", "11", "26", "breiman", "the", "random", "forest", "predictor", "is", "formed", "by", "taking", "the", "average", "over", "kof", "the", "trees", "theta1k", "similarly", "to", "the", "classi", "cation", "case", "the", "following", "holds", "theorem", "11", "as", "the", "number", "of", "trees", "in", "the", "forest", "goes", "to", "in", "nity", "almost", "surrely", "ex", "avkh", "theta1k", "ex", "theta1h", "theta1", "12", "proof", "see", "appendix", "denote", "the", "right", "hand", "side", "of", "12", "as", "pe", "forest", "the", "generalization", "error", "of", "the", "forest", "de", "ne", "the", "average", "generalization", "error", "of", "tree", "as", "pe", "tree", "theta1ex", "theta1", "theorem", "11", "assume", "that", "for", "all", "theta1", "ey", "exh", "theta1", "then", "pe", "forest", "pe", "tree", "where", "is", "the", "weighted", "correlation", "between", "the", "residuals", "theta1", "and", "theta1", "prime", "where", "theta1", "theta1", "primeare", "independent", "proof", "pe", "forest", "ex", "theta1", "theta1", "theta1e", "theta1", "primeex", "theta1", "theta1", "prime", "13", "the", "term", "on", "the", "right", "in", "13", "is", "covariance", "and", "can", "be", "written", "as", "theta1e", "theta1", "prime", "theta1", "theta1", "prime", "sd", "theta1", "sd", "theta1", "prime", "where", "sd", "theta1", "radicalbig", "ex", "theta1", "ne", "the", "weighted", "correlation", "as", "theta1e", "theta1", "prime", "theta1", "theta1", "prime", "sd", "theta1", "sd", "theta1", "prime", "theta1sd", "theta1", "14", "then", "pe", "forest", "theta1sd", "theta1", "pe", "tree", "theorem", "11", "pinpoints", "the", "requirements", "for", "accurate", "regression", "forests", "low", "correla", "tion", "between", "residuals", "and", "low", "error", "trees", "the", "random", "forest", "decreases", "the", "average", "errorof", "the", "trees", "employed", "by", "the", "factor", "the", "randomization", "employed", "needs", "to", "aim", "at", "low", "correlation", "random", "forests", "27", "12", "empirical", "results", "in", "regression", "in", "regression", "forests", "we", "use", "random", "feature", "selection", "on", "top", "of", "bagging", "therefore", "we", "can", "use", "the", "monitoring", "provided", "by", "out", "of", "bag", "estimation", "to", "give", "estimates", "of", "pe", "forest", "pe", "tree", "and", "these", "are", "derived", "similarly", "to", "the", "estimates", "in", "classi", "cation", "throughout", "features", "formed", "by", "random", "linear", "sum", "of", "two", "inputs", "are", "used", "we", "comment", "later", "on", "howmany", "of", "these", "features", "to", "use", "to", "determine", "the", "split", "at", "each", "node", "the", "more", "features", "used", "the", "lower", "pe", "tree", "but", "the", "higher", "in", "our", "empirical", "study", "the", "following", "data", "sets", "are", "used", "see", "table", "of", "these", "data", "sets", "the", "boston", "housing", "abalone", "and", "servo", "are", "available", "at", "the", "uci", "repository", "the", "robot", "arm", "data", "was", "provided", "by", "michael", "jordan", "the", "last", "three", "datasets", "are", "synthetic", "they", "originated", "in", "friedman", "1991", "and", "are", "also", "described", "in", "breiman", "1998b", "these", "are", "the", "same", "data", "sets", "used", "to", "compare", "adaptive", "bagging", "to", "bagging", "seebreiman", "1999", "except", "that", "one", "synthetic", "data", "set", "peak20", "which", "was", "found", "anomalousboth", "by", "other", "researchers", "and", "myself", "is", "eliminated", "the", "rst", "three", "data", "sets", "listed", "are", "moderate", "in", "size", "and", "test", "set", "error", "was", "estimated", "by", "leaving", "out", "random", "10", "of", "the", "instances", "running", "on", "the", "remaining", "90", "and", "using", "theleft", "out", "10", "as", "test", "set", "this", "was", "repeated", "100", "times", "and", "the", "test", "set", "errors", "averaged", "the", "abalone", "data", "set", "is", "larger", "with", "177", "instances", "and", "input", "variables", "it", "originallycame", "with", "25", "of", "the", "instances", "set", "aside", "as", "test", "set", "we", "ran", "this", "data", "set", "leaving", "outa", "randomly", "selected", "25", "of", "the", "instances", "to", "use", "as", "test", "set", "repeated", "this", "10", "times", "andaveraged", "table", "gives", "the", "test", "set", "mean", "squared", "error", "for", "bagging", "adaptive", "bagging", "and", "the", "random", "forest", "these", "were", "all", "run", "using", "25", "features", "each", "random", "linear", "combination", "oftwo", "randomly", "selected", "inputs", "to", "split", "each", "node", "each", "feature", "random", "combination", "of", "twoinputs", "all", "runs", "with", "all", "data", "sets", "combined", "100", "trees", "in", "all", "data", "sets", "the", "rule", "don", "split", "if", "the", "node", "size", "is", "was", "enforced", "an", "interesting", "difference", "between", "regression", "and", "classi", "cation", "is", "that", "the", "correlation", "increases", "quite", "slowly", "as", "the", "number", "of", "features", "used", "increases", "the", "major", "effect", "is", "thedecrease", "in", "pe", "tree", "therefore", "relatively", "large", "number", "of", "features", "are", "required", "to", "reduce", "pe", "tree", "and", "get", "near", "optimal", "testset", "error", "table", "data", "set", "summary", "data", "set", "nr", "inputs", "training", "test", "boston", "housing", "12", "506", "10", "ozone", "330", "10", "servo", "167", "10", "abalone", "4177", "25", "robot", "arm", "12", "15", "000", "5000friedman", "10", "200", "2000friedman", "200", "2000friedman", "200", "2000", "28", "breiman", "table", "mean", "squared", "test", "set", "error", "data", "set", "bagging", "adapt", "bag", "forest", "boston", "housing", "11", "10", "ozone", "17", "17", "16", "3servo", "10", "24", "25", "24", "abalone", "6robot", "arm", "10", "friedman", "7friedman", "10", "21", "21", "19", "friedman", "10", "24", "24", "21", "the", "results", "shown", "in", "table", "are", "mixed", "random", "forest", "random", "features", "is", "always", "better", "than", "bagging", "in", "data", "sets", "for", "which", "adaptive", "bagging", "gives", "sharp", "decreases", "in", "error", "thedecreases", "produced", "by", "forests", "are", "not", "as", "pronounced", "in", "data", "sets", "in", "which", "adaptive", "bagginggives", "no", "improvements", "over", "bagging", "forests", "produce", "improvements", "for", "the", "same", "number", "of", "inputs", "combined", "over", "wide", "range", "the", "error", "does", "not", "change", "much", "with", "the", "number", "of", "features", "if", "the", "number", "used", "is", "too", "small", "pe", "tree", "becomes", "too", "large", "and", "the", "error", "goes", "up", "if", "the", "number", "used", "is", "too", "large", "the", "correlation", "goes", "up", "and", "theerror", "again", "increases", "the", "in", "between", "range", "is", "usually", "large", "in", "this", "range", "as", "the", "number", "offeatures", "goes", "up", "the", "correlation", "increases", "but", "pe", "tree", "compensates", "by", "decreasing", "table", "gives", "the", "test", "set", "errors", "the", "out", "of", "bag", "error", "estimates", "and", "the", "ob", "estimates", "for", "pe", "tree", "and", "the", "correlation", "as", "expected", "the", "ob", "error", "estimates", "are", "consistently", "high", "it", "is", "low", "in", "the", "robot", "arm", "data", "but", "believe", "that", "this", "is", "an", "artifact", "caused", "by", "separate", "training", "and", "test", "sets", "where", "the", "testset", "may", "have", "slightly", "higher", "error", "rate", "than", "the", "training", "set", "as", "an", "experiment", "turned", "off", "the", "bagging", "and", "replaced", "it", "by", "randomizing", "outputs", "breiman", "1998b", "in", "this", "procedure", "mean", "zero", "gaussian", "noise", "is", "added", "to", "each", "of", "theoutputs", "the", "standard", "deviation", "of", "the", "noise", "is", "set", "equal", "to", "the", "standard", "deviation", "of", "the", "table", "error", "and", "ob", "estimates", "data", "set", "test", "error", "ob", "error", "pe", "tree", "cor", "boston", "housing", "10", "11", "26", "45", "ozone", "16", "17", "32", "55servo", "10", "24", "27", "56", "56", "abalone", "56robot", "arm", "10", "41", "friedman", "15", "41friedman", "10", "19", "20", "40", "51", "friedman", "10", "21", "22", "48", "49", "random", "forests", "29", "table", "mean", "squared", "test", "set", "error", "data", "set", "with", "bagging", "with", "noise", "boston", "housing", "10", "ozone", "17", "16", "3servo", "10", "24", "23", "abalone", "7robot", "arm", "10", "friedman", "1friedman", "10", "19", "20", "friedman", "10", "21", "19", "outputs", "similar", "to", "the", "bagging", "experiments", "tree", "construction", "was", "done", "using", "25", "features", "each", "random", "linear", "combination", "of", "two", "randomly", "selected", "inputs", "to", "split", "each", "node", "theresults", "are", "given", "in", "table", "the", "error", "rates", "on", "the", "rst", "two", "data", "sets", "are", "the", "lowest", "to", "date", "overall", "adding", "output", "noise", "works", "with", "random", "feature", "selection", "better", "than", "bagging", "this", "is", "illustrative", "of", "the", "exibility", "of", "the", "random", "forest", "setting", "various", "combinations", "of", "randomness", "can", "be", "added", "to", "see", "what", "works", "the", "best", "13", "remarks", "and", "conclusions", "random", "forests", "are", "an", "effective", "tool", "in", "prediction", "because", "of", "the", "law", "of", "large", "numbers", "they", "do", "not", "over", "injecting", "the", "right", "kind", "of", "randomness", "makes", "them", "accurate", "classi", "ers", "and", "regressors", "furthermore", "the", "framework", "in", "terms", "of", "strength", "of", "the", "individual", "predic", "tors", "and", "their", "correlations", "gives", "insight", "into", "the", "ability", "of", "the", "random", "forest", "to", "predict", "using", "out", "of", "bag", "estimation", "makes", "concrete", "the", "otherwise", "theoretical", "values", "of", "strengthand", "correlation", "for", "while", "the", "conventional", "thinking", "was", "that", "forests", "could", "not", "compete", "with", "arcing", "type", "algorithms", "in", "terms", "of", "accuracy", "our", "results", "dispel", "this", "belief", "but", "lead", "to", "interestingquestions", "boosting", "and", "arcing", "algorithms", "have", "the", "ability", "to", "reduce", "bias", "as", "well", "as", "variance", "schapire", "et", "al", "1998", "the", "adaptive", "bagging", "algorithm", "in", "regression", "breiman", "1999", "wasdesigned", "to", "reduce", "bias", "and", "operates", "effectively", "in", "classi", "cation", "as", "well", "as", "in", "regression", "but", "like", "arcing", "it", "also", "changes", "the", "training", "set", "as", "it", "progresses", "forests", "give", "results", "competitive", "with", "boosting", "and", "adaptive", "bagging", "yet", "do", "not", "progres", "sively", "change", "the", "training", "set", "their", "accuracy", "indicates", "that", "they", "act", "to", "reduce", "bias", "themechanism", "for", "this", "is", "not", "obvious", "random", "forests", "may", "also", "be", "viewed", "as", "bayesian", "pro", "cedure", "although", "doubt", "that", "this", "is", "fruitful", "line", "of", "exploration", "if", "it", "could", "explain", "the", "biasreduction", "might", "become", "more", "of", "bayesian", "random", "inputs", "and", "random", "features", "produce", "good", "results", "in", "classi", "cation", "less", "so", "in", "regression", "the", "only", "types", "of", "randomness", "used", "in", "this", "study", "is", "bagging", "and", "random", "features", "it", "may", "well", "be", "that", "other", "types", "of", "injected", "randomness", "give", "better", "results", "for", "instance", "oneof", "the", "referees", "has", "suggested", "use", "of", "random", "boolean", "combinations", "of", "features", "30", "breiman", "an", "almost", "obvious", "question", "is", "whether", "gains", "in", "accuracy", "can", "be", "gotten", "by", "combining", "random", "features", "with", "boosting", "for", "the", "larger", "data", "sets", "it", "seems", "that", "signi", "cantly", "lower", "error", "rates", "are", "possible", "on", "some", "runs", "we", "got", "errors", "as", "low", "as", "on", "the", "zip", "code", "data", "on", "the", "letters", "data", "and", "on", "the", "satellite", "data", "the", "improvement", "was", "less", "on", "thesmaller", "data", "sets", "more", "work", "is", "needed", "on", "this", "but", "it", "does", "suggest", "that", "different", "injectionsof", "randomness", "can", "produce", "better", "results", "recent", "paper", "breiman", "2000", "shows", "that", "in", "distribution", "space", "for", "two", "class", "problems", "random", "forests", "are", "equivalent", "to", "kernel", "acting", "on", "the", "true", "margin", "arguments", "are", "given", "thatrandomness", "low", "correlation", "enforces", "the", "symmetry", "of", "the", "kernel", "while", "strength", "enhancesa", "desirable", "skewness", "at", "abrupt", "curved", "boundaries", "hopefully", "this", "sheds", "light", "on", "the", "dualrole", "of", "correlation", "and", "strength", "the", "theoretical", "framework", "given", "by", "kleinberg", "2000", "forstochastic", "discrimination", "may", "also", "help", "understanding", "appendix", "almost", "sure", "convergence", "proof", "of", "theorem", "it", "suf", "ces", "to", "show", "that", "there", "is", "set", "of", "probability", "zero", "con", "the", "sequence", "space", "theta1", "theta12", "such", "that", "outside", "of", "for", "all", "nn", "summationdisplay", "1i", "theta1n", "theta1", "theta1", "for", "xed", "training", "set", "and", "xed", "theta1", "the", "set", "of", "all", "xsuch", "that", "theta1", "jis", "union", "of", "hyper", "rectangles", "for", "all", "theta1", "there", "is", "only", "nite", "number", "kof", "such", "unions", "of", "hyper", "rectangles", "denoted", "by", "s1", "sk", "ne", "theta1", "kif", "theta1", "sk", "let", "nkbe", "the", "number", "of", "times", "that", "theta1", "kin", "the", "rstntrials", "then", "nn", "summationdisplay", "1i", "theta1n", "summationdisplay", "knki", "sk", "by", "the", "law", "of", "large", "numbers", "nk", "nn", "summationdisplay", "1i", "theta1", "converges", "to", "theta1", "theta1", "taking", "unions", "of", "all", "the", "sets", "on", "which", "convergence", "does", "not", "occur", "for", "some", "value", "of", "kgives", "set", "cof", "zero", "probability", "such", "that", "outside", "of", "nn", "summationdisplay", "1i", "theta1n", "summationdisplay", "kp", "theta1", "theta1", "sk", "the", "right", "hand", "side", "is", "theta1", "theta1", "random", "forests", "31", "proof", "of", "theorem", "there", "are", "nite", "set", "of", "hyper", "rectangles", "r1", "rk", "such", "that", "if", "ykis", "the", "average", "of", "the", "training", "sets", "values", "for", "all", "training", "input", "vectors", "in", "rkthen", "theta1", "has", "one", "of", "the", "values", "sk", "yk", "the", "rest", "of", "the", "proof", "parallels", "that", "of", "theorem", "appendix", "ii", "out", "of", "bag", "estimates", "for", "strength", "and", "correlation", "at", "the", "end", "of", "combination", "run", "let", "summationdisplay", "ki", "theta1k", "tk", "slashbigg", "summationdisplay", "ki", "tk", "thus", "is", "the", "out", "of", "bag", "proportion", "of", "votes", "cast", "at", "xfor", "class", "and", "is", "an", "estimate", "forp", "theta1", "theta1", "from", "de", "nition", "the", "strength", "is", "the", "expectation", "of", "theta1", "theta1", "max", "negationslash", "yp", "theta1", "theta1", "substituting", "forp", "theta1", "theta1", "theta1", "theta1", "in", "this", "latter", "expres", "sion", "and", "taking", "the", "average", "over", "the", "training", "set", "gives", "the", "strength", "estimate", "from", "eq", "var", "mr", "theta1sd", "theta1", "the", "variance", "of", "mris", "ex", "theta1", "theta1", "max", "negationslash", "yp", "theta1", "theta1", "s2", "a1", "where", "sis", "the", "strength", "replacing", "the", "rst", "term", "in", "a1", "by", "the", "average", "over", "the", "training", "set", "of", "max", "negationslash", "yq", "andsby", "the", "out", "of", "bag", "estimate", "of", "sgives", "the", "estimate", "of", "var", "mr", "the", "standard", "deviation", "is", "given", "by", "sd", "theta1", "p1", "p2", "p1", "p2", "a2", "where", "p1", "ex", "theta1", "p2", "ex", "theta1", "32", "breiman", "after", "the", "kth", "classi", "er", "is", "constructed", "is", "computed", "and", "used", "to", "compute", "for", "every", "example", "in", "the", "training", "set", "then", "let", "p1be", "the", "average", "over", "all", "in", "the", "training", "set", "but", "not", "in", "the", "kth", "bagged", "training", "set", "of", "theta1k", "then", "p2is", "the", "similar", "average", "ofi", "theta1k", "substitute", "these", "estimates", "into", "a2", "to", "get", "an", "estimate", "of", "sd", "theta1k", "average", "the", "sd", "theta1k", "over", "all", "kto", "get", "the", "nal", "estimate", "of", "sd", "theta1", "references", "amit", "geman", "1997", "shape", "quantization", "and", "recognition", "with", "randomized", "trees", "neural", "computation", "1545", "1588", "amit", "blanchard", "wilder", "1999", "multiple", "randomized", "classi", "ers", "mrcl", "technical", "report", "depart", "ment", "of", "statistics", "university", "of", "chicago", "bauer", "kohavi", "1999", "an", "empirical", "comparison", "of", "voting", "classi", "cation", "algorithms", "machine", "learning", "36", "105", "139", "breiman", "1996a", "bagging", "predictors", "machine", "learning", "26", "123", "140", "breiman", "1996b", "out", "of", "bag", "estimation", "ftp", "stat", "berkeley", "edu", "pub", "users", "breiman", "oobestimation", "psbreiman", "1998a", "arcing", "classi", "ers", "discussion", "paper", "annals", "of", "statistics", "26", "801", "824", "breiman", "1998b", "randomizing", "outputs", "to", "increase", "prediction", "accuracy", "technical", "report", "518", "may", "1998", "statistics", "department", "ucb", "in", "press", "machine", "learning", "breiman", "1999", "using", "adaptive", "bagging", "to", "debias", "regressions", "technical", "report", "547", "statistics", "dept", "ucb", "breiman", "2000", "some", "in", "nity", "theory", "for", "predictor", "ensembles", "technical", "report", "579", "statistics", "dept", "ucb", "dietterich", "1998", "an", "experimental", "comparison", "of", "three", "methods", "for", "constructing", "ensembles", "of", "decision", "trees", "bagging", "boosting", "and", "randomization", "machine", "learning", "22", "freund", "schapire", "1996", "experiments", "with", "new", "boosting", "algorithm", "machine", "learning", "proceedings", "of", "the", "thirteenth", "international", "conference", "148", "156", "grove", "schuurmans", "1998", "boosting", "in", "the", "limit", "maximizing", "the", "margin", "of", "learned", "ensembles", "in", "proceedings", "of", "the", "fifteenth", "national", "conference", "on", "arti", "cial", "intelligence", "aaai", "98", "ho", "1998", "the", "random", "subspace", "method", "for", "constructing", "decision", "forests", "ieee", "trans", "on", "pattern", "analysis", "and", "machine", "intelligence", "20", "832", "844", "kleinberg", "2000", "on", "the", "algorithmic", "implementation", "of", "stochastic", "discrimination", "ieee", "trans", "on", "pattern", "analysis", "and", "machine", "intelligence", "22", "473", "490", "schapire", "freund", "bartlett", "lee", "1998", "boosting", "the", "margin", "new", "explanation", "for", "the", "effectiveness", "of", "voting", "methods", "annals", "of", "statistics", "26", "1651", "1686", "tibshirani", "1996", "bias", "variance", "and", "prediction", "error", "for", "classi", "cation", "rules", "technical", "report", "statistics", "department", "university", "of", "toronto", "wolpert", "macready", "1997", "an", "ef", "cient", "method", "to", "estimate", "bagging", "generalization", "error", "in", "press", "machine", "learning", "received", "november", "30", "1999", "revised", "april", "11", "2001accepted", "april", "11", "2001final", "manuscript", "april", "11", "2001"], "citations": ["(Breiman, 1996)", "(Dietterich, 1998)", "(Dieterrich, 1998)", "(Schapire et al., 1998)", "(Breiman, 1999)", "(Breiman, 2000)", "Amit, Y . & Geman, D. (1997). Shape quantization and recognition with randomized trees. Neural Computation,", "Amit, Y ., Blanchard, G., & Wilder, K. (1999). Multiple randomized classi ers: MRCL Technical Report, Depart-", "Bauer, E. & Kohavi, R. (1999). An empirical comparison of voting classi cation algorithms. Machine Learning,", "Breiman. L. (1998b). Randomizing outputs to increase prediction accuracy. Technical Report 518, May 1, 1998,", "Breiman, L. 1999. Using adaptive bagging to debias regressions. Technical Report 547, Statistics Dept. UCB.Breiman, L. 2000. Some in nity theory for predictor ensembles. Technical Report 579, Statist", "Freund, Y . & Schapire, R. (1996). Experiments with a new boosting algorithm, Machine Learning :Proceedings", "Ho, T. K. (1998). The random subspace method for constructing decision forests. IEEE Trans. on Pattern Analysis", "Tibshirani, R. (1996). Bias, variance, and prediction error for classi cation rules. Technical Report, Statistics", "Received November 30, 1999", "Revised April 11, 2001Accepted April 11, 2001Final manuscript April 11, 2001"]}
{"doc_id": 4, "url": "https://onlinelibrary.wiley.com/doi/pdfdirect/10.3322/caac.21660", "title": "Global Cancer Statistics 2020: GLOBOCAN Estimates of Incidence and Mortality Worldwide for 36 Cancers in 185 Countries", "title_tokens": ["global", "cancer", "statistics", "2020", "globocan", "estimates", "of", "incidence", "and", "mortality", "worldwide", "for", "36", "cancers", "in", "185", "countries"], "page_rank": {"cited_by_count": 107581}}
{"doc_id": 5, "url": "https://genomebiology.biomedcentral.com/counter/pdf/10.1186/s13059-014-0550-8", "title": "Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2", "title_tokens": ["moderated", "estimation", "of", "fold", "change", "and", "dispersion", "for", "rna", "seq", "data", "with", "deseq2"], "page_rank": {"cited_by_count": 91363}, "body_tokens": ["love", "et", "al", "genome", "biology", "2014", "15", "550", "doi", "10", "1186", "s13059", "014", "0550", "method", "open", "access", "moderated", "estimation", "of", "fold", "change", "and", "dispersion", "for", "rna", "seq", "data", "with", "deseq2", "michael", "love1", "gh", "r2and", "simon", "anders2", "abstract", "in", "comparative", "high", "throughput", "sequencing", "assays", "fu", "ndamental", "task", "is", "the", "analysis", "of", "count", "data", "such", "as", "read", "counts", "per", "gene", "in", "rna", "seq", "for", "evidence", "of", "systematic", "changes", "across", "experimental", "conditions", "small", "replicate", "numbers", "discreteness", "large", "dynamic", "range", "and", "the", "presence", "of", "outliers", "require", "suitable", "statistical", "approach", "we", "present", "deseq2", "method", "for", "differential", "analysis", "of", "count", "data", "using", "shrinkage", "estimation", "for", "dispersions", "and", "fold", "changes", "to", "improve", "stability", "and", "interpretability", "of", "estimates", "this", "enables", "more", "quantitative", "analysis", "focused", "on", "the", "strength", "rather", "than", "the", "mere", "presence", "of", "differential", "expression", "the", "deseq2", "package", "is", "available", "at", "http", "www", "bioconductor", "org", "packages", "release", "bioc", "html", "deseq2", "html", "background", "the", "rapid", "adoption", "of", "high", "throughput", "sequencing", "hts", "technologies", "for", "genomic", "studies", "has", "resulted", "in", "need", "for", "statistical", "methods", "to", "assess", "quantitative", "differences", "between", "experiments", "an", "important", "task", "here", "is", "the", "anal", "ysis", "of", "rna", "sequencing", "rna", "seq", "data", "with", "the", "aim", "of", "finding", "genes", "that", "are", "differentially", "expressed", "across", "groups", "of", "samples", "this", "task", "is", "general", "methods", "for", "it", "are", "typically", "also", "applicable", "for", "other", "comparative", "hts", "assays", "including", "chromatin", "immunoprecipitation", "sequencing", "chromosome", "conformation", "capture", "or", "counting", "observed", "taxa", "in", "metagenomic", "studies", "besides", "the", "need", "to", "account", "for", "the", "specifics", "of", "count", "data", "such", "as", "non", "normality", "and", "dependence", "of", "the", "vari", "ance", "on", "the", "mean", "core", "challenge", "is", "the", "small", "number", "of", "samples", "in", "typical", "hts", "experiments", "often", "as", "few", "as", "two", "or", "three", "replicates", "per", "condition", "inferential", "methods", "that", "treat", "each", "gene", "separately", "suffer", "here", "from", "lack", "of", "power", "due", "to", "the", "high", "uncertainty", "of", "within", "group", "vari", "ance", "estimates", "in", "high", "throughput", "assays", "this", "limitation", "can", "be", "overcome", "by", "pooling", "information", "across", "genes", "specifically", "by", "exploiting", "assumptions", "about", "the", "similarity", "of", "the", "variances", "of", "different", "genes", "measured", "in", "the", "same", "experiment", "correspondence", "sanders", "fs", "tum", "de", "2genome", "biology", "unit", "european", "molecular", "biology", "laboratory", "meyerhofstrasse", "69117", "heidelberg", "germany", "full", "list", "of", "author", "information", "is", "available", "at", "the", "end", "of", "the", "articlemany", "methods", "for", "differential", "expression", "analysis", "of", "rna", "seq", "data", "perform", "such", "information", "sharing", "across", "genes", "for", "variance", "or", "equivalently", "dispersion", "estima", "tion", "edger", "moderates", "the", "dispersion", "estimate", "for", "each", "gene", "toward", "common", "estimate", "across", "all", "genes", "or", "toward", "local", "estimate", "from", "genes", "with", "similar", "expres", "sion", "strength", "using", "weighted", "conditional", "likelihood", "our", "deseq", "method", "detects", "and", "corrects", "dispersion", "estimates", "that", "are", "too", "low", "through", "modeling", "of", "the", "depen", "dence", "of", "the", "dispersion", "on", "the", "average", "expression", "strength", "over", "all", "samples", "bbseq", "models", "the", "dispersion", "on", "the", "mean", "with", "the", "mean", "absolute", "deviation", "of", "disper", "sion", "estimates", "used", "to", "reduce", "the", "influence", "of", "outliers", "dss", "uses", "bayesian", "approach", "to", "provide", "an", "estimate", "for", "the", "dispersion", "for", "individual", "genes", "that", "accounts", "for", "the", "heterogeneity", "of", "dispersion", "values", "for", "different", "genes", "bayseq", "and", "shrinkbayes", "estimate", "priors", "for", "bayesian", "model", "over", "all", "genes", "and", "then", "provide", "posterior", "probabilities", "or", "false", "discovery", "rates", "fdrs", "for", "differential", "expression", "the", "most", "common", "approach", "in", "the", "comparative", "anal", "ysis", "of", "transcriptomics", "data", "is", "to", "test", "the", "null", "hypothesis", "that", "the", "logarithmic", "fold", "change", "lfc", "between", "treat", "ment", "and", "control", "for", "gene", "expression", "is", "exactly", "zero", "that", "the", "gene", "is", "not", "at", "all", "affected", "by", "the", "treatment", "often", "the", "goal", "of", "differential", "analysis", "is", "to", "produce", "list", "of", "genes", "passing", "multiple", "test", "adjustment", "ranked", "by", "pvalue", "however", "small", "changes", "even", "if", "statistically", "highly", "signif", "icant", "might", "not", "be", "the", "most", "interesting", "candidates", "for", "2014", "love", "et", "al", "licensee", "biomed", "central", "this", "is", "an", "open", "access", "article", "distributed", "under", "the", "terms", "of", "the", "creative", "commons", "attribution", "license", "http", "creat", "ivecommons", "org", "licenses", "by", "which", "permits", "unrestricted", "use", "distribution", "and", "reproduction", "in", "any", "medium", "provided", "the", "original", "work", "is", "properly", "credi", "ted", "the", "creative", "commons", "publ", "ic", "domain", "dedication", "waiver", "http", "creativecommons", "org", "publicdomain", "zero", "applies", "to", "the", "data", "made", "available", "in", "this", "article", "unless", "otherwise", "stated", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "further", "investigation", "ranking", "by", "fold", "change", "on", "the", "other", "hand", "is", "complicated", "by", "the", "noisiness", "of", "lfc", "estimates", "for", "genes", "with", "low", "counts", "furthermore", "the", "number", "of", "genes", "called", "significantly", "differentially", "expressed", "depends", "as", "much", "on", "the", "sample", "size", "and", "other", "aspects", "of", "experimen", "tal", "design", "as", "it", "does", "on", "the", "biology", "of", "the", "experiment", "and", "well", "powered", "experiments", "often", "generate", "an", "over", "whelmingly", "long", "list", "of", "hits", "we", "therefore", "developed", "statistical", "framework", "to", "facilitate", "gene", "ranking", "and", "visu", "alization", "based", "on", "stable", "estimation", "of", "effect", "sizes", "lfcs", "as", "well", "as", "testing", "of", "differential", "expression", "with", "respect", "to", "user", "defined", "thresholds", "of", "biological", "significance", "here", "we", "present", "deseq2", "successor", "to", "our", "deseq", "method", "deseq2", "integrates", "methodological", "advances", "with", "several", "novel", "features", "to", "facilitate", "more", "quantita", "tive", "analysis", "of", "comparative", "rna", "seq", "data", "using", "shrinkage", "estimators", "for", "dispersion", "nd", "fold", "change", "we", "demon", "strate", "the", "advantages", "of", "deseq2", "new", "features", "by", "describ", "ing", "number", "of", "applications", "possible", "with", "shrunken", "fold", "changes", "and", "their", "estimates", "of", "standard", "error", "including", "improved", "gene", "ranking", "and", "visualization", "hypothesis", "tests", "above", "and", "below", "threshold", "and", "the", "regularized", "loga", "rithm", "transformation", "for", "quality", "assessment", "and", "cluster", "ing", "of", "overdispersed", "count", "data", "we", "furthermore", "compare", "deseq2", "statistical", "power", "with", "existing", "tools", "revealing", "that", "our", "methodology", "has", "high", "sensitivity", "and", "precision", "while", "controlling", "the", "false", "positive", "rate", "deseq2", "is", "avail", "able", "10", "as", "an", "bioconductor", "package", "11", "results", "and", "discussion", "model", "and", "normalization", "the", "starting", "point", "of", "deseq2", "analysis", "is", "count", "matrix", "kwith", "one", "row", "for", "each", "gene", "iand", "one", "column", "for", "each", "sample", "the", "matrix", "entries", "kijindicate", "the", "number", "of", "sequencing", "reads", "that", "have", "been", "unambiguously", "mapped", "to", "gene", "in", "sample", "note", "that", "although", "we", "refer", "in", "this", "paper", "to", "counts", "of", "reads", "in", "genes", "the", "methods", "presented", "ec", "nb", "ea", "da", "sw", "lt", "oo", "rk", "so", "fh", "sc", "data", "for", "each", "gene", "we", "fit", "generalized", "linear", "model", "glm", "12", "as", "follows", "we", "model", "read", "counts", "kijas", "following", "negative", "bino", "mial", "distribution", "sometimes", "also", "called", "gamma", "poisson", "distribution", "with", "mean", "ijand", "dispersion", "em", "ni", "taken", "as", "quantity", "qij", "proportional", "to", "the", "concentration", "of", "cdna", "fragments", "from", "the", "gene", "in", "the", "sample", "scaled", "by", "normalization", "factor", "sij", "ij", "sijqij", "for", "many", "appli", "cations", "the", "same", "constant", "sjcan", "be", "used", "for", "all", "genes", "in", "sample", "which", "then", "accounts", "for", "differences", "in", "sequenc", "ing", "depth", "between", "samples", "to", "estimate", "these", "size", "factors", "thedeseq2", "package", "offers", "the", "median", "of", "ratios", "method", "already", "used", "in", "deseq", "however", "it", "can", "be", "advanta", "geous", "to", "calculate", "gene", "specific", "normalization", "factors", "sij", "to", "account", "for", "further", "sources", "of", "technical", "biases", "such", "as", "differing", "dependence", "on", "gc", "content", "gene", "length", "or", "thelike", "using", "published", "methods", "13", "14", "and", "these", "can", "be", "supplied", "instead", "we", "use", "glms", "with", "logarithmic", "link", "log2qij", "summationtext", "rxjr", "ir", "with", "design", "matrix", "elements", "xjrand", "coefficients", "ir", "in", "the", "simplest", "case", "of", "comparison", "between", "two", "groups", "such", "as", "treated", "and", "control", "samples", "the", "design", "matrix", "elements", "indicate", "whether", "sample", "jis", "treated", "or", "not", "and", "the", "glm", "fit", "returns", "coefficients", "indicating", "the", "overall", "expression", "strength", "of", "the", "gene", "and", "the", "log", "fold", "change", "between", "treatment", "and", "control", "the", "use", "of", "linear", "models", "however", "provides", "the", "flexibility", "to", "also", "ana", "lyze", "more", "complex", "designs", "as", "is", "often", "useful", "in", "genomic", "studies", "15", "empirical", "bayes", "shrinkage", "or", "dispersion", "estimation", "within", "group", "variability", "the", "variability", "between", "repli", "cates", "is", "modeled", "by", "the", "dispersion", "parameter", "describes", "the", "variance", "of", "counts", "via", "var", "kij", "ij", "ij", "accurate", "estimation", "of", "the", "dispersion", "parameter", "iis", "crit", "ical", "for", "the", "statistical", "inference", "of", "differential", "expression", "for", "studies", "with", "large", "sample", "sizes", "this", "is", "usually", "not", "problem", "for", "controlled", "experiments", "however", "sample", "sizes", "tend", "to", "be", "smaller", "experimental", "designs", "with", "as", "lit", "tle", "as", "two", "or", "three", "replicates", "are", "common", "and", "reasonable", "resulting", "in", "highly", "variable", "dispersion", "estimates", "for", "each", "gene", "if", "used", "directly", "these", "noisy", "estimates", "would", "com", "promise", "the", "accuracy", "of", "differential", "expression", "testing", "one", "sensible", "solution", "is", "to", "share", "information", "across", "genes", "in", "deseq2", "we", "assume", "that", "genes", "of", "similar", "aver", "age", "expression", "strength", "have", "similar", "dispersion", "we", "here", "explain", "the", "concepts", "of", "our", "approach", "using", "as", "examples", "dataset", "by", "bottomly", "et", "al", "16", "with", "rna", "seq", "data", "for", "mice", "of", "two", "different", "strains", "and", "dataset", "by", "pickrell", "et", "al", "17", "with", "rna", "seq", "data", "for", "human", "lymphoblastoid", "cell", "lines", "for", "the", "mathematical", "details", "see", "methods", "we", "first", "treat", "each", "gene", "separately", "and", "estimate", "gene", "wise", "dispersion", "estimates", "using", "maximum", "likelihood", "which", "rely", "only", "on", "the", "data", "of", "each", "individual", "gene", "black", "dots", "in", "figure", "next", "we", "determine", "the", "location", "parameter", "of", "the", "distribution", "of", "these", "estimates", "to", "allow", "for", "dependence", "on", "average", "expression", "strength", "we", "fit", "smooth", "curve", "as", "shown", "by", "the", "red", "line", "in", "figure", "this", "provides", "an", "accurate", "estimate", "for", "the", "expected", "dispersion", "value", "for", "genes", "of", "given", "expression", "strength", "but", "does", "not", "represent", "deviations", "of", "individual", "genes", "from", "this", "overall", "trend", "we", "then", "shrink", "the", "gene", "wise", "dispersion", "estimates", "toward", "the", "values", "predicted", "by", "the", "curve", "to", "obtain", "final", "dispersion", "values", "blue", "arrow", "heads", "we", "use", "an", "empiri", "cal", "bayes", "approach", "methods", "which", "lets", "the", "strength", "of", "shrinkage", "depend", "on", "an", "estimate", "of", "how", "close", "true", "dis", "persion", "values", "tend", "to", "be", "to", "the", "fit", "and", "ii", "on", "the", "degrees", "of", "freedom", "as", "the", "sample", "size", "increases", "the", "shrinkage", "decreases", "in", "strength", "and", "eventually", "becomes", "negligi", "ble", "our", "approach", "therefore", "accounts", "for", "gene", "specific", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "figure", "shrinkage", "estimation", "of", "dispersion", "plot", "of", "dispersion", "estimates", "over", "the", "average", "expression", "strength", "for", "the", "bottomly", "et", "al", "16", "dataset", "with", "six", "samples", "across", "two", "groups", "and", "for", "five", "samples", "from", "the", "pickrell", "et", "al", "17", "dataset", "fitting", "only", "an", "intercept", "term", "first", "gene", "wise", "mles", "are", "obtained", "using", "only", "the", "respective", "gene", "data", "black", "dots", "then", "curve", "red", "is", "fit", "to", "the", "mles", "to", "capture", "the", "overall", "trend", "of", "dispersion", "mean", "dependence", "this", "fit", "is", "used", "as", "prior", "mean", "for", "second", "estimation", "round", "which", "results", "in", "the", "final", "map", "estimates", "of", "dispersion", "arrow", "heads", "this", "can", "be", "understood", "as", "shrinkage", "along", "the", "blue", "arrows", "of", "the", "noisy", "gene", "wise", "estimates", "toward", "the", "consensus", "represented", "by", "the", "red", "line", "the", "black", "points", "circled", "in", "blue", "are", "detected", "as", "dispersion", "outliers", "and", "not", "shrunk", "toward", "the", "prior", "shrinkage", "would", "follow", "the", "dotted", "line", "for", "clarity", "only", "subset", "of", "genes", "is", "shown", "which", "is", "enriched", "for", "dispersion", "outliers", "additional", "file", "figure", "s1", "displays", "the", "same", "da", "ta", "but", "with", "dispersions", "of", "all", "genes", "shown", "map", "maximum", "posteriori", "mle", "maximum", "likelihood", "estimate", "variation", "to", "the", "extent", "that", "the", "data", "provide", "this", "informa", "tion", "while", "the", "fitted", "curve", "aids", "estimation", "and", "testing", "in", "less", "information", "rich", "settings", "our", "approach", "is", "similar", "to", "the", "one", "used", "by", "dss", "in", "that", "both", "methods", "sequentially", "estimate", "prior", "dis", "tribution", "for", "the", "true", "dispersion", "values", "around", "the", "fit", "and", "then", "provide", "the", "maximum", "posteriori", "map", "as", "the", "final", "estimate", "it", "differs", "from", "the", "previous", "imple", "mentation", "of", "deseq", "which", "used", "the", "maximum", "of", "the", "fitted", "curve", "and", "the", "gene", "wise", "dispersion", "estimate", "as", "the", "final", "estimate", "and", "tended", "to", "overestimate", "the", "dispersions", "additional", "file", "figure", "s2", "the", "approach", "of", "deseq2", "differs", "from", "that", "of", "edger", "as", "deseq2", "estimates", "the", "width", "of", "the", "prior", "distribution", "from", "the", "data", "and", "there", "fore", "automatically", "controls", "th", "ea", "to", "fs", "eb", "on", "the", "observed", "properties", "of", "the", "data", "in", "contrast", "the", "default", "steps", "in", "edger", "require", "user", "adjustable", "parameter", "theprior", "degrees", "of", "freedom", "which", "weighs", "the", "contribu", "tion", "of", "the", "individual", "gene", "estimate", "and", "edger", "dispersion", "fit", "note", "that", "in", "figure", "number", "of", "genes", "with", "gene", "wise", "dispersion", "estimates", "below", "the", "curve", "have", "their", "final", "estimates", "raised", "substantially", "the", "shrinkage", "procedure", "thereby", "helps", "avoid", "potential", "false", "positives", "which", "can", "result", "from", "underestimates", "of", "dispersion", "if", "on", "the", "other", "hand", "an", "individual", "gene", "dispersion", "is", "far", "above", "the", "dis", "tribution", "of", "the", "gene", "wise", "dispersion", "estimates", "of", "other", "genes", "then", "the", "shrinkage", "would", "lead", "to", "greatly", "reduced", "final", "estimate", "of", "dispersion", "we", "reasoned", "that", "in", "many", "cases", "the", "reason", "for", "extraordinarily", "high", "dispersion", "of", "agene", "is", "that", "it", "does", "not", "obey", "our", "modeling", "assumptions", "some", "genes", "may", "show", "much", "higher", "variability", "than", "others", "for", "biological", "or", "technical", "reasons", "even", "though", "they", "have", "the", "same", "average", "expression", "levels", "in", "these", "cases", "infer", "ence", "based", "on", "the", "shrunken", "dispersion", "estimates", "could", "lead", "to", "undesirable", "false", "positive", "calls", "deseq2", "handles", "these", "cases", "by", "using", "the", "gene", "wise", "estimate", "instead", "of", "the", "shrunken", "estimate", "when", "the", "former", "is", "more", "than", "residual", "standard", "deviations", "above", "the", "curve", "empirical", "bayes", "shrinkage", "for", "fold", "change", "estimation", "common", "difficulty", "in", "the", "analysis", "of", "hts", "data", "is", "the", "strong", "variance", "of", "lfc", "estimates", "for", "genes", "with", "low", "read", "count", "we", "demonstrate", "this", "issue", "using", "the", "dataset", "by", "bottomly", "et", "al", "16", "as", "visualized", "in", "figure", "2a", "weakly", "expressed", "genes", "seem", "to", "show", "much", "stronger", "differ", "ences", "between", "the", "compared", "ouse", "strains", "than", "strongly", "expressed", "genes", "this", "phenomenon", "seen", "in", "most", "hts", "datasets", "is", "direct", "consequence", "of", "dealing", "with", "count", "data", "in", "which", "ratios", "are", "inherently", "noisier", "when", "counts", "are", "low", "this", "heteroskedasticity", "variance", "of", "lfcs", "depend", "ing", "on", "mean", "count", "complicates", "downstream", "analysis", "and", "data", "interpretation", "as", "it", "makes", "effect", "sizes", "difficult", "to", "compare", "across", "the", "dynamic", "range", "of", "the", "data", "deseq2", "overcomes", "this", "issue", "by", "shrinking", "lfc", "esti", "mates", "toward", "zero", "in", "manner", "such", "that", "shrinkage", "is", "stronger", "when", "the", "available", "information", "for", "gene", "is", "low", "which", "may", "be", "because", "counts", "are", "low", "dispersion", "is", "high", "or", "there", "are", "few", "degrees", "of", "freedom", "we", "again", "employ", "an", "empirical", "bayes", "procedure", "we", "first", "perform", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "figure", "effect", "of", "shrinkage", "on", "logarithmic", "fold", "change", "estimates", "plots", "of", "the", "mle", "no", "shrinkage", "and", "map", "estimate", "with", "shrinkage", "for", "the", "lfcs", "attributable", "to", "mouse", "strain", "over", "the", "average", "expression", "strength", "for", "ten", "vs", "eleven", "sample", "comparison", "of", "the", "bottomly", "et", "al", "16", "dataset", "small", "triangles", "at", "the", "top", "and", "bottom", "of", "the", "plots", "indicate", "points", "that", "would", "fall", "outside", "of", "the", "plotting", "window", "two", "genes", "with", "similar", "mean", "count", "and", "mle", "logarithmic", "fold", "change", "are", "highlighted", "with", "green", "and", "purple", "circles", "the", "counts", "normalized", "by", "size", "factors", "sj", "for", "these", "genes", "reveal", "low", "dispersion", "for", "the", "gene", "in", "green", "and", "high", "dispersion", "for", "the", "gene", "in", "purple", "density", "plots", "of", "the", "likelihoods", "solid", "lines", "scaled", "to", "integrate", "to", "and", "the", "posteriors", "dashed", "lines", "for", "the", "green", "and", "purple", "genes", "and", "of", "the", "prior", "solid", "black", "line", "due", "to", "the", "higher", "dispersion", "of", "the", "purple", "gene", "its", "likelihood", "is", "wider", "and", "less", "peaked", "indic", "ating", "less", "information", "and", "the", "prior", "has", "more", "influence", "on", "its", "posterio", "than", "for", "the", "green", "gene", "the", "stronger", "curvature", "of", "the", "green", "posterior", "at", "its", "maximum", "translates", "to", "smaller", "reported", "standard", "error", "for", "the", "map", "lfc", "estimate", "horizontal", "error", "bar", "adj", "adjusted", "lfc", "logarithmic", "fold", "change", "map", "maximum", "posteriori", "mle", "maximum", "likelihood", "estimate", "ordinary", "glm", "fits", "to", "obtain", "maximum", "likelihood", "esti", "mates", "mles", "for", "the", "lfcs", "and", "then", "fit", "zero", "centered", "normal", "distribution", "to", "the", "observed", "distribution", "of", "mles", "over", "all", "genes", "this", "distribution", "is", "used", "as", "prior", "on", "lfcs", "in", "second", "round", "of", "glm", "fits", "and", "the", "map", "estimates", "are", "kept", "as", "final", "estimates", "of", "lfc", "furthermore", "stan", "dard", "error", "for", "each", "estimate", "is", "reported", "which", "is", "derived", "from", "the", "posterior", "curvature", "at", "its", "maximum", "see", "methods", "for", "details", "these", "shrunken", "lfcs", "and", "their", "stan", "dard", "errors", "are", "used", "in", "the", "wald", "tests", "for", "differential", "expression", "described", "in", "the", "next", "section", "the", "resulting", "map", "lfcs", "are", "biased", "toward", "zero", "in", "manner", "that", "removes", "the", "problem", "of", "exaggerated", "lfcs", "for", "low", "counts", "as", "figure", "2b", "shows", "the", "strongest", "lfcs", "are", "no", "longer", "exhibited", "by", "genes", "with", "weakest", "expression", "rather", "the", "estimates", "are", "more", "evenl", "ys", "da", "dz", "dfor", "very", "weakly", "expressed", "genes", "with", "less", "than", "one", "read", "per", "sample", "on", "average", "lfcs", "hardly", "deviate", "from", "zero", "reflecting", "that", "accurate", "lfc", "estimates", "are", "not", "possible", "here", "the", "strength", "of", "shrinkage", "does", "not", "depend", "simply", "on", "the", "mean", "count", "but", "rather", "on", "the", "amount", "of", "informa", "tion", "available", "for", "the", "fold", "change", "estimation", "as", "indicated", "by", "the", "observed", "fisher", "information", "see", "methods", "two", "genes", "with", "equal", "expression", "strength", "but", "different", "dis", "persions", "will", "experience", "different", "amount", "of", "shrinkage", "figure", "2c", "the", "shrinkage", "of", "lfc", "estimates", "can", "be", "described", "as", "bias", "variance", "trade", "off", "18", "for", "genes", "with", "little", "information", "for", "lfc", "estimation", "reduction", "of", "the", "strong", "variance", "is", "bought", "at", "the", "cost", "of", "accepting", "bias", "toward", "zero", "and", "this", "can", "result", "in", "an", "overall", "reduc", "tion", "in", "mean", "squared", "error", "when", "comparing", "to", "lfc", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "estimates", "from", "new", "dataset", "genes", "with", "high", "informa", "tion", "for", "lfc", "estimation", "will", "have", "in", "our", "approach", "lfcs", "with", "both", "low", "bias", "and", "low", "variance", "furthermore", "as", "the", "degrees", "of", "freedom", "increase", "and", "the", "experiment", "pro", "vides", "more", "information", "for", "lfc", "estimation", "the", "shrunken", "estimates", "will", "converge", "to", "the", "unshrunken", "estimates", "we", "note", "that", "other", "bayesian", "efforts", "toward", "moderating", "fold", "changes", "for", "rna", "seq", "include", "hierarchical", "models", "19", "and", "the", "gfold", "or", "generalized", "fold", "change", "tool", "20", "which", "uses", "posterior", "distribution", "of", "lfcs", "the", "shrunken", "map", "lfcs", "offer", "more", "reproducible", "quantification", "of", "transcriptional", "differences", "than", "standard", "mle", "lfcs", "to", "demonstrate", "this", "we", "split", "the", "bottomly", "et", "al", "samples", "equally", "into", "two", "groups", "and", "ii", "such", "that", "each", "group", "contained", "balanced", "split", "of", "the", "strains", "sim", "ulating", "scenario", "where", "an", "experiment", "samples", "in", "group", "is", "performed", "analyzed", "and", "reported", "and", "then", "indepen", "dently", "replicated", "samples", "in", "group", "ii", "within", "each", "group", "we", "estimated", "lfcs", "between", "the", "strains", "and", "compared", "between", "groups", "and", "ii", "using", "the", "mle", "lfcs", "figure", "3a", "and", "using", "the", "map", "lfcs", "figure", "3b", "because", "the", "shrinkage", "moves", "large", "lfcs", "that", "are", "not", "well", "supported", "by", "the", "data", "toward", "zero", "the", "agreement", "between", "the", "two", "independent", "sample", "groups", "increases", "considerably", "therefore", "shrunken", "fold", "change", "estimates", "offer", "more", "reliable", "basis", "for", "quantitative", "conclusions", "than", "normal", "mles", "this", "makes", "shrunken", "lfcs", "also", "suitable", "for", "ranking", "genes", "to", "prioritize", "them", "for", "follow", "up", "experiments", "for", "example", "if", "we", "sort", "the", "genes", "in", "the", "two", "sample", "groups", "of", "figure", "by", "unshrunken", "lfc", "estimates", "and", "consider", "the", "100", "genes", "with", "the", "strongest", "up", "or", "down", "regulation", "in", "group", "we", "find", "only", "21", "of", "these", "again", "among", "the", "top", "100", "up", "or", "down", "regulated", "genes", "in", "group", "ii", "however", "ifwe", "rank", "the", "genes", "by", "shrunken", "lfc", "estimates", "the", "overlap", "improves", "to", "81", "of", "100", "genes", "additional", "file", "figure", "s3", "simpler", "often", "used", "method", "is", "to", "add", "fixed", "num", "ber", "pseudocount", "to", "all", "counts", "before", "forming", "ratios", "however", "this", "requires", "the", "choice", "of", "tuning", "parame", "ter", "and", "only", "reacts", "to", "one", "of", "the", "sources", "of", "uncertainty", "low", "counts", "but", "not", "to", "gene", "specific", "dispersion", "differences", "or", "sample", "size", "we", "demonstrate", "this", "in", "the", "benchmarks", "section", "below", "hypothesis", "tests", "for", "differential", "expression", "after", "glms", "are", "fit", "for", "each", "gene", "one", "may", "test", "whether", "each", "model", "coefficient", "differs", "significantly", "from", "zero", "deseq2", "reports", "the", "standard", "error", "for", "each", "shrunken", "lfc", "estimate", "obtained", "from", "the", "curvature", "of", "the", "coefficient", "posterior", "dashed", "lines", "in", "figure", "2d", "at", "its", "maximum", "for", "significance", "testing", "deseq2", "uses", "wald", "test", "the", "shrunken", "estimate", "of", "lfc", "is", "divided", "by", "its", "standard", "error", "resulting", "in", "statistic", "which", "is", "compared", "to", "standard", "normal", "distribution", "see", "methods", "for", "details", "the", "wald", "test", "allows", "testing", "of", "individual", "coefficients", "or", "contrasts", "of", "coefficients", "without", "the", "need", "to", "fit", "reduced", "model", "as", "with", "the", "likelihood", "ratio", "test", "though", "the", "likelihood", "ratio", "test", "is", "also", "available", "as", "an", "option", "in", "deseq2", "ew", "dt", "pvalues", "from", "the", "subset", "of", "genes", "that", "pass", "an", "independent", "filtering", "step", "described", "in", "the", "next", "section", "are", "adjusted", "for", "multiple", "testing", "using", "the", "procedure", "of", "benjamini", "and", "hochberg", "21", "automatic", "independent", "filtering", "et", "ot", "el", "en", "ro", "ft", "sp", "di", "nt", "ea", "sis", "of", "rna", "seq", "and", "other", "genome", "wide", "experiments", "the", "multiple", "testing", "problem", "needs", "to", "be", "addressed", "popu", "lar", "objective", "is", "control", "or", "estimation", "of", "the", "fdr", "multiple", "figure", "stability", "of", "logarithmic", "fold", "changes", "deseq2", "is", "run", "on", "equally", "split", "halves", "of", "the", "data", "of", "bottomly", "et", "al", "16", "and", "the", "lfcs", "from", "the", "halves", "are", "plotted", "against", "each", "other", "mles", "without", "lfc", "shrinkage", "map", "estimates", "with", "shrinkage", "points", "in", "the", "top", "left", "and", "bottom", "right", "quadrants", "indicate", "genes", "with", "change", "of", "sign", "of", "lfc", "red", "points", "indicate", "genes", "with", "adjusted", "pvalue", "the", "legend", "displays", "the", "root", "mean", "square", "error", "of", "the", "estimates", "in", "group", "compared", "to", "those", "in", "group", "ii", "lfc", "logarithmic", "fold", "change", "map", "maximum", "posteriori", "mle", "maximum", "likelihood", "estimate", "rmse", "root", "mean", "square", "error", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "testing", "adjustment", "tends", "to", "be", "associated", "with", "loss", "of", "power", "in", "the", "sense", "that", "the", "fdr", "for", "set", "of", "genes", "is", "often", "higher", "than", "the", "individual", "pvalues", "of", "these", "genes", "however", "the", "loss", "can", "be", "reduced", "if", "genes", "that", "have", "little", "or", "no", "chance", "of", "being", "detected", "as", "differentially", "expressed", "are", "omitted", "from", "the", "testing", "provided", "that", "the", "criterion", "for", "omission", "is", "independent", "of", "the", "test", "statistic", "under", "the", "null", "hypothesis", "22", "see", "methods", "deseq2", "uses", "the", "aver", "age", "expression", "strength", "of", "each", "gene", "across", "all", "samples", "as", "its", "filter", "criterion", "and", "it", "omits", "all", "genes", "with", "mean", "normalized", "counts", "below", "filtering", "threshold", "from", "mul", "tiple", "testing", "adjustment", "deseq2", "by", "default", "will", "choose", "threshold", "that", "maximizes", "the", "number", "of", "genes", "found", "at", "user", "specified", "target", "fdr", "in", "figures", "2a", "and", "genes", "found", "in", "this", "way", "to", "be", "significant", "at", "an", "estimated", "fdr", "of", "10", "are", "depicted", "in", "red", "depending", "on", "the", "distribution", "of", "the", "mean", "normalized", "counts", "the", "resulting", "increase", "in", "power", "can", "be", "substantial", "sometimes", "making", "the", "differ", "ence", "in", "whether", "or", "not", "any", "differentially", "expressed", "genes", "are", "detected", "hypothesis", "tests", "with", "thresholds", "on", "effect", "size", "specifying", "minimum", "effect", "size", "most", "approaches", "to", "testing", "for", "differential", "expression", "including", "the", "default", "approach", "of", "deseq2", "ta", "the", "null", "hypothesis", "of", "zero", "lfc", "however", "if", "any", "bio", "logical", "processes", "are", "genuinely", "affected", "by", "the", "difference", "in", "experimental", "treatment", "this", "null", "hypothesis", "implies", "that", "the", "gene", "under", "consideration", "is", "perfectly", "decoupled", "from", "these", "processes", "due", "to", "the", "high", "interconnected", "ness", "of", "cells", "regulatory", "networks", "this", "hypothesis", "is", "in", "fact", "implausible", "and", "arguably", "wrong", "for", "many", "if", "not", "most", "genes", "consequently", "with", "sufficient", "sample", "size", "even", "genes", "with", "very", "small", "but", "non", "zero", "lfc", "will", "even", "tually", "be", "detected", "as", "differentially", "expressed", "change", "should", "therefore", "be", "of", "sufficient", "magnitude", "to", "be", "consid", "ered", "biologically", "significant", "for", "small", "scale", "experiments", "statistical", "significance", "is", "often", "much", "stricter", "require", "ment", "than", "biological", "significance", "thereby", "relieving", "the", "researcher", "from", "the", "need", "to", "decide", "on", "threshold", "for", "biological", "significance", "for", "well", "powered", "experiments", "however", "statistical", "test", "against", "the", "conventional", "null", "hypothesis", "of", "zero", "lfc", "may", "report", "genes", "with", "statistically", "significant", "changes", "that", "are", "so", "weak", "in", "effect", "strength", "that", "they", "could", "be", "consid", "ered", "irrelevant", "or", "distracting", "common", "procedure", "is", "to", "disregard", "genes", "whose", "estimated", "lfc", "iris", "below", "some", "threshold", "ir", "however", "this", "approach", "loses", "the", "benefit", "of", "an", "easily", "interpretable", "fdr", "as", "the", "reported", "value", "and", "adjusted", "pvalue", "still", "correspond", "to", "the", "test", "of", "zero", "lfc", "it", "is", "therefore", "desirable", "to", "include", "the", "thresh", "old", "in", "the", "statistical", "testing", "procedure", "directly", "not", "to", "filter", "post", "hoc", "on", "reported", "fold", "change", "estimate", "but", "rather", "to", "evaluate", "statistically", "directly", "whether", "thereis", "sufficient", "evidence", "that", "the", "lfc", "is", "above", "the", "chosen", "threshold", "deseq2", "offers", "tests", "for", "composite", "null", "hypotheses", "of", "the", "form", "ir", "iris", "the", "shrunken", "lfc", "from", "the", "estimation", "procedure", "described", "above", "see", "methods", "for", "details", "figure", "4a", "demo", "nstrates", "how", "such", "thresh", "olded", "test", "gives", "rise", "to", "curved", "decision", "boundary", "to", "reach", "significance", "the", "estimated", "lfc", "has", "to", "exceed", "the", "specified", "threshold", "by", "an", "amount", "that", "depends", "on", "the", "available", "information", "we", "note", "that", "related", "approaches", "to", "generate", "gene", "lists", "that", "satisfy", "both", "statistical", "and", "biolog", "ical", "significance", "criteria", "have", "been", "previously", "discussed", "for", "microarray", "data", "23", "and", "recently", "for", "sequencing", "data", "19", "specifying", "maximum", "effect", "size", "sometimes", "researcher", "is", "interested", "in", "finding", "genes", "that", "en", "ro", "yv", "yw", "db", "yt", "et", "to", "experimental", "condition", "this", "amounts", "to", "setting", "simi", "lar", "to", "the", "one", "just", "discussed", "but", "the", "roles", "of", "the", "null", "and", "eh", "sa", "es", "ea", "eh", "ea", "for", "evidence", "of", "the", "effect", "being", "weak", "not", "for", "evidence", "of", "the", "effect", "being", "zero", "because", "the", "latter", "question", "is", "rarely", "tractable", "the", "meaning", "of", "weak", "needs", "to", "be", "quantified", "for", "the", "biological", "question", "at", "hand", "by", "choosing", "suit", "able", "threshold", "rt", "el", "rs", "ha", "deseq2", "offers", "test", "of", "the", "composite", "null", "hypothesis", "ir", "which", "will", "report", "genes", "as", "significant", "for", "which", "there", "is", "evidence", "that", "their", "lfc", "is", "weaker", "than", "e4", "bs", "the", "outcome", "of", "such", "test", "for", "genes", "with", "very", "low", "read", "count", "even", "an", "estimate", "of", "zero", "lfc", "is", "not", "significant", "as", "the", "large", "uncertainty", "of", "the", "estimate", "does", "not", "allow", "us", "to", "exclude", "that", "the", "gene", "may", "in", "truth", "be", "more", "than", "weakly", "affected", "by", "the", "experimental", "condition", "note", "the", "lack", "of", "lfc", "shrinkage", "to", "fin", "genes", "with", "weak", "differen", "tial", "expression", "deseq2", "requires", "that", "the", "lfc", "shrinkage", "has", "been", "disabled", "this", "is", "because", "the", "zero", "centered", "prior", "used", "for", "lfc", "shrinkage", "embodies", "prior", "belief", "that", "lfcs", "tend", "to", "be", "small", "and", "hence", "is", "inappropriate", "here", "detection", "of", "count", "outliers", "parametric", "methods", "for", "detecting", "differential", "expression", "can", "have", "gene", "wise", "estimates", "of", "lfc", "overly", "influenced", "by", "individual", "outliers", "that", "do", "not", "fit", "the", "distributional", "assumptions", "of", "the", "model", "24", "an", "example", "of", "such", "an", "outlier", "would", "be", "gene", "with", "single", "digit", "counts", "for", "all", "samples", "except", "one", "sample", "with", "count", "in", "the", "thousands", "as", "the", "aim", "of", "differential", "expression", "analysis", "is", "typically", "to", "findconsistently", "up", "or", "down", "regulated", "genes", "it", "is", "useful", "to", "consider", "diagnostics", "for", "detecting", "individual", "observa", "tions", "that", "overly", "influence", "the", "lfc", "estimate", "and", "pvalue", "for", "gene", "standard", "outlier", "diagnostic", "is", "cook", "dis", "tance", "25", "which", "is", "defined", "within", "each", "gene", "for", "each", "sample", "as", "the", "scaled", "distance", "that", "the", "coefficient", "vector", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "figure", "hypothesis", "testing", "involving", "non", "zero", "thresholds", "shown", "are", "plots", "of", "the", "estimated", "fold", "change", "over", "average", "expression", "strength", "minus", "over", "average", "or", "ma", "plots", "for", "ten", "vs", "eleven", "comparison", "using", "the", "bottomly", "et", "al", "16", "dataset", "with", "highlight", "ed", "points", "indicating", "low", "adjusted", "pvalues", "the", "alternate", "hypotheses", "are", "that", "logarithmic", "base", "fold", "changes", "are", "greater", "than", "in", "absolute", "value", "or", "less", "than", "in", "absolute", "value", "adj", "adjusted", "vector", "fal", "rm", "lo", "rg", "mw", "dm", "ei", "ft", "es", "were", "removed", "and", "the", "model", "refit", "deseq2", "flags", "for", "each", "gene", "those", "samples", "that", "have", "cook", "distance", "greater", "than", "the", "99", "quantile", "of", "the", "distribution", "where", "pis", "the", "number", "of", "model", "parameters", "including", "the", "intercept", "and", "mis", "the", "num", "ber", "of", "samples", "the", "use", "of", "the", "fdistribution", "is", "motivated", "by", "the", "heuristic", "reasoning", "that", "removing", "single", "sample", "should", "not", "move", "the", "vector", "vector", "ioutside", "of", "99", "confidence", "region", "around", "vector", "ifit", "using", "all", "the", "samples", "25", "however", "if", "there", "are", "two", "or", "fewer", "replicates", "for", "condition", "these", "samples", "do", "not", "contribute", "to", "outlier", "detection", "as", "there", "are", "insufficient", "replicates", "to", "determine", "outlier", "status", "how", "should", "one", "deal", "with", "flagged", "outliers", "in", "an", "exper", "iment", "with", "many", "replicates", "discarding", "the", "outlier", "and", "proceeding", "with", "the", "remaining", "data", "might", "make", "best", "use", "of", "the", "available", "data", "in", "small", "experiment", "with", "few", "samples", "however", "the", "presence", "of", "an", "outlier", "can", "impair", "inference", "regarding", "the", "affected", "gene", "and", "merely", "ignoring", "the", "outlier", "may", "even", "be", "considered", "data", "cherry", "picking", "and", "therefore", "it", "is", "more", "prudent", "to", "exclude", "the", "whole", "gene", "from", "downstream", "analysis", "hence", "deseq2", "offers", "two", "possible", "responses", "to", "flagged", "outliers", "by", "default", "outliers", "in", "conditions", "with", "six", "or", "fewer", "sc", "et", "ew", "eg", "et", "ob", "ef", "da", "dr", "from", "subsequent", "analysis", "including", "pvalue", "adjustment", "for", "multiple", "testing", "for", "conditions", "that", "contain", "seven", "or", "more", "replicates", "deseq2", "replaces", "the", "outlier", "counts", "with", "an", "imputed", "value", "namely", "the", "trimmed", "mean", "over", "all", "samples", "scaled", "by", "the", "size", "factor", "and", "then", "re", "estimates", "the", "dispersion", "lfcs", "and", "pvalues", "for", "these", "genes", "as", "the", "outlier", "is", "replaced", "with", "the", "value", "predicted", "by", "the", "null", "hypothesis", "of", "no", "differential", "expression", "this", "is", "more", "conservative", "choice", "than", "simply", "omitting", "the", "out", "lier", "when", "there", "are", "many", "degrees", "of", "freedom", "the", "second", "approach", "avoids", "discarding", "genes", "that", "might", "contain", "true", "differential", "expression", "additional", "file", "figure", "s4", "displays", "the", "outlier", "replace", "tp", "ef", "ras", "eg", "ei", "nas", "nb", "ys", "comparison", "of", "the", "bottomly", "et", "al", "16", "dataset", "while", "the", "original", "fitted", "means", "are", "heavily", "influenced", "by", "single", "sample", "with", "large", "count", "the", "corrected", "lfcs", "provide", "better", "fit", "to", "the", "majority", "of", "the", "samples", "regularized", "logarithm", "transformation", "for", "certain", "analyses", "it", "is", "useful", "to", "transform", "data", "to", "ren", "der", "them", "homoskedastic", "as", "an", "example", "consider", "the", "task", "of", "assessing", "sample", "similarities", "in", "an", "unsupervised", "man", "ner", "using", "clustering", "or", "ordination", "algorithm", "for", "rna", "seq", "data", "the", "problem", "of", "heteroskedasticity", "arises", "if", "the", "data", "are", "given", "to", "such", "an", "algorithm", "on", "the", "original", "count", "scale", "the", "result", "will", "be", "dominated", "by", "highly", "expressed", "highly", "variable", "genes", "if", "logarithm", "transformed", "data", "are", "used", "undue", "weight", "will", "be", "given", "to", "weakly", "expressed", "genes", "which", "show", "exaggerated", "lfcs", "as", "discussed", "above", "therefore", "we", "use", "the", "shrinkage", "approach", "of", "deseq2", "to", "implement", "regularized", "logarithm", "transformation", "rlog", "which", "behaves", "similarly", "to", "log2transformation", "for", "genes", "with", "high", "counts", "while", "shrinking", "together", "the", "values", "for", "different", "samples", "for", "genes", "with", "low", "counts", "it", "therefore", "avoids", "commonly", "observed", "property", "of", "the", "standard", "logarithm", "transformation", "the", "spreading", "apart", "of", "data", "for", "genes", "with", "low", "counts", "where", "random", "noise", "is", "likely", "to", "dominate", "any", "biologically", "meaningful", "signal", "when", "we", "consider", "the", "variance", "of", "each", "gene", "computed", "across", "sam", "ples", "these", "variances", "are", "stabilized", "approximately", "the", "same", "or", "homoskedastic", "after", "the", "rlog", "transforma", "tion", "while", "they", "would", "otherwise", "strongly", "depend", "on", "the", "mean", "counts", "it", "thus", "facilitates", "multivariate", "visualization", "and", "ordinations", "such", "as", "clustering", "or", "principal", "component", "analysis", "that", "tend", "to", "work", "best", "when", "the", "variables", "have", "similar", "dynamic", "range", "note", "that", "while", "the", "rlog", "transfor", "mation", "builds", "upon", "on", "our", "lfc", "shrinkage", "approach", "it", "is", "distinct", "from", "and", "not", "part", "of", "the", "statistical", "inference", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "procedure", "for", "differential", "expression", "analysis", "described", "above", "which", "employs", "the", "raw", "counts", "not", "transformed", "data", "the", "rlog", "transformation", "is", "cal", "culated", "by", "fitting", "for", "each", "gene", "glm", "with", "baseline", "expression", "intercept", "only", "and", "computing", "for", "each", "sample", "shrunken", "lfcs", "with", "respect", "to", "the", "baseline", "using", "the", "same", "empiri", "cal", "bayes", "procedure", "as", "before", "methods", "here", "how", "ever", "the", "sample", "covariate", "information", "treatment", "or", "control", "is", "not", "used", "so", "that", "all", "samples", "are", "treated", "equally", "the", "rlog", "transformation", "accounts", "for", "variation", "in", "sequencing", "depth", "across", "samples", "as", "it", "represents", "the", "logarithm", "of", "qijafter", "accounting", "for", "the", "size", "factors", "sij", "this", "is", "in", "contrast", "to", "the", "variance", "stabilizing", "trans", "formation", "vst", "for", "overdispersed", "counts", "introduced", "indeseq", "while", "the", "vst", "is", "also", "effective", "at", "stabi", "lizing", "variance", "it", "does", "not", "directly", "take", "into", "account", "differences", "in", "size", "factors", "and", "in", "datasets", "with", "large", "variation", "in", "sequencing", "depth", "dynamic", "range", "of", "size", "factors", "greaterorsimilar4", "we", "observed", "undesirable", "artifacts", "in", "the", "eo", "ft", "ev", "ad", "eo", "ft", "er", "gtransformation", "with", "respect", "to", "the", "vst", "is", "however", "that", "the", "ordering", "of", "genes", "within", "sample", "will", "change", "if", "neigh", "boring", "genes", "undergo", "shrinkage", "of", "different", "strength", "as", "with", "the", "vst", "the", "value", "of", "rlog", "kij", "for", "large", "counts", "is", "approximately", "equal", "to", "log2", "kij", "sj", "both", "the", "rlog", "trans", "na", "dt", "ev", "ta", "ep", "di", "nt", "deseq2", "package", "we", "demonstrate", "the", "use", "of", "the", "rlog", "transformation", "on", "the", "rna", "seq", "dataset", "of", "hammer", "et", "al", "26", "wherein", "rna", "was", "sequenced", "from", "the", "dorsal", "root", "ganglion", "of", "rats", "that", "had", "undergone", "spinal", "nerve", "ligation", "and", "con", "trols", "at", "weeks", "and", "at", "months", "after", "the", "ligation", "the", "count", "matrix", "for", "this", "dataset", "was", "downloaded", "from", "the", "recount", "online", "resource", "27", "this", "dataset", "offers", "more", "subtle", "differences", "between", "conditions", "than", "the", "bottomly", "et", "al", "16", "dataset", "figure", "provides", "diagnostic", "plots", "of", "the", "normalized", "counts", "under", "the", "ordinary", "logarithm", "with", "pseudocount", "of", "and", "the", "rlog", "transformation", "show", "ing", "that", "the", "rlog", "both", "stabilizes", "the", "variance", "through", "the", "range", "of", "the", "mean", "of", "counts", "and", "helps", "to", "find", "meaningful", "patterns", "in", "the", "data", "figure", "variance", "stabilization", "and", "cluster", "ing", "after", "rlog", "transformation", "two", "transformations", "were", "applied", "to", "the", "counts", "of", "the", "hammer", "et", "al", "26", "dataset", "the", "logarithm", "of", "normalized", "counts", "plus", "pseudocount", "kij", "log2", "kij", "sj", "and", "the", "rlog", "the", "gene", "wise", "standard", "deviation", "of", "transformed", "values", "is", "variable", "across", "the", "range", "of", "the", "mean", "of", "counts", "using", "the", "logarithm", "while", "relatively", "stable", "using", "the", "rlog", "hierarchical", "clustering", "on", "euclidean", "distances", "and", "complete", "linkage", "using", "the", "rlog", "transformed", "data", "clusters", "the", "samples", "into", "the", "groups", "defined", "by", "treatment", "and", "time", "while", "using", "the", "logarithm", "transformed", "counts", "produces", "more", "ambiguous", "result", "sd", "standard", "deviation", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "of", "21", "gene", "level", "analysis", "we", "here", "present", "deseq2", "for", "the", "analysis", "of", "per", "gene", "counts", "the", "total", "number", "of", "reads", "that", "can", "be", "uniquely", "assigned", "to", "gene", "in", "contrast", "several", "algorithms", "28", "29", "work", "with", "probabilistic", "assignments", "of", "reads", "to", "tran", "scripts", "where", "multiple", "overlapping", "transcripts", "can", "origi", "nate", "from", "each", "gene", "it", "has", "been", "noted", "that", "the", "total", "read", "ta", "hc", "nr", "ti", "nf", "ed", "no", "fd", "expression", "when", "in", "fact", "only", "transcript", "isoform", "lengths", "change", "and", "even", "in", "wrong", "sign", "of", "lfcs", "in", "extreme", "cases", "28", "however", "in", "our", "benchmark", "discussed", "in", "the", "following", "section", "we", "found", "that", "lfc", "sign", "disagreements", "between", "total", "read", "count", "and", "probabilistic", "assignment", "based", "methods", "were", "rare", "for", "genes", "that", "were", "differentially", "expressed", "according", "to", "either", "method", "additional", "file", "figure", "s5", "furthermore", "if", "estimates", "for", "average", "tran", "script", "length", "are", "available", "for", "the", "conditions", "these", "can", "be", "incorporated", "into", "the", "deseq2", "framework", "as", "gene", "and", "sample", "specific", "normalization", "factors", "in", "addition", "the", "approach", "used", "in", "deseq2", "can", "be", "extended", "to", "isoform", "specific", "analysis", "either", "through", "generalized", "linear", "mod", "eling", "at", "the", "exon", "level", "with", "gene", "specific", "mean", "as", "in", "thedexseq", "package", "30", "or", "through", "counting", "evidence", "for", "alternative", "isoforms", "in", "splice", "graphs", "31", "32", "in", "fact", "the", "latest", "release", "version", "of", "dexseq", "now", "uses", "deseq2", "as", "its", "inferential", "engine", "and", "so", "offers", "shrinkage", "estimation", "of", "dispersion", "and", "effect", "sizes", "for", "an", "exon", "level", "analysis", "too", "comparative", "benchmarks", "to", "assess", "how", "well", "deseq2", "performs", "for", "standard", "analyses", "in", "comparison", "to", "other", "current", "methods", "we", "used", "combination", "of", "simulations", "and", "real", "data", "the", "negative", "binomial", "based", "approaches", "compared", "were", "deseq", "old", "edger", "33", "edger", "with", "the", "robust", "option", "34", "dss", "and", "ebseq", "35", "other", "methods", "com", "pared", "were", "the", "voom", "normalization", "method", "followed", "by", "linear", "modeling", "using", "the", "limma", "package", "36", "and", "the", "samseq", "permutation", "method", "of", "the", "samr", "package", "24", "for", "the", "benchmarks", "using", "real", "data", "the", "cuffdiff", "28", "method", "of", "the", "cufflinks", "suite", "was", "included", "for", "ver", "sion", "numbers", "of", "the", "software", "used", "see", "additional", "file", "table", "s3", "for", "all", "algorithms", "returning", "pvalues", "the", "pval", "ues", "from", "genes", "with", "non", "zero", "sum", "of", "read", "counts", "across", "samples", "were", "adjusted", "using", "the", "benjamini", "hochberg", "procedure", "21", "benchmarks", "through", "simulation", "sensitivity", "and", "precision", "we", "simulated", "datasets", "of", "10", "000", "genes", "with", "negative", "binomial", "distributed", "counts", "to", "simulate", "data", "with", "realistic", "moments", "the", "mean", "and", "dispersions", "were", "drawn", "from", "the", "joint", "distribu", "tion", "of", "means", "and", "gene", "wise", "dispersion", "estimates", "from", "the", "pickrell", "et", "al", "data", "fitting", "only", "an", "intercept", "term", "these", "datasets", "were", "of", "varying", "total", "sample", "size", "10", "20", "and", "the", "samples", "were", "split", "into", "two", "equal", "sized", "groups", "80", "of", "the", "simulated", "genes", "had", "no", "true", "differential", "expression", "while", "for", "20", "of", "the", "genes", "true", "fold", "changes", "of", "and", "were", "used", "to", "generate", "counts", "across", "the", "two", "groups", "with", "the", "direction", "of", "fold", "change", "chosen", "randomly", "the", "simulated", "differentially", "expressed", "genes", "were", "chosen", "uniformly", "at", "random", "among", "all", "the", "genes", "throughout", "the", "range", "of", "mean", "counts", "ma", "plots", "of", "the", "true", "fold", "changes", "used", "in", "the", "simulation", "and", "the", "observed", "fold", "changes", "induced", "by", "the", "simulation", "for", "one", "of", "the", "simulation", "settings", "are", "shown", "in", "additional", "file", "figure", "s6", "algorithms", "performance", "in", "the", "simulation", "benchmark", "was", "assessed", "by", "their", "sensitivity", "and", "precision", "the", "sen", "sitivity", "was", "calculated", "as", "the", "fraction", "of", "genes", "with", "adjusted", "pvalue", "among", "the", "genes", "with", "true", "differences", "between", "group", "means", "the", "precision", "was", "calculated", "as", "the", "fraction", "of", "genes", "with", "true", "differ", "ences", "between", "group", "means", "among", "those", "with", "adjusted", "pvalue", "the", "sensitivity", "is", "plotted", "over", "precision", "or", "the", "fdr", "in", "figure", "deseq2", "da", "edger", "often", "had", "the", "highest", "sensitivity", "of", "the", "algorithms", "that", "controlled", "type", "error", "in", "the", "sense", "that", "the", "actual", "fdr", "was", "at", "or", "below", "the", "threshold", "for", "adjusted", "pvalues", "used", "for", "calling", "differentially", "expressed", "genes", "deseq2", "had", "higher", "sensitivity", "compared", "to", "the", "other", "algorithms", "particularly", "for", "small", "fold", "change", "or", "as", "was", "also", "found", "in", "benchmarks", "performed", "by", "zhou", "et", "al", "34", "for", "larger", "sample", "sizes", "and", "larger", "fold", "changes", "the", "performance", "of", "the", "various", "algorithms", "was", "more", "consistent", "the", "overly", "conservative", "calling", "of", "the", "old", "deseq", "tool", "can", "be", "observed", "with", "reduced", "sensitivity", "compared", "to", "the", "other", "algorithms", "and", "an", "actual", "fdr", "less", "than", "the", "nominal", "eo", "f0", "en", "et", "ebseq", "version", "by", "default", "removes", "low", "count", "genes", "whose", "75", "quantile", "of", "nor", "malized", "counts", "is", "less", "than", "ten", "before", "calling", "differential", "expression", "the", "sensitivity", "of", "algorithms", "on", "the", "simulated", "data", "across", "range", "of", "the", "mean", "of", "counts", "are", "more", "closely", "compared", "in", "additional", "file", "figure", "s9", "outlier", "sensitivity", "we", "used", "simulations", "to", "compare", "the", "sensitivity", "and", "specificity", "of", "deseq2", "outlier", "handling", "approach", "to", "that", "of", "edger", "which", "was", "recently", "added", "to", "the", "software", "and", "published", "while", "this", "manuscript", "was", "under", "review", "edger", "now", "includes", "an", "optional", "method", "to", "handle", "outliers", "by", "iteratively", "refitting", "the", "glm", "after", "down", "weighting", "potential", "outlier", "counts", "34", "the", "sim", "ulations", "summarized", "in", "additional", "file", "figure", "s10", "indicated", "that", "both", "approaches", "to", "outliers", "nearly", "recover", "the", "performance", "on", "an", "outlier", "free", "dataset", "though", "edger", "robust", "had", "slightly", "higher", "actual", "than", "nominal", "fdr", "as", "seen", "in", "additional", "file", "figure", "s11", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "10", "of", "21", "figure", "sensitivity", "and", "precision", "of", "alg", "orithms", "across", "combinations", "of", "sample", "size", "and", "effect", "size", "deseq2", "and", "edger", "often", "had", "the", "highest", "sensitivity", "of", "those", "algorithms", "that", "controlled", "the", "fdr", "those", "algorithms", "which", "fall", "on", "or", "to", "the", "left", "of", "the", "vertical", "black", "line", "for", "plot", "of", "sensitivity", "against", "false", "positive", "rate", "rather", "than", "fdr", "see", "additional", "file", "figure", "s8", "and", "for", "the", "dependence", "of", "sensitivity", "on", "the", "mean", "of", "counts", "see", "additional", "file", "figure", "s9", "note", "that", "ebseq", "filters", "low", "count", "genes", "see", "main", "text", "for", "details", "precision", "of", "fold", "change", "estimates", "we", "benchmarked", "thedeseq2", "approach", "of", "using", "an", "empirical", "prior", "to", "achieve", "shrinkage", "of", "lfc", "estimates", "against", "two", "compet", "ing", "approaches", "the", "gfold", "method", "which", "can", "analyze", "experiments", "without", "replication", "20", "and", "can", "also", "han", "dle", "experiments", "with", "replicates", "and", "the", "edger", "package", "which", "provides", "pseudocount", "based", "shrinkage", "termed", "predictive", "lfcs", "results", "are", "summarized", "in", "additional", "file", "figures", "s12", "s16", "deseq2", "had", "consistently", "low", "root", "mean", "square", "error", "and", "mean", "absolute", "error", "across", "range", "of", "sample", "sizes", "and", "models", "for", "distribution", "of", "true", "lfcs", "gfold", "had", "similarly", "low", "error", "to", "deseq2", "over", "all", "genes", "however", "when", "focusing", "on", "differentially", "expressed", "genes", "it", "performed", "worse", "for", "larger", "sample", "sizes", "edger", "with", "default", "settings", "had", "similarly", "low", "error", "to", "deseq2", "when", "focusing", "only", "on", "the", "differentially", "expressed", "genes", "but", "had", "higher", "error", "over", "all", "genes", "clustering", "we", "compared", "the", "performance", "of", "the", "rlog", "transformation", "against", "other", "methods", "of", "transformation", "or", "distance", "calculation", "in", "the", "recovery", "of", "simulated", "clus", "ters", "the", "adjusted", "rand", "index", "37", "was", "used", "to", "compare", "hierarchical", "clustering", "based", "on", "various", "distances", "with", "the", "true", "cluster", "membership", "we", "tested", "the", "euclidean", "distance", "for", "normalized", "counts", "logarithm", "of", "normalized", "counts", "plus", "pseudocount", "of", "rlog", "transformed", "counts", "and", "vst", "counts", "in", "addition", "we", "compared", "these", "euclideandistances", "with", "the", "poisson", "distance", "implemented", "in", "the", "poiclaclu", "package", "38", "and", "distance", "implemented", "internally", "in", "the", "plotmds", "function", "of", "edger", "though", "not", "the", "default", "distance", "which", "is", "similar", "to", "the", "logarithm", "of", "normalized", "counts", "the", "results", "shown", "in", "additional", "file", "figure", "s17", "revealed", "that", "when", "the", "size", "factors", "were", "equal", "for", "all", "samples", "the", "poisson", "distance", "and", "the", "euclidean", "distance", "of", "rlog", "transformed", "or", "vst", "counts", "outperformed", "other", "methods", "however", "when", "the", "size", "fac", "tors", "were", "not", "equal", "across", "samples", "the", "rlog", "approach", "generally", "outperformed", "the", "other", "methods", "finally", "we", "note", "that", "the", "rlog", "transform", "ation", "provides", "normalized", "data", "which", "can", "be", "used", "for", "variety", "of", "applications", "of", "which", "distance", "calculation", "is", "one", "benchmark", "for", "rna", "sequencing", "data", "while", "simulation", "is", "useful", "to", "verify", "how", "well", "an", "algorithm", "behaves", "with", "idealized", "theoretical", "data", "and", "hence", "can", "ver", "yt", "tt", "ea", "mp", "sa", "se", "du", "ri", "so", "assumptions", "simulations", "cannot", "inform", "us", "how", "well", "the", "theory", "fits", "reality", "with", "rna", "seq", "data", "there", "is", "the", "com", "plication", "of", "not", "knowing", "fully", "or", "directly", "the", "underlying", "truth", "however", "we", "can", "work", "around", "this", "limitation", "by", "using", "more", "indirect", "inference", "explained", "below", "in", "the", "following", "benchmarks", "we", "considered", "three", "per", "formance", "metrics", "for", "differential", "expression", "calling", "the", "false", "positive", "rate", "or", "minus", "the", "specificity", "sensitivity", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "11", "of", "21", "and", "precision", "we", "can", "obtain", "meaningful", "estimates", "of", "specificity", "from", "looking", "at", "datasets", "where", "we", "believe", "all", "genes", "fall", "under", "the", "null", "hypothesis", "of", "no", "differential", "expression", "39", "sensitivity", "and", "precision", "are", "more", "diffi", "cult", "to", "estimate", "as", "they", "require", "independent", "knowledge", "of", "those", "genes", "that", "are", "differentially", "expressed", "to", "circum", "vent", "this", "problem", "we", "used", "experimental", "reproducibility", "on", "independent", "samples", "though", "from", "the", "same", "dataset", "as", "proxy", "we", "used", "dataset", "with", "large", "numbers", "of", "repli", "cates", "in", "both", "of", "two", "groups", "where", "we", "expect", "that", "truly", "differentially", "expressed", "genes", "exist", "we", "repeatedly", "split", "this", "dataset", "into", "an", "evaluation", "set", "and", "larger", "verifica", "tion", "set", "and", "compared", "the", "calls", "from", "the", "evaluation", "set", "with", "the", "calls", "from", "the", "verification", "set", "which", "were", "taken", "as", "truth", "it", "is", "important", "to", "keep", "in", "mind", "that", "the", "calls", "from", "the", "verification", "set", "are", "only", "an", "approximation", "of", "the", "true", "differential", "state", "and", "the", "approximation", "error", "has", "sys", "tematic", "and", "stochastic", "component", "the", "stochastic", "error", "ss", "lo", "et", "es", "es", "eo", "ft", "ev", "set", "is", "large", "enough", "for", "the", "systematic", "errors", "our", "bench", "mark", "assumes", "that", "these", "affect", "all", "algorithms", "more", "or", "less", "equally", "and", "do", "not", "markedly", "change", "the", "ranking", "of", "the", "algorithms", "false", "positive", "rate", "to", "evaluate", "the", "false", "positive", "rate", "of", "the", "algorithms", "we", "considered", "mock", "comparisons", "from", "dataset", "with", "many", "samples", "and", "no", "known", "condition", "dividing", "the", "samples", "into", "distinct", "groups", "we", "used", "the", "rna", "seq", "data", "of", "pickrell", "et", "al", "17", "for", "lymphoblastoid", "cell", "lines", "derived", "from", "unrelated", "nigerian", "individuals", "we", "chose", "set", "of", "26", "rna", "seq", "samples", "of", "the", "same", "read", "length", "46", "base", "pairs", "from", "male", "individuals", "we", "randomly", "drew", "without", "replacement", "ten", "samples", "from", "the", "set", "to", "compare", "five", "against", "five", "and", "this", "process", "was", "repeated", "30", "times", "we", "estimated", "the", "false", "positive", "rate", "associated", "with", "crit", "ical", "value", "of", "01", "by", "dividing", "the", "number", "of", "pvalues", "less", "than", "01", "by", "the", "total", "number", "of", "tests", "genes", "with", "zero", "sum", "of", "read", "counts", "across", "samples", "were", "excluded", "the", "results", "over", "the", "30", "replications", "summarized", "in", "figure", "indicated", "that", "all", "algorithms", "generally", "controlled", "the", "num", "ber", "of", "false", "positives", "deseq", "old", "andcuffdiff", "appeared", "overly", "conservative", "in", "this", "analysis", "not", "using", "up", "their", "type", "error", "budget", "sensitivity", "to", "obtain", "an", "impression", "of", "the", "sensitivity", "of", "the", "algorithms", "we", "considered", "the", "bottomly", "et", "al", "16", "dataset", "which", "contains", "ten", "and", "eleven", "replicates", "of", "two", "different", "genetically", "homogeneous", "mice", "strains", "this", "allowed", "for", "split", "of", "three", "vs", "three", "for", "the", "evaluation", "set", "and", "seven", "vs", "eight", "for", "the", "verification", "set", "which", "were", "balanced", "across", "the", "three", "experimental", "batches", "random", "splits", "were", "replicated", "30", "times", "batch", "information", "was", "not", "provided", "to", "the", "deseq", "old", "deseq2", "dss", "edger", "orvoom", "algorithms", "which", "can", "accommodate", "complexfigure", "benchmark", "of", "false", "positive", "calling", "shown", "are", "estimates", "ofp", "pvalue", "01", "under", "the", "null", "hypothesis", "the", "fpr", "is", "the", "number", "ofpvalues", "less", "than", "01", "divided", "by", "the", "total", "number", "of", "tests", "from", "randomly", "selected", "comparisons", "of", "five", "vs", "five", "samples", "from", "the", "pickrell", "et", "al", "17", "dataset", "with", "no", "known", "condition", "dividing", "the", "samples", "type", "error", "control", "requires", "that", "the", "tool", "does", "not", "substantially", "exceed", "the", "nominal", "value", "of", "01", "black", "line", "ebseq", "results", "were", "not", "included", "in", "this", "plot", "as", "it", "returns", "posterior", "probabilities", "which", "unlike", "pvalues", "are", "not", "expected", "to", "be", "uniformly", "distributed", "under", "the", "null", "hypothesis", "fpr", "false", "positive", "rate", "experimental", "designs", "to", "have", "comparable", "calls", "across", "all", "algorithms", "we", "rotated", "though", "each", "algorithm", "to", "determine", "the", "calls", "of", "the", "verification", "set", "for", "given", "algorithm", "ver", "ification", "set", "calls", "we", "tested", "the", "evaluation", "set", "calls", "of", "every", "algorithm", "we", "used", "this", "approach", "rather", "than", "consensus", "based", "method", "as", "we", "did", "not", "want", "to", "favor", "or", "disfavor", "any", "particular", "algorithm", "or", "group", "of", "algorithms", "sensitivity", "was", "calculated", "as", "in", "the", "simulation", "bench", "mark", "now", "with", "true", "differential", "expression", "defined", "by", "an", "adjusted", "pvalue", "in", "the", "larger", "verification", "set", "as", "dia", "grammed", "in", "additional", "file", "figure", "s18", "figure", "displays", "the", "estimates", "of", "sensitivity", "for", "each", "algorithm", "pair", "the", "ranking", "of", "algorithms", "was", "generally", "consistent", "regardless", "of", "which", "algorithm", "was", "chosen", "to", "determine", "calls", "in", "the", "verification", "set", "deseq2", "had", "comparable", "sen", "sitivity", "to", "edger", "and", "voom", "though", "less", "than", "dss", "median", "sensitivity", "estimates", "were", "typically", "between", "and", "for", "all", "algorithms", "that", "all", "algorithms", "had", "rel", "atively", "low", "median", "sensitivity", "can", "be", "explained", "by", "the", "small", "sample", "size", "of", "the", "evaluation", "set", "and", "the", "fact", "that", "increasing", "the", "sample", "size", "in", "the", "verification", "set", "increases", "power", "it", "was", "expected", "that", "the", "permutation", "based", "sam", "seqmethod", "would", "rarely", "produce", "adjusted", "pvalue", "in", "the", "evaluation", "set", "because", "the", "three", "vs", "three", "compari", "son", "does", "not", "enable", "enough", "permutations", "precision", "another", "important", "consideration", "from", "the", "perspective", "of", "an", "investigator", "is", "the", "precision", "or", "frac", "tion", "of", "true", "positives", "in", "the", "set", "of", "genes", "which", "pass", "the", "adjusted", "pvalue", "threshold", "this", "can", "also", "be", "reported", "as", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "12", "of", "21", "figure", "sensitivity", "estima", "ted", "from", "experimental", "reproducibility", "each", "algorithm", "sensitivity", "in", "the", "evaluation", "set", "box", "plots", "is", "evaluated", "using", "the", "calls", "of", "each", "other", "algorithm", "in", "the", "erification", "set", "panels", "with", "grey", "label", "fdr", "again", "true", "differential", "expression", "was", "defined", "by", "an", "adjusted", "pvalue", "in", "the", "larger", "verification", "set", "the", "estimates", "of", "precision", "are", "displayed", "in", "figure", "ew", "ec", "ns", "et", "deseq2", "often", "had", "the", "second", "high", "est", "median", "precision", "behind", "deseq", "old", "we", "can", "also", "see", "that", "algorithms", "with", "higher", "median", "sensitivity", "dss", "were", "generally", "associated", "here", "with", "lower", "median", "precision", "the", "rankings", "differed", "significantly", "when", "cuffd", "iff", "was", "used", "to", "determine", "the", "verification", "set", "calls", "this", "is", "likely", "due", "to", "the", "additional", "steps", "cuffdiff", "per", "formed", "to", "deconvolve", "changes", "in", "isoform", "level", "abundance", "from", "gene", "level", "abundance", "which", "apparently", "came", "at", "the", "cost", "of", "lower", "precision", "when", "compared", "against", "its", "own", "verification", "set", "calls", "to", "compare", "the", "sensitivity", "and", "precision", "results", "further", "we", "calculated", "the", "precision", "of", "algorithms", "along", "grid", "of", "nominal", "adjusted", "pvalues", "additional", "file", "figure", "s19", "we", "then", "found", "the", "nominal", "adjusted", "pvalue", "for", "each", "algo", "rithm", "which", "resulted", "in", "median", "actual", "precision", "of", "fdr", "having", "thus", "calibrated", "each", "algorithm", "toa", "target", "fdr", "we", "evaluated", "the", "sensitivity", "of", "calling", "as", "shown", "in", "additional", "file", "figure", "s20", "as", "expected", "here", "the", "algorithms", "performed", "more", "similarly", "to", "each", "other", "this", "analysis", "revealed", "that", "for", "given", "target", "precision", "deseq2", "often", "was", "among", "the", "top", "algorithms", "by", "median", "sensitivity", "though", "the", "variability", "across", "random", "replicates", "was", "larger", "than", "the", "differences", "between", "algorithms", "the", "absolute", "number", "of", "calls", "for", "the", "evaluation", "and", "ver", "ification", "sets", "can", "be", "seen", "in", "additional", "file", "figures", "s21", "and", "s22", "which", "mostly", "matched", "the", "order", "seen", "in", "the", "sen", "sitivity", "plot", "of", "figure", "additional", "file", "figures", "s23", "and", "s24", "provide", "heat", "maps", "and", "clustering", "based", "on", "the", "jaccard", "index", "of", "calls", "for", "one", "replicate", "of", "the", "evaluation", "and", "veri", "fication", "sets", "indicating", "large", "overlap", "of", "calls", "across", "the", "different", "algorithms", "in", "summary", "the", "benchmarking", "tests", "showed", "that", "deseq2", "effectively", "controlled", "type", "errors", "maintaining", "median", "false", "positive", "rate", "just", "below", "the", "chosen", "critical", "value", "in", "mock", "comparison", "of", "groups", "of", "samples", "ran", "domly", "chosen", "from", "larger", "pool", "for", "both", "simulation", "and", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "13", "of", "21", "figure", "precision", "estimated", "from", "experimental", "reproducibility", "each", "algorithm", "precision", "in", "the", "evaluation", "set", "box", "plots", "is", "evaluated", "using", "the", "calls", "of", "each", "other", "algorithm", "in", "the", "ver", "ification", "set", "panels", "with", "grey", "label", "analysis", "of", "real", "data", "deseq2", "often", "achieved", "the", "highest", "sensitivity", "of", "those", "algorithms", "that", "controlled", "the", "fdr", "conclusions", "deseq2", "offers", "comprehensive", "and", "general", "solution", "for", "gene", "level", "analysis", "of", "rna", "seq", "data", "shrinkage", "estimators", "substantially", "improve", "the", "stability", "and", "reproducibility", "of", "analysis", "results", "compared", "to", "maximum", "likelihood", "based", "solutions", "empirical", "bayes", "priors", "provide", "automatic", "con", "trol", "of", "the", "amount", "of", "shrinkage", "based", "on", "the", "amount", "of", "information", "for", "the", "estimated", "quantity", "available", "in", "the", "data", "this", "allows", "deseq2", "to", "offer", "consistent", "performance", "over", "large", "range", "of", "data", "types", "and", "makes", "it", "applicable", "for", "small", "studies", "with", "few", "replicates", "as", "well", "as", "for", "large", "obser", "vational", "studies", "deseq2", "heuristics", "for", "outlier", "detection", "help", "to", "recognize", "genes", "for", "which", "the", "modeling", "assump", "sa", "eu", "ea", "ds", "oa", "st", "ie", "sc", "db", "these", "the", "embedding", "of", "these", "strategies", "in", "the", "frame", "work", "of", "glms", "enables", "the", "treatment", "of", "both", "simple", "and", "complex", "designs", "critical", "advance", "is", "the", "shrinkage", "estimator", "for", "fold", "changes", "for", "differential", "expression", "analysis", "which", "offers", "sound", "and", "statistically", "well", "founded", "solution", "to", "the", "prac", "tically", "relevant", "problem", "of", "comparing", "fold", "change", "across", "the", "wide", "dynamic", "range", "of", "rna", "seq", "experiments", "this", "is", "of", "value", "for", "many", "downstream", "analysis", "tasks", "including", "the", "ranking", "of", "genes", "for", "follow", "up", "studies", "and", "associ", "ation", "of", "fold", "changes", "with", "other", "variables", "of", "interest", "in", "addition", "the", "rlog", "transformation", "which", "implements", "shrinkage", "of", "fold", "changes", "on", "per", "sample", "basis", "facil", "itates", "visualization", "of", "differences", "for", "example", "in", "heat", "maps", "and", "enables", "the", "application", "of", "wide", "range", "of", "techniques", "that", "require", "homoskedastic", "input", "data", "includ", "ing", "machine", "learning", "or", "ordination", "techniques", "such", "as", "principal", "component", "analysis", "and", "clustering", "deseq2", "hence", "offers", "to", "practitioners", "wide", "set", "of", "fea", "tures", "with", "state", "of", "the", "art", "inferential", "power", "its", "use", "cases", "are", "not", "limited", "to", "rna", "seq", "data", "or", "other", "transcriptomics", "assays", "rather", "many", "kinds", "of", "high", "throughput", "count", "data", "nb", "eu", "ra", "sf", "rw", "deseq", "ordeseq2", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "14", "of", "21", "have", "been", "used", "include", "chromatin", "immunoprecipitation", "sequencing", "assays", "40", "see", "also", "the", "diffbind", "package", "41", "42", "barcode", "based", "assays", "43", "metagenomics", "data", "44", "ribosome", "profiling", "45", "and", "crispr", "cas", "library", "assays", "46", "finally", "the", "deseq2", "package", "is", "inte", "grated", "well", "in", "the", "bioconductor", "infrastructure", "11", "and", "comes", "with", "extensive", "documentation", "including", "vignette", "that", "demonstrates", "complete", "analysis", "step", "by", "step", "and", "discusses", "advanced", "use", "cases", "materials", "and", "methods", "summary", "of", "the", "notation", "used", "in", "the", "following", "section", "is", "provided", "in", "additional", "file", "table", "s1", "model", "and", "normalization", "the", "read", "count", "kijfor", "gene", "iin", "sample", "jis", "described", "with", "glm", "of", "the", "negative", "binomial", "family", "with", "logarithmic", "link", "kij", "nb", "mean", "ij", "dispersion", "ij", "sijqij", "logqij", "summationdisplay", "rxjr", "ir", "for", "notational", "simplicity", "the", "equations", "here", "use", "the", "nat", "ural", "logarithm", "as", "the", "link", "function", "though", "the", "deseq2", "software", "reports", "estimated", "model", "coefficients", "and", "their", "estimated", "standard", "errors", "on", "the", "log2scale", "by", "default", "the", "normalization", "constants", "sijare", "consid", "ered", "constant", "within", "sample", "sij", "sj", "da", "ee", "with", "the", "median", "of", "ratios", "method", "previously", "described", "and", "used", "in", "deseq", "and", "dexseq", "30", "sj", "median", "kr", "negationslash", "0kij", "kr", "iwith", "kr", "productdisplay", "1kij", "alternatively", "the", "user", "can", "supply", "normalization", "con", "stants", "sijcalculated", "using", "other", "methods", "using", "cqn", "13", "or", "edaseq", "14", "which", "may", "differ", "from", "gene", "to", "gene", "expanded", "design", "matrices", "for", "consistency", "with", "our", "softw", "are", "documentation", "in", "the", "following", "text", "we", "will", "use", "the", "terminology", "of", "the", "rstatisti", "cal", "language", "in", "linear", "modeling", "categorical", "variable", "or", "factor", "can", "take", "on", "two", "or", "more", "values", "or", "levels", "in", "standard", "design", "matrices", "one", "of", "the", "values", "is", "chosen", "as", "refer", "ence", "value", "or", "base", "level", "and", "absorbed", "into", "the", "intercept", "in", "standard", "glms", "the", "choice", "of", "base", "level", "does", "not", "influ", "ence", "the", "values", "of", "contrasts", "lfcs", "this", "however", "is", "no", "longer", "the", "case", "in", "our", "approach", "using", "ridge", "regression", "like", "shrinkage", "on", "the", "coefficients", "described", "below", "when", "factors", "with", "more", "than", "two", "levels", "are", "present", "in", "the", "designmatrix", "because", "the", "base", "level", "will", "not", "undergo", "shrinkage", "while", "the", "other", "levels", "do", "to", "recover", "the", "desirable", "symmetry", "between", "all", "levels", "deseq2", "uses", "expanded", "design", "matrices", "which", "include", "an", "indicator", "variable", "for", "each", "level", "of", "each", "factor", "in", "addi", "tion", "to", "an", "intercept", "column", "none", "of", "the", "levels", "is", "absorbed", "into", "the", "intercept", "while", "such", "design", "matrix", "no", "longer", "has", "full", "rank", "unique", "solution", "exists", "because", "the", "zero", "centered", "prior", "distribution", "see", "below", "provides", "regularization", "for", "dispersion", "estimation", "and", "for", "estimat", "ing", "the", "width", "of", "the", "lfc", "prior", "standard", "design", "matrices", "are", "used", "contrasts", "contrasts", "between", "levels", "and", "standard", "errors", "of", "such", "con", "trasts", "can", "be", "calculated", "as", "they", "would", "in", "the", "standard", "design", "matrix", "case", "using", "vectorct", "vector", "se", "parenleftbig", "parenrightbig", "radicalbig", "vectorct", "sigma1i", "vectorc", "where", "vectorcrepresents", "numeric", "contrast", "and", "specifying", "the", "numerator", "and", "denominator", "of", "simple", "two", "level", "contrast", "and", "sigma1i", "cov", "vector", "db", "estimation", "of", "dispersions", "we", "assume", "the", "dispersion", "parameter", "ifollows", "log", "normal", "prior", "distribution", "that", "is", "centered", "around", "trend", "that", "depends", "on", "the", "gene", "mean", "normalized", "read", "count", "log", "parenleftbig", "log", "tr", "parenrightbig", "here", "tris", "function", "of", "the", "gene", "mean", "normalized", "count", "summationdisplay", "jkij", "sij", "it", "describes", "the", "mean", "dependent", "expectation", "of", "the", "prior", "dis", "the", "width", "of", "the", "prior", "hyperparameter", "describing", "how", "much", "the", "individual", "genes", "true", "dispersions", "scatter", "around", "the", "trend", "for", "the", "trend", "function", "we", "use", "the", "same", "parametrization", "as", "we", "used", "for", "dexseq", "30", "namely", "tr", "a1", "we", "get", "final", "dispersion", "estimates", "from", "this", "model", "in", "three", "steps", "which", "implement", "computationally", "fast", "approximation", "to", "full", "empirical", "bayes", "treatment", "we", "first", "use", "the", "count", "data", "for", "each", "gene", "separately", "to", "get", "preliminary", "gene", "wise", "dispersion", "estimates", "gw", "iby", "maximum", "likelihood", "estimation", "then", "we", "fit", "the", "disper", "sion", "trend", "tr", "finally", "we", "combine", "the", "likelihood", "with", "the", "trended", "prior", "to", "get", "maximum", "posteriori", "map", "values", "as", "final", "dispersion", "estimates", "details", "for", "the", "three", "steps", "follow", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "15", "of", "21", "gene", "wise", "dispersion", "estimates", "to", "get", "gene", "wise", "dis", "persion", "estimate", "for", "gene", "we", "start", "by", "fitting", "nega", "tive", "binomial", "glm", "without", "an", "lfc", "prior", "for", "the", "design", "matrix", "xto", "the", "gene", "count", "data", "this", "glm", "uses", "rough", "method", "of", "moments", "estimate", "of", "dispersion", "based", "on", "the", "within", "group", "variances", "and", "means", "the", "initial", "glm", "is", "necessary", "to", "obtain", "an", "initial", "set", "of", "fitted", "values", "ij", "then", "maximize", "the", "cox", "reid", "adjusted", "likelihood", "of", "the", "dispersion", "conditioned", "on", "the", "fitted", "values", "ijfrom", "the", "initial", "fit", "to", "obtain", "the", "gene", "wise", "estimate", "gw", "gw", "arg", "max", "lscriptcr", "parenleftbig", "vector", "vectorki", "parenrightbig", "with", "lscriptcr", "vector", "vectork", "lscript", "2log", "parenleftbigdet", "parenleftbigxtwx", "parenrightbig", "parenrightbig", "lscript", "summationdisplay", "jlogfnb", "kj", "where", "fnb", "is", "the", "probability", "mass", "function", "of", "the", "negative", "binomial", "distribution", "with", "mean", "and", "disper", "sion", "dt", "es", "dt", "mp", "st", "ec", "db", "adjustment", "47", "this", "adjustment", "first", "used", "in", "the", "con", "text", "of", "dispersion", "estimation", "for", "sage", "data", "48", "and", "then", "for", "hts", "data", "in", "edger", "corrects", "for", "the", "negative", "bias", "of", "dispersion", "estimates", "from", "using", "the", "mles", "for", "the", "fit", "ted", "values", "ij", "analogous", "to", "bessel", "correction", "in", "the", "usual", "sample", "variance", "formula", "for", "details", "see", "49", "section", "10", "it", "is", "formed", "from", "the", "fisher", "information", "for", "the", "fit", "ted", "values", "which", "is", "here", "calculated", "as", "det", "xtwx", "wis", "the", "diagonal", "weight", "matrix", "from", "the", "standard", "iter", "atively", "reweighted", "least", "squares", "algorithm", "as", "the", "glm", "link", "function", "is", "log", "and", "its", "variance", "function", "is", "ee", "so", "ft", "ed", "lm", "wiare", "given", "by", "wjj", "prime", "2v", "the", "optimization", "in", "equation", "is", "performed", "on", "the", "scale", "of", "log", "using", "backtracking", "line", "search", "with", "accepted", "proposals", "that", "satisfy", "armijo", "conditions", "50", "dispersion", "trend", "parametric", "curve", "of", "the", "form", "is", "fit", "by", "regressing", "the", "gene", "wise", "dispersion", "estimates", "gw", "onto", "the", "means", "of", "the", "normalized", "counts", "es", "pling", "distribution", "of", "the", "gene", "wise", "dispersion", "estimate", "around", "the", "true", "value", "ican", "be", "highly", "skewed", "and", "there", "fore", "we", "do", "not", "use", "ordinary", "least", "squares", "regression", "but", "rather", "gamma", "family", "glm", "regression", "furthermore", "dis", "persion", "outliers", "could", "skew", "the", "fit", "and", "hence", "scheme", "to", "exclude", "such", "outliers", "is", "used", "the", "hyperparameters", "a1and", "0of", "are", "obtained", "by", "iteratively", "fitting", "gamma", "family", "glm", "at", "each", "iteration", "genes", "with", "ratio", "of", "dispersion", "to", "fitted", "value", "outside", "the", "range", "10", "15", "are", "left", "out", "until", "the", "sum", "of", "squared", "lfcs", "of", "the", "new", "coefficients", "over", "the", "old", "coefficients", "is", "less", "than", "10", "same", "approach", "as", "in", "dexseq", "30", "the", "parametrization", "is", "based", "on", "reports", "by", "us", "and", "others", "of", "decreasing", "dependence", "of", "dispersion", "on", "the", "mean", "in", "many", "datasets", "51", "some", "caution", "is", "war", "ranted", "to", "disentangle", "true", "underlying", "dependence", "from", "effects", "of", "estimation", "bias", "that", "can", "create", "perceived", "dependence", "of", "the", "dispersion", "on", "the", "mean", "consider", "negative", "binomial", "distributed", "random", "variable", "with", "expectation", "and", "dispersion", "sv", "has", "two", "components", "vp", "vd", "the", "poisson", "component", "vp", "independent", "of", "and", "the", "overdispersion", "compo", "nent", "vd", "is", "small", "lessorsimilar1", "vertical", "lines", "in", "additional", "file", "figure", "s1", "the", "poisson", "component", "dominates", "in", "the", "sense", "that", "vp", "vd", "greaterorsimilar1", "and", "the", "observed", "data", "provide", "little", "information", "on", "the", "value", "of", "therefore", "the", "sampling", "variance", "of", "an", "estimator", "for", "will", "be", "large", "when", "lessorsimilar1", "which", "leads", "to", "the", "appearance", "of", "bias", "for", "simplicity", "we", "have", "stated", "the", "above", "argument", "without", "regard", "to", "the", "influence", "of", "the", "size", "factors", "sj", "the", "value", "of", "this", "is", "permissible", "because", "by", "construc", "tion", "the", "geometric", "mean", "of", "our", "size", "factors", "is", "close", "to", "and", "hence", "the", "mean", "across", "samples", "of", "the", "unnormalized", "read", "counts", "summationtext", "jkij", "and", "the", "mean", "of", "the", "normalized", "read", "counts", "summationtext", "jkij", "sj", "will", "be", "roughly", "the", "same", "this", "phenomenon", "may", "give", "rise", "to", "an", "apparent", "depen", "dence", "of", "on", "it", "is", "possible", "that", "the", "shape", "of", "the", "dispersion", "mean", "fit", "for", "the", "bottomly", "data", "figure", "1a", "can", "be", "explained", "in", "that", "manner", "the", "asymptotic", "dispersion", "is", "01", "and", "the", "non", "zero", "slope", "of", "the", "mean", "dispersion", "plot", "is", "limited", "to", "the", "range", "of", "mean", "counts", "up", "to", "around", "100", "the", "reciprocal", "of", "however", "overestimation", "of", "in", "that", "low", "count", "range", "has", "little", "effect", "on", "inference", "as", "in", "that", "range", "the", "variance", "vis", "anyway", "dominated", "by", "the", "independent", "poisson", "component", "vp", "es", "ni", "different", "for", "the", "pickrell", "data", "here", "dependence", "of", "dis", "persion", "on", "mean", "was", "observed", "for", "counts", "clearly", "above", "the", "reciprocal", "of", "the", "asymptotic", "dispersion", "figure", "1b", "and", "hence", "is", "not", "due", "merely", "to", "estimation", "bias", "simula", "tions", "shown", "in", "additional", "file", "figure", "s25", "confirmed", "that", "the", "observed", "joint", "distribution", "of", "estimated", "disper", "sions", "and", "means", "is", "not", "compatible", "with", "single", "constant", "dispersion", "therefore", "the", "parametrization", "is", "flexible", "and", "mildly", "conservative", "modeling", "choice", "it", "is", "able", "to", "pick", "up", "dispersion", "mean", "dependence", "if", "it", "is", "present", "while", "it", "can", "lead", "to", "minor", "loss", "of", "power", "in", "the", "low", "count", "range", "due", "to", "tendency", "to", "overestimate", "dispersion", "there", "dispersion", "prior", "as", "also", "observed", "by", "wu", "et", "al", "log", "normal", "prior", "fits", "the", "observed", "dispersion", "distribution", "for", "typical", "rna", "seq", "datasets", "we", "solve", "the", "computational", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "16", "of", "21", "difficulty", "of", "working", "with", "non", "conjugate", "prior", "using", "the", "following", "argument", "the", "logarithmic", "residuals", "from", "the", "trend", "fit", "log", "gw", "log", "tr", "arise", "from", "two", "con", "tributions", "namely", "the", "scatter", "of", "the", "true", "logarithmic", "dispersions", "around", "the", "trend", "given", "by", "the", "prior", "with", "variance", "and", "the", "sampling", "distribution", "of", "the", "loga", "rithm", "of", "the", "dispersion", "estimator", "with", "variance", "lde", "sampling", "distribution", "of", "dispersion", "estimator", "is", "approx", "imately", "scaled", "2distribution", "with", "pdegrees", "of", "freedom", "with", "mthe", "number", "of", "samples", "and", "pthe", "number", "of", "coefficients", "the", "variance", "of", "the", "logarithm", "of", "distributed", "random", "variable", "is", "given", "52", "by", "the", "trigamma", "function", "var", "log", "x2", "for", "x2", "therefore", "lde", "the", "sampling", "vari", "ance", "of", "the", "logarithm", "of", "variance", "or", "dispersion", "estimator", "is", "approximately", "constant", "cross", "genes", "and", "depends", "only", "on", "the", "degrees", "of", "freedom", "of", "the", "model", "additional", "file", "table", "s2", "compares", "this", "approximation", "for", "the", "variance", "of", "logarithmic", "dispersion", "estimates", "with", "the", "variance", "of", "logarithmic", "cox", "reid", "adjusted", "dispersion", "estimates", "for", "simulated", "negative", "binomial", "data", "over", "combination", "of", "different", "sample", "sizes", "number", "of", "param", "eters", "and", "dispersion", "values", "used", "to", "create", "the", "simulated", "data", "the", "approximation", "is", "close", "to", "the", "sample", "variance", "for", "various", "typical", "values", "of", "pand", "therefore", "the", "prior", "variance", "dis", "obtained", "by", "subtract", "ing", "the", "expected", "sampling", "variance", "from", "an", "estimate", "of", "the", "variance", "of", "the", "logarithmic", "residuals", "s2", "lr", "max", "braceleftbigs2", "lr", "bracerightbig", "the", "prior", "variance", "dis", "thresholded", "at", "minimal", "value", "of", "25", "so", "that", "the", "dispersion", "estimates", "are", "not", "shrunk", "entirely", "to", "tr", "if", "the", "variance", "of", "the", "logarithmic", "resid", "uals", "is", "less", "than", "the", "expected", "sampling", "variance", "to", "avoid", "inflation", "of", "ddue", "to", "dispersion", "outliers", "genes", "not", "well", "captured", "by", "this", "prior", "see", "below", "we", "use", "robust", "estimator", "for", "the", "standard", "deviation", "slrof", "the", "logarithmic", "residuals", "slr", "mad", "parenleftbig", "log", "gw", "log", "tr", "parenrightbig", "where", "mad", "stands", "for", "the", "median", "absolute", "deviation", "divided", "as", "usual", "by", "the", "scaling", "factor", "phi1", "three", "or", "less", "residuals", "degrees", "of", "freedom", "when", "there", "are", "three", "or", "less", "residual", "degrees", "of", "freedom", "number", "of", "samples", "minus", "number", "of", "parameters", "to", "estimate", "the", "estimation", "of", "the", "prior", "variance", "dusing", "the", "observed", "variance", "of", "logarithmic", "residuals", "s2", "lrtends", "to", "underes", "timate", "in", "this", "case", "we", "instead", "estimate", "the", "prior", "variance", "through", "simulation", "we", "match", "the", "distribution", "oflogarithmic", "residuals", "to", "density", "of", "simulated", "logarithmic", "residuals", "these", "are", "the", "logarithm", "of", "distributed", "random", "variables", "added", "to", "random", "variables", "to", "account", "for", "the", "spread", "due", "to", "the", "prior", "the", "simulated", "distribution", "is", "shifted", "by", "log", "to", "account", "for", "the", "scaling", "of", "the", "2distribution", "we", "repeat", "the", "simulation", "over", "grid", "of", "values", "for", "and", "select", "the", "value", "that", "mini", "mizes", "the", "kullback", "leibler", "divergence", "from", "the", "observed", "density", "of", "logarithmic", "residuals", "to", "the", "simulated", "density", "final", "dispersion", "estimate", "we", "form", "logarithmic", "poste", "rior", "for", "the", "dispersion", "from", "the", "cox", "reid", "adjusted", "loga", "rithmic", "likelihood", "and", "the", "logarithmic", "prior", "and", "use", "its", "maximum", "the", "map", "value", "as", "the", "final", "estimate", "of", "the", "dispersion", "map", "arg", "max", "parenleftbig", "lscriptcr", "parenleftbig", "vector", "vectorki", "parenrightbig", "lambda1i", "parenrightbig", "where", "lambda1i", "parenleftbig", "log", "log", "tr", "parenrightbig2", "is", "up", "to", "an", "additive", "constant", "the", "logarithm", "of", "the", "density", "of", "prior", "again", "backtracking", "line", "search", "is", "used", "to", "perform", "the", "optimization", "dispersion", "outliers", "for", "some", "genes", "the", "gene", "wise", "esti", "mate", "gw", "ic", "nb", "es", "of", "ra", "et", "ep", "re", "tr", "that", "it", "would", "be", "unreasonable", "to", "assume", "that", "the", "prior", "is", "suitable", "for", "the", "gene", "if", "the", "dispersion", "estimate", "for", "such", "genes", "were", "down", "moderated", "toward", "the", "fitted", "trend", "this", "might", "lead", "to", "false", "positives", "therefore", "we", "use", "the", "heuris", "tic", "of", "considering", "gene", "as", "dispersion", "outlier", "if", "the", "residual", "from", "the", "trend", "fit", "is", "more", "than", "two", "standard", "deviations", "of", "logarithmic", "residuals", "slr", "see", "equation", "above", "the", "fit", "if", "log", "gw", "log", "tr", "2slr", "for", "such", "genes", "the", "gene", "wise", "estimate", "gw", "iis", "not", "shrunk", "toward", "the", "trended", "prior", "mean", "instead", "of", "the", "map", "value", "map", "we", "use", "the", "gene", "wise", "estimate", "gw", "ias", "final", "dis", "persion", "value", "in", "the", "subsequent", "steps", "in", "addition", "the", "iterative", "fitting", "procedure", "for", "the", "parametric", "dispersion", "trend", "described", "above", "avoids", "that", "such", "dispersion", "outliers", "influence", "the", "prior", "mean", "shrinkage", "estimation", "of", "logarithmic", "fold", "changes", "to", "incorporate", "empirical", "bayes", "shrinkage", "of", "lfcs", "we", "postulate", "zero", "centered", "normal", "prior", "for", "the", "coefficients", "irof", "model", "that", "represent", "lfcs", "typically", "all", "coefficients", "except", "for", "the", "intercept", "i0", "ir", "parenleftbig", "parenrightbig", "10", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "17", "of", "21", "as", "was", "observed", "with", "differential", "expression", "analysis", "using", "microarrays", "genes", "with", "low", "intensity", "values", "tend", "to", "suffer", "from", "small", "signal", "to", "noise", "ratio", "alternative", "estimators", "can", "be", "found", "that", "are", "more", "stable", "than", "the", "standard", "calculation", "of", "fold", "change", "as", "the", "ratio", "of", "aver", "age", "observed", "values", "for", "each", "condition", "53", "55", "deseq2", "approach", "can", "be", "seen", "as", "an", "extension", "of", "these", "approaches", "for", "stable", "estimation", "of", "gene", "expression", "fold", "changes", "to", "count", "data", "empirical", "prior", "estimate", "to", "obtain", "values", "for", "the", "empir", "ical", "prior", "widths", "rfor", "the", "model", "coefficients", "we", "again", "approximate", "full", "empirical", "bayes", "approach", "as", "with", "the", "estimation", "of", "dispersion", "prior", "though", "here", "we", "do", "not", "sub", "tract", "the", "expected", "sampling", "variance", "from", "the", "observed", "variance", "of", "maximum", "likelihood", "estimates", "the", "estimate", "of", "the", "lfc", "prior", "width", "is", "calculated", "as", "follows", "we", "use", "the", "standard", "iteratively", "reweighted", "least", "squares", "algo", "rithm", "12", "for", "each", "gene", "model", "equations", "and", "to", "get", "mles", "for", "the", "coefficients", "mle", "ir", "et", "nf", "each", "column", "rof", "the", "design", "matrix", "except", "for", "the", "inter", "cept", "zero", "centered", "normal", "distribution", "to", "the", "empirical", "distribution", "of", "mle", "fold", "change", "estimates", "vector", "mle", "to", "make", "the", "fit", "robust", "against", "outliers", "with", "very", "high", "absolute", "lfc", "values", "we", "use", "quantile", "matching", "the", "width", "ris", "chosen", "such", "that", "the", "empirical", "quantile", "of", "the", "absolute", "value", "of", "the", "observed", "lfcs", "vector", "mle", "st", "theoretical", "quantile", "of", "the", "prior", "pis", "set", "by", "default", "to", "05", "if", "we", "write", "the", "theoretical", "upper", "quantile", "of", "normal", "distribution", "as", "qn", "and", "the", "empirical", "upper", "quantile", "of", "the", "mle", "lfcs", "as", "then", "the", "prior", "width", "is", "calculated", "as", "qn", "to", "ensure", "that", "the", "prior", "width", "rwill", "be", "independent", "of", "the", "choice", "of", "base", "level", "the", "estimates", "from", "the", "quantile", "matching", "procedure", "are", "averaged", "for", "each", "factor", "over", "all", "possible", "contrasts", "of", "factor", "levels", "when", "determining", "the", "empirical", "upper", "quantile", "extreme", "lfc", "values", "vextendsingle", "vextendsingle", "mle", "ir", "vextendsingle", "vextendsingle", "log", "10", "or", "10", "on", "the", "base", "scale", "are", "excluded", "final", "estimate", "of", "logarithmic", "fold", "changes", "the", "loga", "rithmic", "posterior", "for", "the", "vector", "vector", "of", "model", "coefficients", "irfor", "gene", "iis", "the", "sum", "of", "the", "logarithmic", "likelihood", "of", "the", "glm", "and", "the", "logarithm", "of", "the", "prior", "density", "10", "and", "its", "maximum", "yields", "the", "final", "map", "coefficient", "estimates", "vector", "arg", "max", "vector", "summationdisplay", "jlogfnb", "parenleftbig", "kij", "vector", "parenrightbig", "lambda1", "vector", "where", "vector", "sije", "summationtext", "rxjr", "lambda1", "vector", "summationdisplay", "2r", "and", "iis", "the", "final", "dispersion", "estimate", "for", "gene", "map", "except", "for", "dispersion", "outliers", "where", "gw", "the", "term", "lambda1", "the", "logarithm", "of", "the", "density", "of", "the", "normal", "prior", "up", "to", "an", "additive", "constant", "can", "be", "read", "as", "ridge", "penalty", "term", "and", "therefore", "we", "perform", "the", "optimization", "using", "the", "iteratively", "reweighted", "ridge", "regres", "sion", "algorithm", "56", "also", "known", "as", "weighted", "updates", "57", "specifically", "the", "updates", "for", "given", "gene", "are", "of", "the", "form", "vector", "parenleftbig", "xtwx", "vector", "parenrightbig", "xtw", "vectorz", "with", "rand", "zj", "log", "sj", "kj", "where", "the", "current", "fitted", "values", "sje", "summationtext", "rxjr", "rare", "com", "puted", "from", "the", "current", "estimates", "vector", "in", "each", "iteration", "fisher", "information", "the", "effect", "of", "the", "zero", "centered", "nor", "mal", "prior", "can", "be", "understood", "as", "shrinking", "the", "map", "lfc", "estimates", "based", "on", "the", "amount", "of", "information", "the", "experi", "ment", "provides", "for", "this", "coefficient", "and", "we", "briefly", "elaborate", "on", "this", "here", "specifically", "for", "given", "gene", "es", "for", "an", "lfc", "irdepends", "on", "the", "observed", "fisher", "information", "given", "by", "jm", "ir", "bracketleftbigg", "ir", "lscript", "parenleftbig", "vector", "vectorki", "parenrightbig", "bracketrightbigg", "ir", "ir", "where", "lscript", "parenleftbig", "vector", "vectorki", "parenrightbig", "is", "the", "logarithm", "of", "the", "likelihood", "and", "partial", "derivatives", "are", "taken", "with", "respect", "to", "lfc", "ir", "ra", "negative", "binomial", "glm", "the", "observed", "fisher", "information", "or", "peakedness", "of", "the", "logarithm", "of", "the", "profile", "likelihood", "is", "influenced", "by", "number", "of", "factors", "including", "the", "degrees", "of", "freedom", "the", "estimated", "mean", "counts", "ij", "dt", "eg", "dispersion", "estimate", "the", "prior", "influences", "the", "map", "esti", "mate", "when", "the", "density", "of", "the", "likelihood", "and", "the", "prior", "are", "multiplied", "to", "calculate", "the", "posterior", "genes", "with", "low", "esti", "mated", "mean", "values", "ijor", "high", "dispersion", "estimates", "have", "flatter", "profile", "likelihoods", "as", "do", "datasets", "with", "few", "residual", "degrees", "of", "freedom", "and", "therefore", "in", "these", "cases", "the", "zero", "centered", "prior", "pulls", "the", "map", "estimate", "from", "high", "uncertainty", "mle", "closer", "toward", "zero", "wald", "test", "the", "wald", "test", "compares", "the", "beta", "estimate", "irdivided", "by", "its", "estimated", "standard", "error", "se", "ir", "to", "standard", "normal", "distribution", "the", "estimated", "standard", "errors", "are", "the", "square", "root", "of", "the", "diagonal", "elements", "of", "the", "estimated", "covariance", "matrix", "sigma1i", "rt", "ec", "ir", "radicalbig", "sigma1i", "rr", "contrasts", "of", "coefficients", "are", "tested", "similarly", "by", "forming", "wald", "statistics", "using", "and", "we", "use", "the", "following", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "18", "of", "21", "formula", "for", "the", "coefficient", "covariance", "matrix", "for", "glm", "with", "normal", "prior", "on", "coefficients", "56", "58", "sigma1i", "cov", "vector", "xtwx", "vector", "xtwx", "xtwx", "vector", "the", "tail", "integrals", "of", "the", "standard", "normal", "distribution", "are", "multiplied", "by", "to", "achieve", "two", "tailed", "test", "the", "wald", "test", "pvalues", "from", "the", "subset", "of", "genes", "that", "pass", "the", "indepen", "dent", "filtering", "step", "are", "adjusted", "for", "multiple", "testing", "using", "the", "procedure", "of", "benjamini", "and", "hochberg", "21", "independent", "filtering", "independent", "filtering", "does", "not", "compromise", "type", "error", "control", "as", "long", "as", "the", "distribution", "of", "the", "test", "statistic", "is", "marginally", "independent", "of", "the", "filter", "statistic", "under", "the", "null", "hypothesis", "22", "and", "we", "argue", "in", "the", "following", "that", "this", "is", "the", "case", "in", "our", "application", "the", "filter", "statistic", "in", "deseq2", "is", "the", "mean", "of", "normalized", "counts", "for", "gene", "while", "the", "test", "statistic", "is", "pvalue", "from", "the", "wald", "test", "we", "first", "con", "sider", "the", "case", "where", "the", "size", "factors", "are", "equal", "and", "where", "the", "gene", "wise", "dispersion", "estimates", "are", "used", "for", "each", "gene", "without", "dispersion", "shrinkage", "the", "distribution", "family", "for", "the", "negative", "binomial", "is", "parameterized", "by", "aside", "from", "discreteness", "of", "pdue", "to", "low", "counts", "for", "given", "the", "distribution", "of", "pis", "uniform", "under", "the", "null", "hypothesis", "so", "pis", "an", "ancillary", "statistic", "the", "sam", "ple", "mean", "of", "counts", "for", "gene", "ki", "is", "boundedly", "complete", "sufficient", "for", "then", "from", "basu", "theorem", "kiandpare", "independent", "while", "for", "very", "low", "counts", "one", "can", "observe", "discrete", "ness", "and", "non", "uniformity", "of", "punder", "the", "null", "hypothesis", "deseq2", "does", "not", "use", "the", "distribution", "of", "pin", "its", "estima", "tion", "procedure", "for", "example", "deseq2", "does", "not", "estimate", "the", "proportion", "of", "null", "genes", "using", "the", "distribution", "of", "so", "this", "kind", "of", "dependence", "of", "pon", "does", "not", "lead", "to", "increased", "type", "error", "if", "the", "size", "factors", "are", "not", "equal", "across", "samples", "but", "not", "correlated", "with", "condition", "conditioning", "on", "the", "mean", "ofnormalized", "counts", "should", "also", "provide", "uniformly", "dis", "tributed", "pas", "with", "conditioning", "on", "the", "mean", "of", "counts", "ki", "we", "may", "consider", "pathological", "case", "where", "the", "size", "factors", "are", "perfectly", "confounded", "with", "condition", "in", "which", "case", "even", "under", "the", "null", "hypothesis", "genes", "with", "low", "mean", "count", "would", "have", "non", "uniform", "distribution", "of", "so", "condition", "could", "have", "positive", "counts", "and", "the", "other", "condi", "tion", "often", "zero", "counts", "this", "could", "lead", "to", "non", "uniformity", "ofpunder", "the", "null", "hypothesis", "however", "such", "patholog", "ical", "case", "would", "pose", "problems", "for", "many", "statistical", "tests", "of", "differences", "in", "mean", "we", "used", "simulation", "to", "demonstrate", "that", "the", "indepen", "dence", "of", "the", "null", "distribution", "of", "the", "test", "statistic", "from", "the", "filter", "statistic", "still", "holds", "for", "dispersion", "shrinkage", "additional", "file", "figure", "s26", "displays", "marginal", "null", "distri", "butions", "of", "pacross", "the", "range", "of", "mean", "normalized", "counts", "despite", "spikes", "in", "the", "distribution", "for", "the", "genes", "with", "thelowest", "mean", "counts", "due", "to", "discreteness", "of", "the", "data", "these", "densities", "were", "nearly", "uniform", "across", "the", "range", "of", "average", "expression", "strength", "composite", "null", "hypotheses", "deseq2", "offers", "tests", "for", "composite", "null", "hypotheses", "of", "the", "formh0", "ir", "to", "find", "genes", "whose", "lfc", "significantly", "exceeds", "threshold", "the", "composite", "null", "hypothesis", "is", "replaced", "by", "two", "simple", "null", "hypotheses", "h0a", "ir", "andh0b", "ir", "pvalues", "are", "generated", "by", "integrating", "normal", "distribution", "centered", "on", "with", "standard", "deviation", "se", "ir", "from", "ir", "toward", "ev", "of", "the", "integral", "is", "then", "multiplied", "by", "and", "thresholded", "at", "this", "procedure", "controls", "type", "error", "even", "when", "ir", "and", "is", "equivalent", "to", "the", "standard", "deseq2", "value", "when", "conversely", "when", "searching", "for", "genes", "whose", "absolute", "lfc", "is", "significantly", "below", "threshold", "when", "testing", "the", "null", "hypothesis", "h0", "ir", "pvalue", "is", "con", "structed", "as", "the", "maximum", "of", "two", "one", "sided", "tests", "of", "the", "simple", "null", "hypotheses", "h0a", "ir", "andh0b", "ir", "the", "one", "sided", "pvalues", "are", "generated", "by", "integrating", "nor", "mal", "distribution", "centered", "on", "with", "standard", "deviation", "se", "ir", "from", "irtoward", "and", "integrating", "normal", "dis", "tribution", "centered", "on", "with", "standard", "deviation", "se", "ir", "from", "irtoward", "note", "that", "while", "zero", "centered", "prior", "on", "lfcs", "is", "con", "sistent", "with", "testing", "the", "null", "hypothesis", "of", "small", "lfcs", "it", "should", "not", "be", "used", "when", "testing", "the", "null", "hypothesis", "of", "large", "lfcs", "because", "the", "prior", "would", "then", "favor", "the", "alter", "native", "hypothesis", "deseq2", "requires", "that", "no", "prior", "has", "been", "used", "when", "testing", "the", "null", "hypothesis", "of", "large", "lfcs", "so", "that", "the", "data", "alone", "must", "provide", "evidence", "against", "the", "null", "hypothesis", "interactions", "two", "exceptions", "to", "the", "default", "deseq2", "lfc", "estimation", "steps", "are", "used", "for", "experimental", "designs", "with", "interaction", "terms", "first", "when", "any", "interaction", "terms", "are", "included", "in", "the", "design", "the", "lfc", "prior", "width", "for", "main", "effect", "terms", "is", "not", "estimated", "from", "the", "data", "but", "set", "to", "wide", "value", "log", "21000", "or", "1000", "on", "the", "base", "scale", "this", "ensures", "that", "shrinkage", "of", "main", "effect", "terms", "will", "not", "result", "in", "false", "positive", "calls", "of", "significance", "for", "interactions", "sec", "ond", "when", "interaction", "terms", "are", "included", "and", "all", "factors", "have", "two", "levels", "then", "standard", "design", "matrices", "are", "used", "rather", "than", "expanded", "model", "matrices", "such", "that", "only", "single", "term", "is", "used", "to", "test", "the", "null", "hypothesis", "that", "combi", "nation", "of", "two", "effects", "is", "merely", "additive", "in", "the", "logarithmic", "scale", "regularized", "logarithm", "the", "rlog", "transformation", "is", "calculated", "as", "follows", "the", "experimental", "design", "matrix", "xis", "substituted", "with", "design", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "19", "of", "21", "matrix", "with", "an", "indicator", "variable", "for", "every", "sample", "in", "addition", "to", "an", "intercept", "column", "model", "as", "described", "in", "equations", "and", "is", "fit", "with", "zero", "centered", "nor", "mal", "prior", "on", "the", "non", "intercept", "terms", "and", "using", "the", "fit", "ted", "dispersion", "values", "tr", "which", "capture", "the", "overall", "variance", "mean", "dependence", "of", "the", "dataset", "the", "true", "exper", "imental", "design", "matrix", "xis", "then", "only", "used", "in", "estimating", "the", "variance", "mean", "trend", "over", "all", "genes", "for", "unsuper", "vised", "analyses", "for", "instance", "sample", "quality", "assessment", "it", "is", "desirable", "that", "the", "experimental", "design", "has", "no", "influ", "ence", "on", "the", "transformation", "and", "hence", "deseq2", "by", "default", "ignores", "the", "design", "matrix", "and", "re", "estimates", "the", "dispersions", "treating", "all", "samples", "as", "replicates", "it", "uses", "blind", "disper", "sion", "estimation", "the", "rlog", "transformed", "values", "are", "the", "fitted", "values", "rlog", "parenleftbigkij", "parenrightbig", "log2qij", "i0", "ij", "where", "ijis", "the", "shrunken", "lfc", "on", "the", "base", "scale", "for", "thejth", "sample", "the", "variance", "of", "the", "prior", "is", "set", "using", "similar", "approach", "as", "taken", "with", "differential", "expression", "by", "matching", "zero", "centered", "normal", "distribution", "to", "observed", "lfcs", "first", "matrix", "of", "lfcs", "is", "calculated", "by", "taking", "the", "logarithm", "base", "of", "the", "normalized", "counts", "plus", "pseu", "docount", "of1", "2for", "each", "sample", "divided", "by", "the", "mean", "of", "normalized", "counts", "plus", "pseudocount", "of1", "ep", "count", "of1", "2allows", "for", "calculation", "of", "the", "logarithmic", "ratio", "for", "all", "genes", "and", "has", "little", "effect", "on", "the", "estimate", "of", "the", "variance", "of", "the", "prior", "or", "the", "fin", "al", "rlog", "transformation", "this", "matrix", "of", "lfcs", "then", "represents", "the", "common", "scale", "log", "arithmic", "ratio", "of", "each", "sample", "to", "the", "fitted", "value", "using", "only", "an", "intercept", "the", "prior", "variance", "is", "found", "by", "matching", "the", "97", "quantile", "of", "zero", "centered", "normal", "distribu", "tion", "to", "the", "95", "quantile", "of", "the", "absolute", "values", "in", "the", "lfc", "matrix", "cook", "distance", "for", "outlier", "detection", "the", "mle", "of", "vector", "iis", "used", "for", "calculating", "cook", "distance", "considering", "gene", "iand", "sample", "cook", "distance", "for", "glms", "is", "given", "by", "59", "dij", "r2", "ij", "phjj", "hjj", "where", "rijis", "the", "pearson", "residual", "of", "sample", "is", "an", "overdispersion", "parameter", "in", "the", "negative", "binomial", "glm", "is", "set", "to", "pis", "the", "number", "of", "parameters", "including", "the", "intercept", "and", "hjjis", "the", "jth", "diagonal", "element", "of", "the", "hat", "matrix", "w1", "2x", "xtwx", "1xtw1", "pearson", "residuals", "rijare", "calculated", "as", "rij", "kij", "ij", "radicalbig", "ij", "where", "ijis", "estimated", "by", "the", "negative", "binomial", "glm", "without", "the", "lfc", "prior", "and", "using", "the", "variance", "function", "method", "of", "moments", "estimate", "rob", "using", "robust", "estimator", "of", "variance", "s2", "robto", "provide", "robustness", "against", "outliers", "is", "used", "here", "rob", "max", "parenleftbigg", "s2", "rob", "parenrightbigg", "bioconductor", "package", "deseq2", "is", "implemented", "as", "package", "for", "the", "statis", "tical", "environment", "and", "is", "available", "10", "as", "part", "of", "the", "bioconductor", "project", "11", "the", "count", "matrix", "and", "meta", "data", "including", "the", "gene", "model", "and", "sample", "information", "are", "stored", "in", "an", "s4", "class", "derived", "from", "the", "summarized", "experiment", "class", "of", "the", "genomicranges", "package", "60", "summarizedexperiment", "objects", "containing", "count", "matri", "ces", "can", "be", "easily", "generated", "using", "the", "summarizeoverlaps", "function", "of", "the", "genomicalignments", "package", "61", "this", "workflow", "automatically", "stores", "the", "gene", "model", "as", "metadata", "and", "additionally", "other", "information", "such", "as", "the", "genome", "and", "gene", "annotation", "versions", "other", "methods", "to", "obtain", "count", "matrices", "include", "the", "htseq", "count", "script", "62", "and", "the", "bioconductor", "packages", "easyrnaseq", "63", "and", "feature", "count", "64", "the", "deseq2", "package", "comes", "with", "detailed", "vignette", "which", "works", "through", "number", "of", "example", "differential", "expression", "analyses", "on", "real", "datasets", "and", "the", "use", "of", "the", "rlog", "transformation", "for", "quality", "assessment", "and", "visual", "ization", "single", "function", "called", "deseq", "su", "dt", "or", "the", "default", "analysis", "while", "lower", "level", "functions", "are", "also", "available", "for", "advanced", "users", "read", "alignment", "for", "the", "bottomly", "et", "al", "and", "pickrell", "et", "al", "datasets", "reads", "were", "aligned", "using", "the", "tophat2", "aligner", "65", "and", "assigned", "to", "genes", "using", "the", "summarizeoverlaps", "func", "tion", "of", "the", "genomicranges", "package", "60", "the", "sequence", "read", "archive", "fastq", "files", "of", "the", "pickrell", "et", "al", "17", "dataset", "accession", "number", "sra", "srp001540", "were", "aligned", "to", "thehomo", "sapiens", "reference", "sequence", "grch37", "down", "loaded", "in", "march", "2013", "from", "illumina", "igenomes", "reads", "were", "counted", "in", "the", "genes", "defined", "by", "the", "ensembl", "gtf", "file", "release", "70", "contained", "in", "the", "illumina", "igenome", "the", "sequence", "read", "archive", "fastq", "files", "of", "the", "bottomly", "et", "al", "16", "dataset", "accession", "number", "sra", "srp004777", "were", "aligned", "to", "the", "mus", "musculus", "reference", "sequence", "ncbim37", "downloaded", "in", "march", "2013", "from", "illumina", "igenomes", "reads", "were", "counted", "in", "the", "genes", "defined", "by", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "20", "of", "21", "the", "ensembl", "gtf", "file", "release", "66", "contained", "in", "the", "illumina", "igenome", "reproducible", "code", "sweave", "vignettes", "for", "reproducing", "all", "figures", "and", "tables", "in", "this", "paper", "including", "data", "objects", "for", "the", "experiments", "mentioned", "and", "code", "for", "aligning", "reads", "and", "for", "bench", "marking", "can", "be", "found", "in", "package", "deseq2paper", "66", "additional", "file", "additional", "file", "supplementary", "methods", "tables", "and", "figures", "abbreviations", "fdr", "false", "discovery", "rate", "glm", "generalized", "linear", "model", "hts", "high", "throughput", "sequencing", "lfc", "logarithmic", "fold", "change", "map", "maximum", "posteriori", "mle", "maximum", "likelihood", "estimate", "rna", "seq", "rna", "sequencing", "vst", "variance", "stabilizing", "transformation", "competing", "interests", "the", "authors", "declare", "that", "they", "have", "no", "competing", "interests", "authors", "contributions", "all", "authors", "developed", "the", "method", "and", "wrote", "the", "manuscript", "mil", "implemented", "the", "method", "and", "performed", "the", "analyses", "all", "authors", "read", "and", "approved", "the", "final", "manuscript", "acknowledgements", "the", "authors", "thank", "all", "users", "of", "deseq", "and", "deseq2", "who", "provided", "valuable", "feedback", "we", "thank", "judith", "zaugg", "for", "helpful", "comments", "on", "the", "manuscript", "mil", "acknowledges", "funding", "via", "stipend", "from", "the", "international", "max", "planck", "research", "school", "for", "computational", "biology", "and", "scientific", "computing", "and", "grant", "from", "the", "national", "institutes", "of", "health", "5t32ca009337", "33", "wh", "and", "sa", "acknowledge", "funding", "from", "the", "european", "union", "7th", "framework", "programme", "health", "via", "project", "radiant", "we", "thank", "an", "anonymous", "reviewer", "for", "raising", "the", "question", "of", "estimation", "biases", "in", "the", "ispersion", "mean", "trend", "fitting", "author", "details", "1department", "of", "biostatistics", "and", "compu", "tational", "biology", "dana", "farber", "cancer", "institute", "and", "department", "of", "biostatistics", "harvard", "school", "of", "public", "health", "450", "brookline", "avenue", "boston", "ma", "02215", "usa", "2genome", "biology", "unit", "european", "molecular", "biology", "laboratory", "meyerhofstrasse", "69117", "heidelberg", "germany", "3department", "of", "computational", "molecular", "biology", "max", "planck", "institute", "for", "molecular", "genetics", "ihnestrasse", "63", "73", "14195", "berlin", "germany", "received", "27", "may", "2014", "accepted", "19", "november", "2014", "references", "nnstedt", "speed", "replicated", "microarray", "data", "stat", "sinica", "2002", "12", "31", "46", "robinson", "md", "smyth", "gk", "moderated", "statistical", "tests", "for", "assessing", "differences", "in", "tag", "abundance", "bioinformatics", "2007", "23", "2881", "2887", "mccarthy", "dj", "chen", "smyth", "gk", "differential", "expression", "analysis", "of", "multifactor", "rna", "seq", "experiments", "with", "respect", "to", "biological", "variation", "nucleic", "acids", "res", "2012", "40", "4288", "4297", "anders", "huber", "differential", "expression", "analysis", "for", "sequence", "count", "data", "genome", "biol", "2010", "11", "106", "zhou", "xia", "wright", "fa", "powerful", "and", "flexible", "approach", "to", "the", "analysis", "of", "rna", "sequence", "count", "data", "bioinformatics", "2011", "27", "2672", "2678", "wu", "wang", "wu", "new", "shrinkage", "estimator", "for", "dispersion", "improves", "differential", "expression", "detection", "in", "rna", "seq", "data", "biostatistics", "2013", "14", "232", "243", "hardcastle", "kelly", "bayseq", "empirical", "bayesian", "methods", "for", "identifying", "differential", "expression", "in", "sequence", "count", "data", "bmc", "bioinformatics", "2010", "11", "422", "van", "de", "wiel", "ma", "leday", "ggr", "pardo", "rue", "van", "der", "vaart", "aw", "van", "wieringen", "wn", "bayesian", "analysis", "of", "rna", "sequencing", "data", "by", "estimating", "multiple", "shrinkage", "priors", "biostatistics", "2013", "14", "113", "128", "boer", "jm", "huber", "wk", "ltmann", "wilmer", "von", "heydebreck", "haas", "korn", "gunawan", "vente", "zesi", "vingron", "poustka", "identification", "and", "classification", "of", "differentially", "expressed", "genes", "in", "renal", "cell", "carcinoma", "by", "expression", "profiling", "on", "global", "human", "31", "500", "element", "cdna", "array", "genome", "res", "2001", "11", "1861", "1870", "10", "deseq2", "http", "www", "bioconductor", "org", "ackages", "release", "bioc", "html", "deseq2", "html", "11", "gentleman", "rc", "carey", "vj", "bates", "dm", "bolstad", "dettling", "dudoit", "ellis", "gautier", "ge", "gentry", "hornik", "hothorn", "huber", "iacus", "irizarry", "leisch", "li", "maechler", "rossini", "aj", "sawitzki", "smith", "smyth", "tierney", "yang", "jy", "zhang", "bioconductor", "open", "software", "development", "for", "computational", "biology", "and", "bioinformatics", "genome", "biol", "2004", "r80", "12", "mccullagh", "nelder", "ja", "generalized", "linear", "models", "inmonographs", "on", "statistics", "applied", "probability", "2nd", "edition", "london", "uk", "chapman", "hall", "crc", "1989", "13", "hansen", "kd", "irizarry", "ra", "wu", "removing", "technical", "variability", "in", "rna", "seq", "data", "using", "conditional", "quantile", "normalization", "biostatistics", "2012", "13", "204", "216", "14", "risso", "schwartz", "sherlock", "dudoit", "gc", "content", "normalization", "for", "rna", "seq", "data", "bmc", "bioinformatics", "2011", "12", "480", "15", "smyth", "gk", "linear", "models", "and", "empirical", "bayes", "methods", "for", "assessing", "differential", "expression", "in", "microarray", "experiments", "stat", "appl", "genet", "mol", "biol2004", "25", "16", "bottomly", "walter", "nar", "hunter", "je", "darakjian", "kawane", "buck", "kj", "searles", "rp", "mooney", "mcweeney", "sk", "hitzemann", "evaluating", "gene", "expression", "in", "c57bl", "6j", "and", "dba", "2j", "mouse", "striatum", "using", "rna", "seq", "and", "microarrays", "plos", "one", "2011", "17820", "17", "pickrell", "jk", "marioni", "jc", "pai", "aa", "degner", "jf", "engelhardt", "be", "nkadori", "veyrieras", "stephens", "gilad", "pritchard", "jk", "understanding", "mechanisms", "underlying", "human", "gene", "expression", "variation", "with", "rna", "sequencing", "nature", "2010", "464", "768", "772", "18", "hastie", "tibshirani", "friedman", "the", "elements", "of", "statistical", "learning", "data", "mining", "inference", "and", "prediction", "2nd", "edition", "new", "york", "city", "usa", "springer", "2009", "19", "bi", "davuluri", "npebseq", "nonparametric", "empirical", "bayesian", "based", "procedure", "for", "differential", "expression", "analysis", "of", "rna", "seq", "data", "bmc", "bioinformatics", "2013", "14", "262", "20", "feng", "meyer", "ca", "wang", "liu", "js", "liu", "xs", "zhang", "gfold", "generalized", "fold", "change", "for", "ranking", "differen", "tially", "expressed", "genes", "from", "rna", "seq", "data", "bioinformatics", "2012", "28", "2782", "2788", "21", "benjamini", "hochberg", "controlling", "the", "false", "discovery", "rate", "practical", "and", "powerful", "approach", "to", "multiple", "testing", "stat", "soc", "ser", "methodol", "1995", "57", "289", "300", "22", "bourgon", "gentleman", "huber", "independent", "filtering", "increases", "detection", "power", "for", "high", "throughput", "experiments", "proc", "natl", "acad", "sci", "usa", "2010", "107", "9546", "9551", "23", "mccarthy", "dj", "smyth", "gk", "testing", "significance", "relative", "to", "fold", "change", "threshold", "is", "treat", "bioinformatics", "2009", "25", "765", "771", "24", "li", "tibshirani", "finding", "consistent", "patterns", "nonparametric", "approach", "for", "identifying", "differential", "expression", "in", "rna", "seq", "data", "stat", "methods", "med", "res", "2013", "22", "519", "536", "25", "cook", "rd", "detection", "of", "influential", "observation", "in", "linear", "regression", "technometrics", "1977", "19", "15", "18", "26", "hammer", "banck", "ms", "amberg", "wang", "petznick", "luo", "khrebtukova", "schroth", "gp", "beyerlein", "beutler", "as", "mrna", "seq", "with", "agnostic", "splice", "site", "discovery", "for", "nervous", "system", "transcriptomics", "tested", "in", "chronic", "pain", "genome", "res", "2010", "20", "847", "860", "27", "frazee", "langmead", "leek", "recount", "multi", "experiment", "resource", "of", "analysis", "ready", "rna", "seq", "gene", "count", "datasets", "bmc", "bioinformatics", "2011", "12", "449", "28", "trapnell", "hendrickson", "dg", "sauvageau", "goff", "rinn", "jl", "pachter", "differential", "analysis", "of", "gene", "regulatio", "at", "transcript", "resolution", "with", "rna", "seq", "nat", "biotechnol", "2012", "31", "46", "53", "29", "glaus", "honkela", "rattray", "identifying", "differentially", "expressed", "transcripts", "from", "rna", "seq", "data", "ith", "biological", "variation", "bioinformatics", "2012", "28", "1721", "1728", "love", "et", "al", "genome", "biology", "2014", "15", "550", "page", "21", "of", "21", "30", "anders", "reyes", "huber", "detecting", "differential", "usage", "of", "exons", "from", "rna", "seq", "data", "genome", "res", "2012", "22", "2008", "2017", "31", "sammeth", "complete", "alternative", "splicing", "events", "are", "bubbles", "in", "splicing", "graphs", "jc", "tb", "2009", "16", "1117", "1140", "32", "pag", "bindreither", "carlson", "morgan", "splicinggraphs", "create", "manipulate", "visualize", "splicing", "raphs", "and", "assign", "rna", "seq", "reads", "to", "them", "2013", "bioconductor", "package", "http", "www", "bioconductor", "org", "33", "robinson", "md", "mccarthy", "dj", "smyth", "gk", "edger", "bioconductor", "package", "for", "differential", "expression", "analysis", "of", "digital", "gene", "xpression", "data", "bioinformatics", "2009", "26", "139", "140", "34", "zhou", "lindsay", "robinson", "md", "robustly", "detecting", "differential", "expression", "in", "rna", "sequencing", "data", "using", "observation", "weights", "nucleic", "acids", "res", "2014", "42", "e91", "35", "leng", "dawson", "ja", "thomson", "ja", "ruotti", "rissman", "ai", "smits", "bmg", "haag", "jd", "gould", "mn", "stewart", "rm", "kendziorski", "ebseq", "an", "empirical", "bayes", "hierarchical", "model", "for", "inference", "in", "rna", "seq", "experiments", "bioinformatics", "2013", "29", "1035", "1043", "36", "law", "cw", "chen", "shi", "smyth", "gk", "voom", "precision", "weights", "unlock", "linear", "model", "analysis", "tools", "for", "rna", "seq", "read", "counts", "genome", "biol", "2014", "15", "29", "37", "hubert", "arabie", "comparing", "partitions", "classif", "1985", "193", "218", "38", "witten", "dm", "classification", "and", "clustering", "of", "sequencing", "data", "using", "poisson", "model", "ann", "appl", "stat", "2011", "2493", "2518", "39", "irizarry", "ra", "wu", "jaffee", "ha", "comparison", "of", "affymetrix", "genechip", "expression", "measures", "bioinformatics", "2006", "22", "789", "794", "40", "asangani", "ia", "dommeti", "vl", "wang", "malik", "cieslik", "yang", "escara", "wilke", "wilder", "romans", "dhanireddy", "en", "gelke", "iyer", "mk", "jing", "wu", "cao", "qin", "zs", "wang", "feng", "fy", "chinnaiyan", "am", "therapeutic", "targeting", "of", "bet", "bromodomain", "proteins", "in", "castration", "resistant", "prostate", "cancer", "nature", "2014", "510", "278", "282", "41", "stark", "brown", "diffbind", "differential", "binding", "analysis", "of", "chip", "seq", "peak", "data", "2013", "bioconductor", "package", "http", "www", "bioconductor", "org", "42", "ross", "innes", "cs", "stark", "teschendorff", "ae", "holmes", "ka", "ali", "hr", "dunning", "mj", "brown", "gd", "gojis", "ellis", "io", "green", "ar", "ali", "chin", "palmieri", "caldas", "carroll", "js", "differential", "oestrogen", "receptor", "binding", "is", "associated", "with", "clinical", "outcome", "in", "breast", "cancer", "nature", "2012", "481", "389", "393", "43", "robinson", "dg", "chen", "storey", "jd", "gresham", "design", "and", "analysis", "of", "bar", "seq", "experiments", "g3", "bethesda", "2013", "11", "18", "44", "mcmurdie", "pj", "holmes", "waste", "not", "want", "not", "why", "rarefying", "microbiome", "data", "is", "inadmissible", "plos", "comput", "biol", "2014", "10", "1003531", "45", "vasquez", "hon", "vanselow", "jt", "schlosser", "siegel", "tn", "comparative", "ribosome", "profiling", "reveals", "extensive", "translational", "complexity", "in", "different", "trypanosoma", "brucei", "life", "cycle", "stages", "nucleic", "acids", "res", "2014", "42", "3623", "3637", "46", "zhou", "zhu", "cai", "yuan", "li", "huang", "wei", "high", "throughput", "screening", "of", "crispr", "cas9", "library", "for", "functional", "genomics", "in", "human", "cells", "nature", "2014", "509", "487", "491", "47", "cox", "dr", "reid", "parameter", "orthogonality", "and", "approximate", "conditional", "inference", "stat", "soc", "ser", "methodol", "1987", "49", "39", "48", "robinson", "md", "smyth", "gk", "small", "sample", "estimation", "of", "negative", "binomial", "dispersion", "with", "applications", "to", "sage", "data", "biostatistics", "2007", "321", "332", "49", "pawitan", "in", "all", "likelihood", "statistical", "modelling", "and", "inference", "using", "likelihood", "1st", "edition", "new", "york", "city", "usa", "oxford", "university", "press", "2001", "50", "armijo", "minimization", "of", "functions", "having", "lipschitz", "continuous", "first", "partial", "derivatives", "pac", "math", "1966", "16", "51", "di", "schafer", "dw", "cumbie", "js", "chang", "jh", "the", "nbp", "negative", "binomial", "model", "for", "assessing", "differential", "gene", "expression", "from", "rna", "seq", "stat", "appl", "genet", "mol", "biol", "2011", "10", "28", "52", "abramowitz", "stegun", "handbook", "of", "mathematical", "functions", "1st", "edition", "new", "york", "usa", "dover", "publications", "1965", "dover", "books", "on", "mathematics", "53", "newton", "kendziorski", "richmond", "blattner", "tsui", "on", "differential", "variability", "of", "expression", "ratios", "improving", "statistical", "inference", "about", "gene", "expression", "changes", "from", "microarray", "data", "jc", "tb", "2001", "37", "52", "54", "huber", "von", "heydebreck", "sultmann", "poustka", "vingron", "variance", "stabilization", "applied", "to", "microarray", "data", "calibration", "and", "to", "the", "quantification", "of", "differential", "expression", "bioinformatics", "2002", "18", "96", "104", "55", "durbin", "bp", "hardin", "js", "hawkins", "dm", "rocke", "dm", "variance", "stabilizing", "transformation", "for", "gene", "expression", "microarray", "data", "bioinformatics", "2002", "18", "105", "110", "56", "park", "my", "generalized", "linear", "models", "with", "regularization", "phd", "thesis", "stanford", "university", "department", "of", "statistics", "2006", "57", "friedman", "hastie", "tibshirani", "regularization", "paths", "for", "generalized", "linear", "models", "via", "coordinate", "descent", "stat", "softw", "2010", "33", "22", "58", "cule", "vineis", "de", "iorio", "significance", "testing", "in", "ridge", "regression", "for", "genetic", "data", "bmc", "bioinformatics", "2011", "12", "372", "59", "cook", "rd", "weisberg", "residuals", "and", "influence", "in", "regression", "1st", "edition", "new", "york", "usa", "chapman", "and", "hall", "crc", "1982", "60", "lawrence", "huber", "pag", "aboyoun", "carlson", "gentleman", "morgan", "mt", "carey", "vj", "software", "for", "computing", "and", "annotating", "genomic", "ranges", "plos", "comput", "biol", "2013", "1003118", "61", "pag", "obenchain", "morgan", "genomicalignments", "representation", "and", "manipulatio", "of", "short", "genomic", "alignments", "2013", "bioconductor", "package", "http", "www", "bioconductor", "org", "62", "anders", "pyl", "pt", "huber", "htseq", "python", "framework", "to", "work", "with", "high", "throughput", "sequencing", "data", "bioinformatics", "2015", "31", "166", "63", "delhomme", "padioleau", "furlong", "ee", "steinmetz", "lm", "easyrnaseq", "bioconductor", "package", "for", "processing", "rna", "seq", "data", "bioinformatics", "2012", "28", "2532", "2533", "64", "liao", "smyth", "gk", "shi", "featurecounts", "an", "efficient", "general", "purpose", "program", "for", "assigning", "sequence", "reads", "to", "genomic", "features", "bioinformatics", "2014", "30", "923", "930", "65", "kim", "pertea", "trapnell", "pimentel", "kelley", "salzberg", "tophat2", "accurate", "alignment", "of", "transcriptomes", "in", "the", "presence", "of", "insertions", "deletions", "and", "gene", "fusions", "genome", "biol", "2013", "14", "36", "66", "deseq2paper", "http", "www", "huber", "embl", "de", "deseq2paper", "submit", "your", "next", "manuscript", "to", "biomed", "central", "and", "take", "full", "advantage", "of", "convenient", "online", "submission", "thorough", "peer", "review", "no", "space", "constraints", "or", "color", "gure", "charges", "immediate", "publication", "on", "acceptance", "inclusion", "in", "pubmed", "cas", "scopus", "and", "google", "scholar", "research", "which", "is", "freely", "available", "for", "redistribution", "submit", "your", "manuscript", "at", "www", "biomedcentral", "com", "submit"], "citations": ["[1]", "[2]", "[3]", "[4]", "[5]", "[6]", "[7]", "[8]", "[9]", "[10]", "[11]", "[12]", "[13]", "[14]", "[15]", "[16]", "[17]", "[18]", "[19]", "[20]", "[21]", "[22]", "[23]", "[24]", "[25]", "[26]", "[27]", "[28]", "[29]", "[30]", "[31]", "[32]", "[33]", "[34]", "[35]", "[36]", "[37]", "[38]", "[39]", "[40]", "[41]", "[42]", "[43]", "[44]", "[45]", "[46]", "[47]", "[48]", "[49]", "[50]", "[51]", "[52]", "[53]", "[55]", "[56]", "[57]", "[58]", "[59]", "[60]", "[61]", "[62]", "[63]", "[64]", "[65]", "[66]", "1. Lnnstedt I, Speed T: Replicated microarray data. Stat Sinica 2002,", "variation. Nucleic Acids Res 2012, 40:42884297.", "count data. Genome Biol 2010, 11:106.", "Biostatistics 2013, 14:232243.7. Hardcastle T, Kelly K: baySeq: empirical Bayesian methods for", "31,500-element cDNA array. Genome Res 2001, 11:18611870.", "computational biology and bioinformatics. Genome Biol 2004, 5:R80.", "Stat Methods Med Res 2013, 22:519536.", "pain. Genome Res 2010, 20:847860.", "RNA-seq. Nat Biotechnol 2012, 31:4653.", "Bioinformatics 2012, 28:17211728. Love et al. Genome Biology  (2014) 15:550 Page 21 of 21", "from RNA-seq data. Genome Res 2012, 22:20082017.", "Nucleic Acids Res 2014, 42:e91.", "37. Hubert L, Arabie P: Comparing partitions. J Classif 1985, 2:193218.", "Poisson model. Ann Appl Stat 2011, 5:24932518.", "microbiome data is inadmissible. PLoS Comput Biol 2014, 10:1003531.", "different Trypanosoma brucei life cycle stages. Nucleic Acids Res 2014,", "conditional inference. J R Stat Soc Ser B Methodol 1987, 49:139.", "Likelihood . 1st edition. New York City, USA: Oxford University Press; 2001.", "partial derivatives. Pac J Math 1966, 16:13.", "Appl Genet Mol Biol 2011, 10:128.", "New York, USA: Dover Publications; 1965. [Dover Books on mathematics]", "2002, 18:105110.56. Park MY: Generalized linear models with regularization. PhD thesis.", "Stanford University, Department of Statistics; 2006.", "linear models via coordinate descent. J Stat Softw 2010, 33:122.", "New York, USA: Chapman and Hall/CRC; 1982.", "genomic ranges. PLoS Comput Biol 2013, 9:1003118.", "deletions and gene fusions. Genome Biol 2013, 14:36."]}
{"doc_id": 6, "url": "https://journals.iucr.org/a/issues/2008/01/00/sc5010/sc5010.pdf", "title": "A short history of<i>SHELX</i>", "title_tokens": ["a", "short", "history", "of", "i", "shelx", "i"], "page_rank": {"cited_by_count": 86442}}
{"doc_id": 7, "url": "https://onlinelibrary.wiley.com/doi/pdfdirect/10.3322/caac.21492", "title": "Global cancer statistics 2018: GLOBOCAN estimates of incidence and mortality worldwide for 36 cancers in 185 countries", "title_tokens": ["global", "cancer", "statistics", "2018", "globocan", "estimates", "of", "incidence", "and", "mortality", "worldwide", "for", "36", "cancers", "in", "185", "countries"], "page_rank": {"cited_by_count": 86148}}
{"doc_id": 8, "url": "https://www.bmj.com/content/bmj/339/bmj.b2535.full.pdf", "title": "Preferred reporting items for systematic reviews and meta-analyses: the PRISMA statement", "title_tokens": ["preferred", "reporting", "items", "for", "systematic", "reviews", "and", "meta", "analyses", "the", "prisma", "statement"], "page_rank": {"cited_by_count": 81955}}
{"doc_id": 9, "url": "https://www.jstatsoft.org/index.php/jss/article/view/v067i01/v67i01.pdf", "title": "Fitting Linear Mixed-Effects Models Using<b>lme4</b>", "title_tokens": ["fitting", "linear", "mixed", "effects", "models", "using", "b", "lme4", "b"], "page_rank": {"cited_by_count": 78437}, "body_tokens": ["jss", "journal", "of", "statistical", "software", "october", "2015", "volume", "67", "issue", "doi", "10", "18637", "jss", "v067", "i01", "fitting", "linear", "mixed", "ects", "models", "using", "lme4", "douglas", "bates", "university", "of", "wisconsin", "madisonmartin", "chler", "eth", "zurich", "benjamin", "bolker", "mcmaster", "universitysteven", "walker", "mcmaster", "university", "abstract", "maximum", "likelihood", "or", "restricted", "maximum", "likelihood", "reml", "estimates", "of", "the", "pa", "rameters", "in", "linear", "mixed", "ects", "models", "can", "be", "determined", "using", "the", "lmerfunction", "in", "the", "lme4package", "for", "as", "for", "most", "model", "tting", "functions", "in", "the", "model", "is", "described", "in", "anlmercall", "by", "formula", "in", "this", "case", "including", "both", "xed", "and", "random", "ects", "terms", "the", "formula", "and", "data", "together", "determine", "numerical", "representation", "of", "the", "model", "from", "which", "the", "pro", "led", "deviance", "or", "the", "pro", "led", "reml", "criterion", "can", "be", "evaluated", "as", "function", "of", "some", "of", "the", "model", "parameters", "the", "appropriate", "criterion", "is", "optimized", "using", "one", "of", "the", "constrained", "optimization", "functions", "in", "to", "provide", "the", "parameter", "estimates", "we", "de", "scribe", "the", "structure", "of", "the", "model", "the", "steps", "in", "evaluating", "the", "pro", "led", "deviance", "or", "reml", "criterion", "and", "the", "structure", "of", "classes", "or", "types", "that", "represents", "such", "model", "su", "cient", "detail", "is", "included", "to", "allow", "specialization", "of", "these", "structures", "by", "users", "who", "wish", "to", "write", "functions", "to", "specialized", "linear", "mixed", "models", "such", "as", "models", "incorporating", "pedigrees", "or", "smoothing", "splines", "that", "are", "not", "easily", "expressible", "in", "the", "formula", "language", "used", "by", "lmer", "keywords", "sparse", "matrix", "methods", "linear", "mixed", "models", "penalized", "least", "squares", "cholesky", "decomposition", "introduction", "thelme4package", "bates", "maechler", "bolker", "and", "walker", "2015", "for", "rcore", "team", "2015", "provides", "functions", "to", "and", "analyze", "linear", "mixed", "models", "generalized", "linear", "mixed", "models", "and", "nonlinear", "mixed", "models", "in", "each", "of", "these", "names", "the", "term", "mixed", "or", "more", "fully", "mixed", "ects", "denotes", "model", "that", "incorporates", "both", "xed", "and", "random", "ects", "terms", "in", "linear", "predictorexpressionfromwhichtheconditionalmeanoftheresponsecanbeevaluated", "inthis", "paper", "we", "describe", "the", "formulation", "and", "representation", "of", "linear", "mixed", "models", "the", "techniques", "linear", "mixed", "models", "with", "lme4", "used", "for", "generalized", "linear", "and", "nonlinear", "mixed", "models", "will", "be", "described", "separately", "in", "future", "paper", "at", "present", "the", "main", "alternative", "to", "lme4for", "mixed", "modeling", "in", "ris", "thenlmepackage", "pin", "heiro", "bates", "debroy", "sarkar", "and", "rcore", "team", "2015", "the", "main", "features", "distinguishing", "lme4fromnlmeare", "more", "cient", "linear", "algebra", "tools", "giving", "improved", "performance", "on", "large", "problems", "simpler", "syntax", "and", "more", "cient", "implementation", "for", "tting", "models", "with", "crossed", "random", "ects", "the", "implementation", "of", "pro", "le", "likelihood", "con", "dence", "intervals", "on", "random", "ects", "parameters", "and", "the", "ability", "to", "generalized", "linear", "mixed", "models", "al", "though", "in", "this", "paper", "we", "restrict", "ourselves", "to", "linear", "mixed", "models", "the", "main", "advantage", "of", "nlmerelative", "to", "lme4is", "user", "interface", "for", "tting", "models", "with", "structure", "in", "the", "residuals", "var", "ious", "forms", "of", "heteroscedasticity", "and", "autocorrelation", "and", "in", "the", "random", "ects", "covariance", "matrices", "compound", "symmetric", "models", "with", "some", "extra", "ort", "the", "computational", "machinery", "of", "lme4can", "be", "used", "to", "structured", "models", "that", "the", "basic", "lmerfunction", "cannot", "handle", "see", "appendix", "the", "development", "of", "general", "software", "for", "tting", "mixed", "models", "remains", "an", "active", "area", "of", "re", "search", "with", "many", "open", "problems", "consequently", "the", "lme4package", "has", "evolved", "since", "it", "was", "rst", "released", "and", "continues", "to", "improve", "as", "we", "learn", "more", "about", "mixed", "models", "however", "we", "recognize", "the", "need", "to", "maintain", "stability", "and", "backward", "compatibility", "of", "lme4so", "that", "it", "continues", "to", "be", "broadly", "useful", "in", "order", "to", "maintain", "stability", "while", "continuing", "to", "advance", "mixed", "model", "computation", "we", "have", "developed", "several", "additional", "frameworks", "that", "draw", "on", "the", "basic", "ideas", "of", "lme4but", "modify", "its", "structure", "or", "implementation", "in", "various", "ways", "these", "descendants", "include", "the", "mixedmodels", "package", "bates", "2015", "in", "julia", "bezanson", "karpinski", "shah", "and", "edelman", "2012", "the", "lme4purer", "package", "bates", "and", "walker", "2013", "in", "and", "the", "exlambda", "development", "branchof", "lme4", "the", "currentarticleislargely", "restricted", "todescribing", "the", "current", "stable", "version", "of", "the", "lme4package", "10", "with", "appendix", "describing", "hooks", "into", "the", "computational", "machinery", "that", "are", "designed", "for", "extension", "development", "the", "gamm4", "wood", "and", "scheipl", "2014", "and", "blme", "dorie", "2015", "chung", "rabe", "hesketh", "dorie", "gelman", "and", "liu", "2013", "packages", "currently", "make", "use", "of", "these", "hooks", "another", "goal", "of", "this", "article", "is", "to", "contrast", "the", "approach", "used", "by", "lme4with", "previous", "formu", "lations", "of", "mixed", "models", "the", "expressions", "for", "the", "pro", "led", "log", "likelihood", "and", "pro", "led", "reml", "restricted", "maximum", "likelihood", "criteria", "derived", "in", "section", "are", "similar", "to", "those", "presented", "in", "bates", "and", "debroy", "2004", "and", "indeed", "are", "closely", "related", "to", "henderson", "mixed", "model", "equations", "henderson", "jr", "1982", "nonetheless", "there", "are", "subtle", "but", "important", "changes", "in", "the", "formulation", "of", "the", "model", "and", "in", "the", "structure", "of", "the", "resulting", "penalized", "least", "squares", "pls", "problem", "to", "be", "solved", "section", "we", "derive", "the", "current", "version", "of", "the", "pls", "problem", "section", "and", "contrast", "this", "result", "with", "earlier", "formulations", "section", "this", "article", "is", "organized", "into", "four", "main", "sections", "sections", "and", "each", "of", "which", "corresponds", "to", "one", "of", "the", "four", "largely", "separate", "modules", "that", "comprise", "lme4", "before", "describing", "the", "details", "of", "each", "module", "we", "describe", "the", "general", "form", "of", "the", "linear", "mixed", "model", "underlying", "lme4", "section1", "introducethe", "sleepstudy", "datathatwillbeusedasanexamplethroughout", "section", "and", "broadly", "outline", "lme4", "modular", "structure", "section", "linear", "mixed", "models", "just", "as", "linear", "model", "is", "described", "by", "the", "distribution", "of", "vector", "valued", "random", "response", "variable", "whoseobservedvalueis", "yobs", "alinearmixedmodelisdescribedbythedistribution", "journal", "of", "statistical", "software", "of", "two", "vector", "valued", "random", "variables", "the", "response", "and", "the", "vector", "of", "random", "ects", "in", "linear", "model", "the", "distribution", "of", "yis", "multivariate", "normal", "2w", "wherenis", "the", "dimension", "of", "the", "response", "vector", "wis", "diagonal", "matrix", "of", "known", "prior", "weights", "is", "ap", "dimensional", "coe", "cient", "vector", "xis", "ann", "pmodel", "matrix", "and", "ois", "vector", "of", "known", "prior", "set", "terms", "the", "parameters", "of", "the", "model", "are", "the", "coe", "cients", "and", "the", "scale", "parameter", "in", "linear", "mixed", "model", "it", "is", "the", "conditional", "distribution", "ofygivenb", "bthat", "has", "such", "form", "zb", "2w", "wherezisthen", "qmodelmatrixforthe", "dimensionalvector", "valuedrandom", "ectsvariable", "whose", "value", "we", "are", "xing", "at", "the", "unconditional", "distribution", "of", "bis", "also", "multivariate", "normal", "with", "mean", "zero", "and", "parameterized", "qvariance", "covariance", "matrix", "as", "variance", "covariance", "matrix", "must", "be", "positive", "semide", "nite", "it", "is", "convenient", "to", "express", "the", "model", "in", "terms", "of", "relative", "covariance", "factor", "which", "is", "qmatrix", "depending", "on", "thevariance", "component", "parameter", "and", "generating", "the", "symmetric", "qvariance", "covariance", "matrix", "according", "to", "latticetop", "where", "is", "the", "same", "scale", "factor", "as", "in", "the", "conditional", "distribution", "although", "equations", "and", "fully", "describe", "the", "class", "of", "linear", "mixed", "models", "that", "lme4can", "this", "terse", "description", "hides", "many", "important", "details", "before", "moving", "on", "to", "these", "details", "we", "make", "few", "observations", "this", "formulation", "of", "linear", "mixed", "models", "allows", "for", "relatively", "compact", "expression", "for", "the", "pro", "led", "log", "likelihood", "of", "section", "equation", "34", "thematricesassociatedwithrandome", "ects", "zand", "typicallyhaveasparsestructure", "with", "sparsity", "pattern", "that", "encodes", "various", "model", "assumptions", "sections", "and", "provide", "details", "on", "these", "structures", "and", "how", "to", "represent", "them", "ciently", "the", "interface", "provided", "by", "lme4", "slmerfunction", "is", "slightly", "less", "general", "than", "the", "model", "described", "by", "equations", "and", "to", "take", "advantage", "of", "the", "entire", "range", "of", "possibili", "ties", "one", "may", "use", "the", "modular", "functions", "sections", "and", "appendix", "or", "explore", "the", "experimental", "exlambda", "branch", "of", "lme4on", "github", "example", "throughout", "our", "discussion", "of", "lme4", "we", "will", "work", "with", "data", "set", "on", "the", "average", "reaction", "time", "per", "day", "for", "subjects", "in", "sleep", "deprivation", "study", "belenky", "et", "al", "2003", "on", "day", "the", "subjects", "had", "their", "normal", "amount", "of", "sleep", "starting", "that", "night", "they", "were", "restricted", "to", "hours", "of", "sleep", "per", "night", "the", "response", "variable", "reaction", "represents", "average", "reaction", "times", "in", "milliseconds", "ms", "on", "series", "of", "tests", "given", "each", "dayto", "each", "subject", "figure", "linear", "mixed", "models", "with", "lme4", "days", "of", "sleep", "deprivationaverage", "reaction", "time", "ms", "200250300350400450", "33502468", "309", "33002468", "331", "31002468", "351", "33302468", "371", "332", "02468", "372", "369", "02468", "334", "349", "02468", "352", "370", "02468", "337", "350", "02468200250300350400450", "308", "figure", "average", "reaction", "time", "versus", "days", "of", "sleep", "deprivation", "by", "subject", "subjects", "ordered", "from", "left", "to", "right", "starting", "on", "the", "top", "row", "by", "increasing", "slope", "of", "subject", "speci", "linear", "regressions", "str", "sleepstudy", "quotesingle", "ts1data", "frame", "quotesingle", "ts1", "180", "obs", "of", "variables", "reaction", "num", "250", "259", "251", "321", "357", "days", "num", "subject", "factor", "18", "levels", "308", "309", "310", "each", "subject", "reaction", "time", "increases", "approximately", "linearly", "with", "the", "number", "of", "sleep", "deprived", "days", "however", "subjects", "also", "appear", "to", "vary", "in", "the", "slopes", "and", "intercepts", "of", "these", "relationships", "which", "suggests", "model", "with", "random", "slopes", "and", "intercepts", "as", "we", "shall", "see", "such", "model", "may", "be", "tted", "by", "minimizing", "the", "reml", "criterion", "equation", "39", "using", "fm1", "lmer", "reaction", "days", "days", "subject", "sleepstudy", "the", "estimates", "of", "the", "standard", "deviations", "of", "the", "random", "ects", "for", "the", "intercept", "and", "the", "slope", "are24", "74msand5", "92ms", "day", "the", "xed", "ectscoe", "cients", "are251", "4msand10", "47ms", "day", "for", "the", "intercept", "and", "slope", "in", "this", "model", "one", "interpretation", "of", "these", "xed", "ects", "is", "that", "they", "are", "the", "estimated", "population", "mean", "values", "of", "the", "random", "intercept", "and", "slope", "section", "we", "have", "chosen", "the", "sleepstudy", "example", "because", "it", "is", "relatively", "small", "and", "simple", "example", "to", "illustrate", "the", "theory", "and", "practice", "underlying", "lmer", "however", "lmeris", "capable", "of", "tting", "more", "complex", "mixed", "models", "to", "larger", "data", "sets", "for", "example", "we", "direct", "the", "interested", "reader", "torshowdoc", "lmerperf", "package", "lme4", "for", "examples", "that", "more", "thoroughly", "exercise", "the", "performance", "capabilities", "of", "lmer", "journal", "of", "statistical", "software", "module", "rfunction", "description", "formula", "module", "section", "lformula", "accepts", "mixed", "model", "formula", "data", "and", "other", "user", "inputs", "and", "returns", "list", "of", "objects", "required", "to", "linear", "mixed", "model", "objective", "function", "module", "section", "mklmerdevfun", "accepts", "the", "results", "of", "lformula", "and", "returns", "function", "to", "calculate", "the", "deviance", "or", "restricted", "deviance", "as", "function", "of", "the", "covariance", "parameters", "optimization", "module", "section", "optimizelmer", "accepts", "deviance", "function", "returned", "by", "mklmerdevfun", "and", "returns", "the", "results", "of", "the", "optimization", "of", "that", "deviance", "function", "output", "module", "section", "mkmermod", "accepts", "an", "optimized", "deviance", "function", "and", "packages", "the", "results", "into", "useful", "object", "table", "the", "high", "level", "modular", "structure", "of", "lmer", "high", "level", "modular", "structure", "the", "lmerfunction", "is", "composed", "of", "four", "largely", "independent", "modules", "in", "the", "rst", "module", "mixed", "modelformulaisparsedandconvertedintotheinputsrequiredtospecifyalinearmixed", "model", "section", "the", "second", "module", "uses", "these", "inputs", "to", "construct", "an", "rfunction", "which", "takes", "the", "covariance", "parameters", "as", "arguments", "and", "returns", "negative", "twice", "the", "log", "pro", "led", "likelihood", "or", "the", "reml", "criterion", "section", "the", "third", "module", "optimizes", "this", "objective", "function", "to", "produce", "maximum", "likelihood", "ml", "or", "reml", "estimates", "of", "section", "finally", "the", "fourth", "module", "provides", "utilities", "for", "interpreting", "the", "optimized", "model", "section", "to", "illustrate", "this", "modularity", "we", "recreate", "the", "fm1object", "by", "series", "of", "four", "modular", "steps", "the", "formula", "module", "parsedformula", "lformula", "formula", "reaction", "days", "days", "subject", "data", "sleepstudy", "the", "objective", "function", "module", "deviancefunction", "do", "call", "mklmerdevfun", "parsedformula", "the", "optimization", "module", "optimizeroutput", "optimizelmer", "deviancefunction", "and", "the", "output", "module", "mkmermod", "rho", "environment", "deviancefunction", "opt", "optimizeroutput", "retrms", "parsedformula", "retrms", "fr", "parsedformula", "fr", "linear", "mixed", "models", "with", "lme4", "formula", "module", "mixed", "model", "formulas", "like", "most", "model", "tting", "functions", "in", "lmertakes", "as", "its", "rst", "two", "arguments", "formulaspec", "ifying", "the", "model", "and", "the", "datawith", "which", "to", "evaluate", "the", "formula", "this", "second", "argument", "data", "is", "optional", "but", "recommended", "and", "is", "usually", "the", "name", "of", "an", "rdata", "frame", "in", "the", "lmfunction", "for", "tting", "linear", "models", "formulas", "take", "the", "form", "resp", "expr", "where", "respdeter", "mines", "the", "response", "variable", "and", "expris", "an", "expression", "that", "speci", "es", "the", "columns", "of", "the", "model", "matrix", "formulas", "for", "the", "lmerfunction", "contain", "special", "random", "ects", "terms", "resp", "feexpr", "reexpr1", "factor1", "reexpr2", "factor2", "where", "feexpris", "an", "expression", "determining", "the", "columns", "of", "the", "xed", "ects", "model", "matrix", "and", "the", "random", "ects", "terms", "reexpr1", "factor1", "and", "reexpr2", "factor2", "determine", "both", "the", "random", "ects", "model", "matrix", "section", "and", "the", "structure", "of", "the", "relative", "co", "variance", "factor", "section", "in", "principle", "mixed", "model", "formula", "may", "contain", "arbitrarily", "many", "random", "ects", "terms", "but", "in", "practice", "the", "number", "of", "such", "terms", "is", "typically", "low", "understanding", "mixed", "model", "formulas", "before", "describing", "the", "details", "of", "how", "lme4parses", "mixed", "model", "formulas", "section", "we", "provide", "an", "informal", "explanation", "and", "then", "some", "examples", "our", "discussion", "assumes", "familiarity", "with", "the", "standard", "rmodeling", "paradigm", "chambers", "1993", "each", "random", "ects", "term", "is", "of", "the", "form", "expr", "factor", "the", "expression", "expris", "evaluated", "as", "linear", "model", "formula", "producing", "model", "matrix", "following", "the", "same", "rules", "used", "in", "standard", "rmodeling", "functions", "lmorglm", "the", "expression", "factoris", "evaluated", "as", "an", "rfactor", "one", "way", "to", "think", "about", "the", "vertical", "bar", "operator", "is", "as", "special", "kind", "of", "interaction", "between", "the", "model", "matrix", "and", "the", "grouping", "factor", "this", "interaction", "ensures", "that", "the", "columns", "of", "the", "model", "matrix", "have", "di", "erent", "ects", "for", "each", "level", "of", "the", "grouping", "factor", "what", "makes", "this", "special", "kind", "of", "interaction", "is", "that", "these", "ects", "are", "modeled", "as", "unobserved", "random", "variables", "rather", "than", "unknown", "xed", "parameters", "much", "has", "been", "written", "about", "important", "practical", "and", "philosophical", "di", "erences", "between", "these", "two", "types", "of", "interactions", "henderson", "jr", "1982", "gelman", "2005", "for", "example", "the", "random", "ects", "implementation", "of", "such", "interactions", "can", "be", "used", "to", "obtain", "shrinkage", "estimates", "of", "regression", "coe", "cients", "efron", "and", "morris", "1977", "or", "account", "for", "lack", "of", "independence", "in", "the", "residuals", "due", "to", "block", "structure", "or", "repeated", "measurements", "laird", "and", "ware", "1982", "table", "provides", "several", "examples", "of", "the", "right", "hand", "sides", "of", "mixed", "model", "formulas", "the", "rst", "example", "is", "the", "simplest", "possible", "mixed", "model", "formula", "where", "each", "level", "of", "the", "grouping", "factor", "has", "its", "own", "random", "intercept", "the", "mean", "and", "standard", "deviation", "of", "these", "intercepts", "are", "parameters", "to", "be", "estimated", "our", "description", "of", "this", "model", "incorporates", "any", "nonzero", "mean", "of", "the", "random", "ects", "as", "xed", "ects", "parameters", "if", "one", "wishes", "to", "specify", "that", "random", "intercept", "has", "priori", "known", "means", "one", "may", "use", "the", "offsetfunction", "as", "in", "the", "second", "model", "in", "table", "this", "model", "contains", "no", "xed", "ects", "or", "more", "accurately", "the", "xed", "ects", "model", "matrix", "has", "zero", "columns", "and", "has", "length", "zero", "wemayalsoconstructmodelswithmultiplegroupingfactors", "forexample", "iftheobservations", "are", "grouped", "by", "g2", "which", "is", "nested", "within", "g1", "then", "the", "third", "formula", "in", "table", "can", "be", "used", "journal", "of", "statistical", "software", "formula", "alternative", "meaning", "random", "intercept", "with", "xed", "mean", "offset", "offset", "random", "intercept", "with", "priori", "means", "g1", "g2", "g1", "g1", "g2", "intercept", "varying", "among", "g1andg2within", "g1", "g1", "g2", "g1", "g2", "intercept", "varying", "among", "g1andg2", "correlated", "random", "intercept", "and", "slope", "uncorrelated", "random", "intercept", "and", "slope", "table", "examples", "of", "the", "right", "hand", "sides", "of", "mixed", "ects", "model", "formulas", "the", "names", "of", "grouping", "factors", "are", "denoted", "g1", "and", "g2", "and", "covariates", "and", "priori", "known", "sets", "as", "ando", "to", "model", "variation", "in", "the", "intercept", "common", "objective", "in", "mixed", "modeling", "is", "to", "account", "for", "such", "nested", "or", "hierarchical", "structure", "however", "one", "of", "the", "most", "useful", "aspects", "of", "lme4", "is", "that", "it", "can", "be", "used", "to", "random", "ects", "associated", "with", "non", "nested", "grouping", "factors", "for", "example", "suppose", "the", "data", "are", "grouped", "by", "fully", "crossing", "two", "factors", "g1and", "g2", "then", "the", "fourth", "formula", "in", "table", "may", "be", "used", "such", "models", "are", "common", "in", "item", "response", "theory", "where", "subject", "anditemfactors", "are", "fully", "crossed", "doran", "bates", "bliese", "and", "dowling", "2007", "in", "addition", "to", "varying", "intercepts", "we", "may", "also", "have", "varying", "slopes", "the", "sleepstudy", "data", "section", "the", "fth", "example", "in", "table", "gives", "model", "where", "both", "the", "intercept", "and", "slope", "vary", "among", "the", "levels", "of", "the", "grouping", "factor", "specifying", "uncorrelated", "random", "ects", "by", "default", "lme4assumes", "that", "all", "coe", "cients", "associated", "with", "the", "same", "random", "ects", "term", "are", "correlated", "to", "specify", "an", "uncorrelated", "slope", "and", "intercept", "for", "example", "one", "may", "either", "use", "double", "bar", "notation", "or", "equivalently", "use", "multiple", "random", "ects", "terms", "as", "in", "the", "nal", "example", "of", "table", "for", "example", "if", "one", "examined", "the", "results", "of", "model", "fm1of", "the", "sleepstudy", "data", "section", "using", "summary", "fm1", "one", "would", "see", "thattheestimatedcorrelationbetweentheslopefor", "daysandtheinterceptisfairlylow", "066", "see", "section", "below", "for", "more", "on", "how", "to", "extract", "the", "random", "ects", "covariance", "matrix", "we", "may", "use", "double", "bar", "notation", "to", "model", "that", "excludes", "correlation", "parameter", "fm2", "lmer", "reaction", "days", "days", "subject", "sleepstudy", "although", "mixed", "models", "where", "the", "random", "slopes", "and", "intercepts", "are", "assumed", "independent", "are", "commonly", "used", "to", "reduce", "the", "complexity", "of", "random", "slopes", "models", "they", "do", "have", "one", "subtle", "drawback", "models", "in", "which", "the", "slopes", "and", "intercepts", "are", "allowed", "to", "have", "nonzero", "correlation", "fm1", "are", "invariant", "to", "additive", "shifts", "of", "the", "continuous", "predictor", "daysin", "this", "case", "this", "invariance", "breaks", "down", "when", "the", "correlation", "is", "constrained", "to", "zero", "any", "shift", "in", "the", "predictor", "will", "necessarily", "lead", "to", "change", "in", "the", "estimated", "correlation", "and", "in", "the", "likelihood", "and", "predictions", "of", "the", "model", "for", "example", "we", "can", "eliminate", "the", "correlation", "in", "linear", "mixed", "models", "with", "lme4", "symbol", "size", "length", "of", "the", "response", "vector", "number", "of", "columns", "of", "the", "xed", "ects", "model", "matrix", "summationtextk", "iqinumber", "of", "columns", "of", "the", "random", "ects", "model", "matrix", "pi", "number", "of", "columns", "of", "the", "raw", "model", "matrix", "xi", "lscripti", "number", "of", "levels", "of", "the", "grouping", "factor", "indices", "ii", "qi", "pi", "lscriptinumber", "of", "columns", "of", "the", "term", "wise", "model", "matrix", "zi", "number", "of", "random", "ects", "terms", "mi", "parenleftbigpi", "parenrightbignumber", "of", "covariance", "parameters", "for", "term", "summationtextk", "imitotal", "number", "of", "covariance", "parameters", "table", "dimensions", "of", "linear", "mixed", "models", "the", "subscript", "kdenotes", "speci", "random", "ects", "term", "symbol", "size", "description", "xin", "piraw", "random", "ects", "model", "matrix", "jin", "lscriptiindicator", "matrix", "of", "grouping", "factor", "indices", "xijpi", "1column", "vector", "containing", "jth", "row", "ofxi", "jij", "lscripti", "1column", "vector", "containing", "jth", "row", "ofji", "iin", "vector", "of", "grouping", "factor", "indices", "zin", "qiterm", "wise", "random", "ects", "model", "matrix", "covariance", "parameters", "tipi", "pilower", "triangular", "template", "matrix", "iqi", "qiterm", "wise", "relative", "covariance", "factor", "table", "symbols", "used", "to", "describe", "the", "structure", "of", "the", "random", "ects", "model", "matrix", "and", "the", "relative", "covariance", "factor", "the", "subscript", "kdenotes", "speci", "random", "ects", "term", "fm1simply", "by", "adding", "an", "amount", "equal", "to", "the", "ratio", "of", "the", "estimated", "among", "subject", "standard", "deviations", "multiplied", "by", "the", "estimated", "correlation", "slope", "intercept", "slope", "intercept", "to", "thedaysvariable", "the", "use", "of", "models", "such", "as", "fm2should", "ideally", "be", "restricted", "to", "cases", "where", "the", "predictor", "is", "measured", "on", "ratio", "scale", "the", "zero", "point", "on", "the", "scale", "is", "meaningful", "not", "just", "location", "de", "ned", "by", "convenience", "or", "convention", "as", "is", "the", "case", "here", "algebraic", "and", "computational", "account", "of", "mixed", "model", "formulas", "the", "xed", "ectstermsofamixed", "modelformulaareparsedtoproducethe", "xed", "ectsmodel", "matrix", "in", "the", "same", "way", "that", "the", "rlmfunction", "generates", "model", "matrices", "however", "mixed", "model", "formula", "incorporates", "1random", "ects", "terms", "of", "the", "form", "as", "well", "thesekterms", "are", "used", "to", "produce", "the", "random", "ects", "model", "matrix", "equation", "and", "the", "structure", "of", "the", "relative", "covariance", "factor", "equation", "which", "are", "matrices", "that", "typically", "have", "sparse", "structure", "we", "now", "describe", "how", "one", "might", "construct", "these", "matrices", "from", "the", "random", "ects", "terms", "considering", "rst", "single", "term", "and", "then", "generalizing", "to", "multiple", "terms", "tables", "and", "summarize", "the", "matrices", "and", "vectors", "that", "determine", "the", "structure", "ofzand", "the", "expression", "is", "linear", "model", "formula", "that", "evaluates", "to", "an", "rmodel", "matrix", "xi", "of", "sizen", "pi", "called", "the", "raw", "random", "ects", "model", "matrix", "for", "termi", "term", "is", "said", "to", "be", "journal", "of", "statistical", "software", "scalarrandom", "ects", "term", "when", "pi", "otherwise", "it", "is", "vector", "valued", "for", "asimple", "scalar", "random", "ects", "term", "of", "the", "form", "xiis", "then", "1matrix", "of", "ones", "which", "implies", "random", "intercept", "model", "the", "expression", "fevaluates", "to", "an", "rfactor", "called", "the", "grouping", "factor", "for", "the", "term", "for", "the", "ith", "term", "we", "represent", "this", "factor", "mathematically", "with", "vector", "iioffactor", "indices", "which", "is", "ann", "vector", "of", "values", "from", "lscripti", "1letjibe", "then", "lscriptimatrix", "of", "indicator", "columns", "for", "ii", "using", "the", "matrixpackage", "bates", "and", "maechler", "2015", "in", "we", "may", "construct", "the", "transpose", "ofjifrom", "factor", "vector", "by", "coercing", "fto", "sparsematrix", "object", "for", "example", "gl", "levels", "ji", "as", "class", "sparsematrix", "sparse", "matrix", "of", "class", "dgcmatrix", "whenk", "1we", "order", "the", "random", "ects", "terms", "so", "that", "lscript1", "lscript2", "lscriptk", "in", "general", "this", "ordering", "reduces", "ll", "in", "the", "proportion", "of", "elements", "that", "are", "zero", "in", "the", "lower", "triangle", "of", "latticetop", "latticetopwz", "ibut", "not", "in", "the", "lower", "triangle", "of", "its", "left", "cholesky", "factor", "described", "below", "in", "equation", "18", "this", "reduction", "in", "ll", "in", "provides", "more", "cient", "matrix", "operations", "within", "the", "penalized", "least", "squares", "algorithm", "section", "constructing", "the", "random", "ects", "model", "matrix", "theith", "random", "ects", "term", "contributes", "qi", "lscriptipicolumns", "to", "the", "model", "matrix", "we", "group", "these", "columns", "into", "matrix", "zi", "which", "we", "refer", "to", "as", "the", "term", "wise", "model", "matrix", "for", "theith", "term", "thus", "the", "number", "of", "columns", "in", "zand", "the", "dimension", "of", "the", "random", "variable", "is", "summationdisplay", "1qi", "summationdisplay", "lscriptipi", "creating", "the", "matrix", "zifromxiandjiis", "straightforward", "concept", "that", "is", "nonetheless", "somewhat", "awkward", "to", "describe", "consider", "zias", "being", "further", "decomposed", "into", "lscriptiblocks", "of", "picolumns", "the", "rows", "in", "the", "rst", "block", "are", "the", "rows", "of", "ximultiplied", "by", "the", "values", "in", "1in", "practice", "xed", "ects", "model", "matrices", "and", "random", "ects", "terms", "are", "evaluated", "with", "respect", "to", "model", "frame", "ensuring", "that", "any", "expressions", "for", "grouping", "factors", "have", "been", "coerced", "to", "factors", "and", "any", "unused", "levels", "of", "these", "factors", "have", "been", "dropped", "that", "is", "lscripti", "the", "number", "of", "levels", "in", "the", "grouping", "factor", "for", "the", "ith", "random", "ects", "term", "is", "well", "de", "ned", "10", "linear", "mixed", "models", "with", "lme4", "the", "rst", "column", "of", "jiand", "similarly", "for", "the", "subsequent", "blocks", "with", "these", "de", "nitions", "we", "may", "de", "ne", "the", "term", "wise", "random", "ects", "model", "matrix", "zi", "for", "theith", "term", "as", "transposed", "khatri", "rao", "product", "zi", "latticetop", "latticetop", "latticetop", "latticetop", "i1", "latticetop", "i1", "latticetop", "i2", "latticetop", "i2", "latticetop", "in", "latticetop", "in", "where", "and", "are", "the", "khatri", "rao2", "khatri", "and", "rao", "1968", "and", "kronecker", "products", "and", "latticetop", "ij", "andx", "latticetop", "ijare", "row", "vectors", "of", "the", "jth", "rows", "ofjiandxi", "these", "rows", "correspond", "to", "the", "jth", "sample", "in", "the", "response", "vector", "and", "thusjruns", "from", "thematrixpackage", "for", "contains", "khatrirao", "function", "which", "can", "be", "used", "to", "form", "zi", "for", "example", "if", "we", "begin", "with", "raw", "model", "matrix", "xi", "cbind", "rep", "int", "3l", "then", "the", "term", "wise", "random", "ects", "model", "matrix", "is", "zi", "khatrirao", "ji", "xi", "sparse", "matrix", "of", "class", "dgcmatrix", "in", "particular", "for", "simple", "scalar", "term", "ziis", "exactlyji", "the", "matrix", "of", "indicator", "columns", "for", "other", "scalar", "terms", "ziis", "formed", "by", "element", "wise", "multiplication", "of", "the", "single", "column", "of", "xiby", "each", "of", "the", "columns", "of", "ji", "because", "each", "ziis", "generated", "from", "indicator", "columns", "its", "cross", "product", "latticetop", "iziis", "block", "diagonal", "consisting", "of", "lscriptidiagonal", "blocks", "each", "of", "size", "pi", "3note", "that", "this", "means", "that", "when", "2note", "that", "the", "original", "de", "nition", "of", "the", "khatri", "rao", "product", "is", "more", "general", "than", "the", "de", "nition", "used", "in", "the", "matrixpackage", "which", "is", "the", "de", "nition", "we", "use", "here", "3to", "see", "this", "note", "that", "by", "the", "properties", "of", "kronecker", "products", "we", "may", "write", "the", "cross", "product", "matrix", "latticetop", "izias", "summationtextn", "1jijj", "latticetop", "ij", "xijx", "latticetop", "ij", "becausejijis", "unit", "vector", "along", "coordinate", "axis", "the", "cross", "product", "jijj", "latticetop", "ij", "is", "api", "pimatrix", "of", "all", "zeros", "except", "for", "single", "1along", "the", "diagonal", "therefore", "the", "cross", "products", "xijx", "latticetop", "ij", "will", "be", "added", "to", "one", "of", "the", "lscriptiblocks", "of", "size", "pi", "pialong", "the", "diagonal", "of", "latticetop", "izi", "journal", "of", "statistical", "software", "11", "there", "is", "only", "one", "random", "ects", "term", "and", "zi", "latticetopzwill", "be", "block", "diag", "onal", "these", "block", "diagonal", "properties", "allow", "for", "more", "cient", "sparse", "matrix", "computations", "section", "the", "full", "random", "ects", "model", "matrix", "is", "constructed", "from", "1blocks", "bracketleftbig", "z1z2", "zk", "bracketrightbig", "by", "transposing", "equation", "and", "substituting", "in", "equation", "we", "may", "represent", "the", "structure", "of", "the", "transposed", "random", "ects", "model", "matrix", "as", "follows", "latticetop", "sample", "sample", "samplen", "j11", "x11j12", "x12", "j1n", "x1nterm", "j21", "x21j22", "x22", "j2n", "x2nterm", "note", "that", "the", "proportion", "of", "elements", "of", "latticetopthat", "are", "structural", "zeros", "is", "summationtextk", "1pi", "lscripti", "summationtextk", "1pi", "therefore", "the", "sparsity", "of", "latticetopincreases", "with", "the", "number", "of", "grouping", "factor", "levels", "as", "the", "number", "of", "levels", "is", "often", "large", "in", "practice", "it", "is", "essential", "for", "speed", "and", "ciency", "to", "take", "account", "of", "this", "sparsity", "for", "example", "by", "using", "sparse", "matrix", "methods", "when", "tting", "mixed", "models", "section", "constructing", "the", "relative", "covariance", "factor", "theq", "qcovariance", "factor", "is", "block", "diagonal", "matrix", "whose", "ith", "diagonal", "block", "is", "of", "sizeqi", "we", "refer", "to", "ias", "theterm", "wise", "relative", "covariance", "factor", "furthermore", "iis", "homogeneous", "block", "diagonal", "matrix", "with", "each", "of", "the", "lscriptilower", "triangular", "blocks", "on", "the", "diagonal", "being", "copy", "of", "pi", "pilower", "triangular", "template", "matrix", "ti", "the", "covariance", "parameter", "vector", "of", "length", "mi", "parenleftbigpi", "parenrightbig", "consists", "of", "the", "elements", "in", "the", "lower", "triangle", "of", "ti", "to", "provide", "unique", "representation", "we", "require", "that", "the", "diagonal", "elements", "of", "theti", "kbe", "non", "negative", "the", "template", "ti", "can", "be", "constructed", "from", "the", "number", "pialone", "in", "rcode", "we", "denote", "pias", "nc", "for", "example", "if", "we", "set", "nc", "we", "could", "create", "the", "template", "for", "term", "ias", "rowindices", "rep", "nc", "nc", "colindices", "sequence", "nc", "template", "sparsematrix", "rowindices", "colindices", "rowindices", "colindices", "12", "linear", "mixed", "models", "with", "lme4", "sparse", "matrix", "of", "class", "dgcmatrix", "note", "that", "the", "rowindices", "andcolindices", "ll", "the", "entire", "lower", "triangle", "which", "contains", "the", "initial", "values", "of", "the", "covariance", "parameter", "vector", "theta", "template", "because", "the", "xslot", "of", "the", "sparse", "matrix", "template", "is", "numeric", "vector", "containing", "the", "nonzero", "elements", "thistemplatecontainsthreetypesofelements", "structuralzeros", "denotedby", "diagonalcovarianceparameters", "initializedat", "anddiagonalvarianceparameters", "initialized", "at1", "the", "next", "step", "in", "the", "construction", "of", "the", "relative", "covariance", "factor", "is", "to", "repeat", "the", "template", "once", "for", "each", "level", "of", "the", "grouping", "factor", "to", "construct", "sparse", "block", "diagonal", "matrix", "for", "example", "if", "we", "set", "the", "number", "of", "levels", "lscripti", "to", "two", "nl", "we", "could", "create", "the", "transposed", "term", "wise", "relative", "covariance", "factor", "latticetop", "using", "the", "bdiagfunction", "in", "the", "matrix", "package", "lambdati", "bdiag", "rep", "list", "template", "nl", "sparse", "matrix", "of", "class", "dgtmatrix", "for", "model", "with", "single", "random", "ects", "term", "latticetopwould", "be", "the", "initial", "transposed", "relative", "covariance", "factor", "latticetop", "itself", "the", "transposed", "relative", "covariance", "factor", "latticetop", "that", "arises", "from", "parsing", "the", "formula", "and", "data", "is", "set", "at", "the", "initial", "value", "of", "the", "covariance", "parameters", "however", "during", "model", "tting", "it", "needs", "to", "be", "updated", "to", "new", "value", "at", "each", "iteration", "this", "is", "achieved", "by", "constructing", "vector", "of", "indices", "lind", "that", "identi", "es", "which", "elements", "of", "thetashould", "be", "placed", "in", "which", "elements", "of", "lambdat", "lindtemplate", "rowindices", "nc", "colindices", "choose", "colindices", "lind", "rep", "lindtemplate", "nl", "for", "example", "if", "we", "randomly", "generate", "new", "value", "for", "theta", "journal", "of", "statistical", "software", "13", "thetanew", "round", "runif", "length", "theta", "we", "may", "update", "lambdat", "as", "follows", "lambdati", "thetanew", "lind", "section", "describes", "the", "process", "of", "updating", "the", "relative", "covariance", "factor", "in", "more", "detail", "objective", "function", "module", "model", "reformulation", "for", "improved", "computational", "stability", "in", "our", "initial", "formulation", "of", "the", "linear", "mixed", "model", "equations", "and", "the", "covari", "ance", "parameter", "vector", "appears", "only", "in", "the", "marginal", "distribution", "of", "the", "random", "ects", "equation", "however", "from", "the", "perspective", "of", "computational", "stability", "and", "ciency", "it", "is", "advantageous", "to", "reformulate", "the", "model", "such", "that", "appears", "only", "in", "the", "conditional", "distribu", "tion", "for", "the", "response", "vector", "given", "the", "random", "ects", "such", "reformulation", "allows", "us", "to", "work", "with", "singular", "covariance", "matrices", "which", "regularly", "arise", "in", "practice", "during", "intermediate", "steps", "of", "the", "nonlinear", "optimizer", "section", "the", "reformulation", "is", "made", "by", "de", "ning", "spherical4random", "ects", "variable", "with", "distribu", "tion", "2iq", "10", "if", "we", "set", "11", "thenbwill", "have", "the", "desired", "distribution", "equation", "although", "it", "may", "seem", "more", "natural", "to", "de", "ne", "uin", "terms", "ofbwe", "must", "write", "the", "relationship", "as", "in", "equation", "11", "to", "allow", "for", "singular", "the", "conditional", "distribution", "equation", "of", "the", "response", "vector", "given", "the", "random", "ects", "may", "now", "be", "reformulated", "as", "2w", "12", "where", "13", "is", "vector", "of", "linear", "predictors", "which", "can", "be", "interpreted", "as", "conditional", "mean", "or", "mode", "similarly", "we", "also", "de", "ne", "yobsas", "the", "conditional", "mean", "or", "mode", "of", "the", "spherical", "random", "ects", "given", "the", "observed", "value", "of", "the", "response", "vector", "note", "also", "that", "we", "use", "the", "usymbol", "throughout", "to", "represent", "speci", "value", "of", "the", "random", "variable", "penalized", "least", "squares", "our", "computational", "methods", "for", "maximum", "likelihood", "tting", "of", "the", "linear", "mixed", "model", "involve", "repeated", "applications", "of", "the", "pls", "method", "in", "particular", "the", "pls", "problem", "is", "to", "minimize", "the", "penalized", "weighted", "residual", "sum", "of", "squares", "r2", "bardblu", "bardbl2", "14", "4n", "2i", "distributions", "are", "called", "spherical", "because", "contours", "of", "the", "probability", "density", "are", "spheres", "14", "linear", "mixed", "models", "with", "lme4", "over", "bracketleftbigg", "bracketrightbigg", "where", "vextenddouble", "vextenddouble", "vextenddoublew1", "bracketleftbig", "yobs", "bracketrightbig", "vextenddouble", "vextenddouble", "vextenddouble2", "15", "is", "the", "weighted", "residual", "sum", "of", "squares", "this", "notation", "makes", "explicit", "the", "fact", "that", "r2and", "both", "depend", "on", "andu", "the", "reason", "for", "the", "word", "penalized", "is", "that", "the", "term", "bardblu", "bardbl2", "in", "equation", "14", "penalizes", "models", "with", "larger", "magnitude", "values", "of", "in", "the", "so", "called", "pseudo", "data", "approach", "we", "write", "the", "penalized", "weighted", "residual", "sum", "of", "squares", "as", "the", "squared", "length", "of", "block", "matrix", "equation", "r2", "vextenddouble", "vextenddouble", "vextenddouble", "vextenddouble", "vextenddouble", "bracketleftbigg", "w1", "yobs", "bracketrightbigg", "bracketleftbigg", "w1", "2z", "w1", "2x", "iq", "bracketrightbigg", "bracketleftbigg", "bracketrightbigg", "vextenddouble", "vextenddouble", "vextenddouble", "vextenddouble", "vextenddouble2", "16", "this", "pseudo", "data", "approach", "shows", "that", "the", "pls", "problem", "may", "also", "be", "thought", "of", "as", "standard", "least", "squares", "problem", "for", "an", "extended", "response", "vector", "which", "implies", "that", "the", "minimizing", "value", "bracketleftbigg", "yobs", "hatwide", "bracketrightbigg", "satis", "es", "the", "normal", "equations", "bracketleftbigg", "latticetop", "latticetopw", "yobs", "latticetopw", "yobs", "bracketrightbigg", "bracketleftbigg", "latticetop", "latticetopwz", "latticetop", "latticetopwx", "latticetopwz", "latticetopwx", "bracketrightbigg", "bracketleftbigg", "yobs", "hatwide", "bracketrightbigg", "17", "where", "yobsis", "the", "conditional", "mean", "of", "ugiven", "thaty", "yobs", "note", "that", "this", "conditional", "mean", "depends", "on", "although", "we", "do", "not", "make", "this", "dependency", "explicit", "in", "order", "to", "reduce", "notational", "clutter", "the", "cross", "product", "matrix", "in", "equation", "17", "can", "be", "cholesky", "decomposed", "bracketleftbigg", "latticetop", "latticetopwz", "latticetop", "latticetopwx", "latticetopwz", "latticetopwx", "bracketrightbigg", "bracketleftbigg", "latticetop", "zxr", "latticetop", "bracketrightbigg", "bracketleftbigg", "latticetop", "rzx", "0rx", "bracketrightbigg", "18", "we", "may", "use", "this", "decomposition", "to", "rewrite", "the", "penalized", "weighted", "residual", "sum", "of", "squares", "as", "r2", "r2", "vextenddouble", "vextenddouble", "vextenddoublel", "latticetop", "yobs", "rzx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "vextenddouble", "vextenddouble", "vextenddoublerx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "19", "where", "we", "have", "simpli", "ed", "notation", "by", "writing", "r2", "hatwide", "yobs", "asr2", "this", "is", "an", "im", "portant", "expression", "in", "the", "theory", "underlying", "lme4", "it", "relates", "the", "penalized", "weighted", "residual", "sum", "of", "squares", "r2", "with", "its", "minimum", "value", "r2", "this", "relationship", "is", "useful", "in", "the", "next", "section", "where", "we", "integrate", "over", "the", "random", "ects", "which", "is", "required", "for", "maximum", "likelihood", "estimation", "probability", "densities", "the", "residual", "sums", "of", "squares", "discussed", "in", "the", "previous", "section", "can", "be", "used", "to", "express", "various", "probability", "densities", "which", "are", "required", "for", "maximum", "likelihood", "estimation", "of", "the", "linear", "journal", "of", "statistical", "software", "15", "mixed", "model5", "fy", "yobs", "2exp", "bracketleftbigg", "bracketrightbigg", "20", "fu", "2exp", "bracketleftbigg", "bardblu", "bardbl2", "bracketrightbigg", "21", "fy", "yobs", "2exp", "bracketleftbigg", "r2", "bracketrightbigg", "22", "fu", "yobs", "fy", "yobs", "fy", "yobs", "23", "where", "fy", "yobs", "integraldisplay", "fy", "yobs", "du", "24", "the", "log", "likelihood", "to", "be", "maximized", "can", "therefore", "be", "expressed", "as", "yobs", "logfy", "yobs", "25", "the", "integral", "in", "equation", "24", "may", "be", "more", "explicitly", "written", "as", "fy", "yobs", "2exp", "r2", "vextenddouble", "vextenddouble", "vextenddoublerx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "integraldisplay", "exp", "vextenddouble", "vextenddouble", "vextenddoublel", "latticetop", "yobs", "rzx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "du", "26", "which", "can", "be", "evaluated", "with", "the", "change", "of", "variables", "latticetop", "yobs", "rzx", "hatwide", "27", "the", "jacobian", "determinant", "of", "the", "transformation", "from", "utovis", "therefore", "we", "are", "able", "to", "write", "the", "integral", "as", "fy", "yobs", "2exp", "r2", "vextenddouble", "vextenddouble", "vextenddoublerx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "integraldisplay", "exp", "bracketleftbigg", "bardblv", "bardbl2", "bracketrightbigg", "1dv", "28", "which", "by", "the", "properties", "of", "exponential", "integrands", "becomes", "expl", "yobs", "fy", "yobs", "2exp", "r2", "vextenddouble", "vextenddouble", "vextenddoublerx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "29", "5these", "expressions", "only", "technically", "hold", "at", "the", "observed", "value", "yobs", "of", "the", "response", "vector", "16", "linear", "mixed", "models", "with", "lme4", "evaluating", "and", "pro", "ling", "the", "deviance", "and", "the", "reml", "criterion", "we", "are", "now", "in", "position", "to", "understand", "why", "the", "formulation", "in", "equations", "and", "is", "particu", "larlyuseful", "weareabletoexplicitlypro", "le", "and", "outofthelog", "likelihood", "equation25", "to", "nd", "compact", "expression", "for", "the", "pro", "led", "deviance", "negative", "twice", "the", "pro", "led", "log", "likelihood", "and", "the", "pro", "led", "reml", "criterion", "as", "function", "of", "the", "relative", "covariance", "parameters", "only", "furthermore", "these", "criteria", "can", "be", "evaluated", "quickly", "and", "accurately", "to", "estimate", "the", "parameters", "and", "we", "minimize", "negative", "twice", "the", "log", "likelihood", "which", "can", "be", "written", "as", "2l", "yobs", "log", "nlog", "r2", "vextenddouble", "vextenddouble", "vextenddoublerx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "30", "it", "is", "very", "easy", "to", "pro", "le", "out", "because", "it", "enters", "into", "the", "ml", "criterion", "only", "through", "the", "nal", "term", "which", "is", "zero", "if", "hatwide", "where", "hatwide", "is", "found", "by", "solving", "the", "penalized", "least", "squares", "problem", "in", "equation", "16", "therefore", "we", "can", "write", "partially", "pro", "led", "ml", "criterion", "as", "2l", "yobs", "log", "nlog", "r2", "31", "this", "criterion", "is", "only", "partially", "pro", "led", "because", "it", "still", "depends", "on", "di", "erentiating", "this", "criterion", "with", "respect", "to", "2and", "setting", "the", "result", "equal", "to", "zero", "yields", "hatwide", "r2", "hatwide", "32", "which", "leads", "to", "maximum", "pro", "led", "likelihood", "estimate", "hatwide", "r2", "33", "this", "estimate", "can", "be", "substituted", "into", "the", "partially", "pro", "led", "criterion", "to", "yield", "the", "fully", "pro", "led", "ml", "criterion", "2l", "yobs", "log", "bracketleftbigg", "log", "parenleftbigg", "r2", "parenrightbigg", "bracketrightbigg", "34", "this", "expression", "for", "the", "pro", "led", "deviance", "depends", "only", "on", "although", "the", "number", "of", "columns", "inzand", "the", "size", "of", "can", "be", "very", "large", "indeed", "the", "dimension", "of", "is", "small", "frequently", "less", "than", "10", "the", "lme4package", "uses", "generic", "nonlinear", "optimizers", "section", "to", "optimize", "this", "expression", "over", "to", "nd", "its", "maximum", "likelihood", "estimate", "the", "reml", "criterion", "the", "reml", "criterion", "can", "be", "obtained", "by", "integrating", "the", "marginal", "density", "for", "ywith", "respect", "to", "the", "xed", "ects", "laird", "and", "ware", "1982", "integraldisplay", "fy", "yobs", "2exp", "bracketleftbigg", "r2", "bracketrightbigg", "integraldisplay", "exp", "vextenddouble", "vextenddouble", "vextenddoublerx", "hatwide", "vextenddouble", "vextenddouble", "vextenddouble2", "35", "journal", "of", "statistical", "software", "17", "which", "can", "be", "evaluated", "with", "the", "change", "of", "variables", "rx", "hatwide", "36", "the", "jacobian", "determinant", "of", "the", "transformation", "from", "tovis", "rx", "therefore", "we", "are", "able", "to", "write", "the", "integral", "as", "integraldisplay", "fy", "yobs", "2exp", "bracketleftbigg", "r2", "bracketrightbigg", "integraldisplay", "exp", "bracketleftbigg", "bardblv", "bardbl2", "bracketrightbigg", "rx", "1dv", "37", "which", "simpli", "es", "to", "integraldisplay", "fy", "yobs", "rx", "2exp", "bracketleftbigg", "r2", "bracketrightbigg", "38", "minus", "twice", "the", "log", "of", "this", "integral", "is", "the", "unpro", "led", "reml", "criterion", "2lr", "yobs", "log", "rx", "log", "r2", "39", "note", "that", "because", "gets", "integrated", "out", "the", "reml", "criterion", "cannot", "be", "used", "to", "nd", "point", "estimate", "of", "however", "we", "follow", "others", "in", "using", "the", "maximum", "likelihood", "estimate", "hatwide", "hatwide", "at", "the", "optimum", "value", "of", "hatwide", "the", "reml", "estimate", "of", "2is", "hatwide", "r2", "40", "which", "leads", "to", "the", "pro", "led", "reml", "criterion", "2lr", "yobs", "log", "rx", "bracketleftbigg", "log", "parenleftbigg", "r2", "parenrightbigg", "bracketrightbigg", "41", "changes", "relative", "to", "previous", "formulations", "we", "compare", "the", "pls", "problem", "as", "formulated", "in", "section", "with", "earlier", "versions", "and", "describe", "why", "we", "use", "this", "version", "what", "have", "become", "known", "as", "henderson", "mixed", "model", "equations", "are", "given", "as", "equation", "of", "henderson", "jr", "1982", "and", "would", "be", "expressed", "as", "bracketleftbigg", "latticetopx", "2x", "latticetopz", "latticetopx", "2z", "latticetopz", "bracketrightbigg", "bracketleftbigg", "hatwide", "yobs", "bracketrightbigg", "bracketleftbigg", "latticetopyobs", "latticetopyobs", "bracketrightbigg", "42", "in", "our", "notation", "ignoring", "weights", "and", "sets", "without", "loss", "of", "generality", "the", "matrix", "written", "asrin", "henderson", "jr", "1982", "is", "2inin", "our", "formulation", "of", "the", "model", "bates", "and", "debroy", "2004", "modi", "ed", "the", "pls", "equations", "to", "bracketleftbigg", "latticetopz", "latticetopx", "latticetopz", "latticetopx", "bracketrightbigg", "bracketleftbigg", "yobs", "hatwide", "bracketrightbigg", "bracketleftbigg", "latticetopyobs", "latticetopyobs", "bracketrightbigg", "43", "18", "linear", "mixed", "models", "with", "lme4", "where", "parenleftbig", "latticetop", "parenrightbig", "1is", "therelative", "precision", "matrix", "for", "given", "value", "of", "they", "also", "showed", "that", "the", "pro", "led", "log", "likelihood", "can", "be", "expressed", "on", "the", "deviance", "scale", "as", "2l", "log", "parenleftbigg", "latticetopz", "parenrightbigg", "bracketleftbigg", "log", "parenleftbigg", "r2", "parenrightbigg", "bracketrightbigg", "44", "the", "primary", "di", "erence", "between", "equation", "42", "and", "equation", "43", "is", "the", "order", "of", "the", "blocks", "in", "the", "system", "matrix", "the", "pls", "problem", "can", "be", "solved", "using", "cholesky", "factor", "of", "the", "system", "matrix", "with", "the", "blocks", "in", "either", "order", "the", "advantage", "of", "using", "the", "arrangement", "in", "equation", "43", "is", "to", "allow", "for", "evaluation", "of", "the", "pro", "led", "log", "likelihood", "to", "evaluate", "latticetopz", "from", "the", "cholesky", "factor", "that", "block", "must", "be", "in", "the", "upper", "left", "corner", "not", "the", "lower", "right", "also", "zis", "sparse", "whereas", "xis", "usually", "dense", "it", "is", "straightforward", "to", "exploit", "the", "sparsity", "of", "latticetopzin", "the", "cholesky", "factorization", "when", "the", "block", "containing", "this", "matrix", "is", "the", "rst", "block", "to", "be", "factored", "ifx", "latticetopxis", "the", "rst", "block", "to", "be", "factored", "it", "is", "much", "more", "di", "cult", "to", "preserve", "sparsity", "themainchangefromtheformulationinbatesanddebroy", "2004", "tothecurrentformulation", "is", "the", "use", "of", "relative", "covariance", "factor", "instead", "of", "relative", "precision", "matrix", "and", "solving", "for", "the", "mean", "of", "yobsinstead", "of", "the", "mean", "of", "yobs", "this", "change", "improves", "stability", "because", "the", "solution", "to", "the", "pls", "problem", "in", "section", "is", "well", "de", "ned", "when", "is", "singular", "whereas", "the", "formulation", "in", "equation", "43", "cannot", "be", "used", "in", "these", "cases", "because", "does", "not", "exist", "it", "is", "important", "to", "allow", "for", "to", "be", "singular", "because", "situations", "where", "the", "parameter", "esti", "mates", "hatwide", "produce", "singular", "hatwide", "do", "occur", "in", "practice", "and", "even", "if", "the", "parameter", "estimates", "do", "not", "correspond", "to", "singular", "it", "may", "be", "desirable", "to", "evaluate", "the", "estimation", "criterion", "at", "such", "values", "during", "the", "course", "of", "the", "numerical", "optimization", "of", "the", "criterion", "bates", "and", "debroy", "2004", "also", "provided", "expressions", "for", "the", "gradient", "of", "the", "pro", "led", "log", "likelihood", "expressed", "as", "equation", "44", "these", "expressions", "can", "be", "translated", "into", "the", "current", "formulation", "from", "equation", "34", "we", "can", "see", "that", "again", "ignoring", "weights", "2l", "log", "parenleftbig", "nlog", "r2", "parenrightbig", "log", "latticetop", "latticetopz", "parenleftbig", "r2", "parenrightbig", "r2", "log", "latticetop", "latticetopz", "parenleftbig", "r2", "parenrightbig", "hatwider", "45", "the", "rst", "gradient", "is", "easy", "to", "express", "but", "di", "cult", "to", "evaluate", "for", "the", "general", "model", "the", "individual", "elements", "of", "this", "gradient", "are", "log", "latticetop", "latticetopz", "tr", "parenleftbig", "latticetop", "latticetopz", "parenrightbig", "parenleftbig", "latticetop", "latticetopz", "parenrightbig", "tr", "bracketleftbigg", "parenleftbig", "latticetop", "parenrightbig", "parenleftbigg", "latticetop", "latticetopz", "latticetop", "iz", "latticetopz", "parenrightbigg", "bracketrightbigg", "46", "the", "second", "gradient", "term", "can", "be", "expressed", "as", "linear", "function", "of", "the", "residual", "with", "individual", "elements", "of", "the", "form", "r2", "2u", "latticetop", "latticetop", "iz", "latticetop", "parenleftbig", "hatwide", "parenrightbig", "47", "journal", "of", "statistical", "software", "19", "name", "description", "pseudocode", "math", "type", "mapping", "from", "covariance", "parameters", "to", "relative", "covariance", "factormapping", "function", "response", "vector", "yobs", "section", "double", "vector", "fixed", "ects", "model", "matrix", "equation", "double", "denseamatrix", "transposed", "random", "ects", "model", "matrixzt", "latticetop", "equation", "double", "sparse", "matrix", "square", "root", "weights", "matrix", "sqrtw", "w1", "equation", "double", "diagonal", "matrix", "set", "offset", "equation", "double", "vector", "ain", "previous", "versions", "of", "lme4a", "sparsexmatrix", "useful", "for", "models", "with", "categorical", "xed", "ect", "predictors", "with", "many", "levels", "could", "be", "speci", "ed", "this", "feature", "is", "not", "currently", "available", "table", "inputs", "into", "linear", "mixed", "model", "using", "the", "results", "of", "golub", "and", "pereyra", "1973", "although", "we", "do", "not", "use", "these", "results", "in", "lme4", "they", "are", "used", "for", "certain", "model", "types", "in", "the", "mixedmodels", "package", "for", "juliaand", "do", "provide", "improved", "performance", "penalized", "least", "squares", "algorithm", "for", "ciency", "in", "lme4itself", "pls", "is", "implemented", "in", "compiled", "code", "using", "the", "eigen", "guennebaud", "jacob", "and", "and", "others", "2015", "templated", "package", "for", "numerical", "linear", "algebra", "here", "however", "in", "order", "to", "improve", "readability", "we", "describe", "version", "in", "pure", "section3", "7providesgreaterdetailonthetechniquesandconceptsforcomputationale", "ciency", "whichisimportantincaseswherethenonlinearoptimizer", "section4", "requiresmanyiterations", "the", "pls", "algorithm", "takes", "vector", "of", "covariance", "parameters", "as", "inputs", "and", "returns", "the", "pro", "led", "deviance", "equation", "34", "or", "the", "reml", "criterion", "equation", "41", "this", "pls", "algorithm", "consists", "of", "four", "main", "steps", "update", "the", "relative", "covariance", "factor", "solve", "the", "normal", "equations", "update", "the", "linear", "predictor", "and", "residuals", "compute", "and", "return", "the", "pro", "led", "deviance", "pls", "also", "requires", "the", "objects", "described", "in", "table", "which", "de", "ne", "the", "structure", "of", "the", "model", "these", "objects", "do", "not", "get", "updated", "during", "the", "pls", "iterations", "and", "so", "it", "is", "useful", "to", "store", "various", "matrix", "products", "involving", "them", "table", "table", "lists", "the", "objects", "that", "do", "get", "updated", "over", "the", "pls", "iterations", "the", "symbols", "in", "this", "table", "correspond", "to", "version", "of", "lme4that", "is", "imple", "mented", "entirely", "in", "no", "compiled", "code", "as", "in", "lme4itself", "this", "implementation", "is", "called", "lme4purer", "and", "is", "currently", "available", "on", "github", "https", "github", "com", "lme4", "lme4purer", "pls", "step", "update", "relative", "covariance", "factor", "the", "rst", "step", "of", "pls", "is", "to", "update", "the", "relative", "covariance", "factor", "from", "the", "current", "value", "of", "the", "covariance", "parameter", "vector", "the", "updated", "is", "then", "used", "to", "update", "the", "random", "20", "linear", "mixed", "models", "with", "lme4", "pseudocode", "math", "ztw", "latticetopw1", "ztwy", "latticetopwy", "obs", "ztwx", "latticetopwx", "xtwx", "latticetopwx", "xtwy", "latticetopwy", "obs", "table", "constant", "symbols", "involved", "in", "penalized", "least", "squares", "name", "description", "pseudocode", "math", "type", "relative", "covariance", "factor", "lambda", "equation", "double", "sparse", "lower", "triangular", "matrix", "random", "ects", "cholesky", "factorl", "equation", "18", "double", "sparse", "triangu", "lar", "matrix", "intermediate", "vector", "in", "the", "solution", "of", "the", "normal", "equationscu", "cu", "equation", "48", "double", "vector", "block", "in", "the", "full", "cholesky", "factorrzx", "rzx", "equation", "18", "double", "dense", "matrix", "cross", "product", "of", "the", "xed", "ects", "cholesky", "factorrxtrx", "latticetop", "xrx", "equation", "50", "double", "dense", "matrix", "fixed", "ects", "coe", "cients", "beta", "equation", "double", "vector", "spherical", "conditional", "modes", "section", "double", "vector", "non", "spherical", "conditional", "modesb", "equation", "double", "vector", "linear", "predictor", "mu", "equation", "13", "double", "vector", "weighted", "residuals", "wtres", "w1", "yobs", "double", "vector", "penalized", "weighted", "residual", "sum", "of", "squarespwrss", "r2", "equation", "19", "double", "twice", "the", "log", "determinant", "random", "ects", "cholesky", "factorlogdet", "log", "2double", "table7", "quantitiesupdatedduringanevaluationofthelinearmixedmodelobjectivefunction", "ects", "cholesky", "factor", "equation", "18", "the", "mapping", "from", "the", "covariance", "parameters", "to", "the", "relative", "covariance", "factor", "can", "take", "many", "forms", "but", "in", "general", "involves", "function", "that", "takes", "into", "the", "values", "of", "the", "nonzero", "elements", "of", "if", "is", "stored", "as", "an", "object", "of", "class", "dgcmatrix", "from", "the", "matrixpackage", "for", "then", "we", "may", "update", "from", "by", "lambdat", "mapping", "theta", "where", "mapping", "is", "an", "rfunction", "that", "both", "accepts", "and", "returns", "numeric", "vector", "the", "nonzero", "elements", "of", "sparse", "matrix", "classes", "in", "matrixare", "stored", "in", "slot", "called", "in", "the", "current", "version", "of", "lme4", "10", "the", "mapping", "from", "to", "is", "represented", "as", "an", "integer", "vector", "lind", "of", "indices", "so", "that", "journal", "of", "statistical", "software", "21", "mapping", "function", "theta", "theta", "lind", "the", "index", "vector", "lindis", "computed", "during", "the", "model", "setup", "and", "stored", "in", "the", "function", "environment", "continuing", "the", "example", "from", "section", "consider", "new", "value", "for", "theta", "thetanew", "to", "put", "these", "values", "in", "the", "appropriate", "elements", "in", "lambdati", "we", "use", "mapping", "lambdati", "mapping", "thetanew", "lambdati", "sparse", "matrix", "of", "class", "dgtmatrix", "this", "lindapproach", "can", "be", "useful", "for", "extending", "the", "capabilities", "of", "lme4by", "using", "the", "modular", "approach", "to", "tting", "mixed", "models", "for", "example", "appendix", "shows", "how", "to", "use", "lindto", "model", "where", "two", "random", "slopes", "are", "uncorrelated", "but", "both", "slopes", "are", "correlated", "with", "an", "intercept", "the", "mapping", "from", "the", "covariance", "parameters", "to", "the", "relative", "covariance", "factor", "is", "treated", "di", "erentlyinotherimplementationsofthe", "lme4approachtolinearmixedmodels", "attheother", "extreme", "the", "exlambda", "branch", "of", "lme4and", "thelme4purer", "package", "provide", "the", "capabilities", "for", "completely", "general", "mapping", "this", "added", "exibility", "has", "the", "advantage", "of", "allowing", "much", "wider", "variety", "of", "models", "compound", "symmetry", "auto", "regression", "however", "the", "disadvantage", "of", "this", "approach", "is", "that", "it", "becomes", "possible", "to", "much", "wider", "variety", "of", "ill", "posed", "models", "finally", "if", "one", "would", "like", "such", "added", "exibility", "with", "the", "current", "stable", "version", "oflme4", "it", "is", "always", "possible", "to", "use", "the", "modular", "approach", "to", "wrap", "the", "lind", "based", "deviance", "function", "in", "general", "mapping", "function", "taking", "parameter", "to", "be", "optimized", "say", "into", "however", "this", "approach", "is", "likely", "to", "be", "ine", "cient", "in", "many", "cases", "the", "updatemethod", "from", "the", "matrixpackage", "ciently", "updates", "the", "random", "ects", "cholesky", "factor", "from", "new", "value", "of", "and", "the", "updated", "update", "lambdat", "ztw", "mult", "the", "mult", "argument", "corresponds", "to", "the", "addition", "of", "the", "identity", "matrix", "to", "the", "upper", "left", "block", "on", "the", "left", "hand", "side", "of", "equation", "18", "pls", "step", "ii", "solve", "normal", "equations", "with", "the", "new", "covariance", "parameters", "installed", "in", "the", "next", "step", "is", "to", "solve", "the", "normal", "equations", "equation", "17", "for", "the", "current", "estimate", "of", "the", "xed", "ects", "coe", "cients", "hatwide", "and", "the", "22", "linear", "mixed", "models", "with", "lme4", "conditional", "mode", "yobs", "we", "solve", "these", "equations", "using", "sparse", "cholesky", "factorization", "equation", "18", "in", "complex", "model", "to", "large", "data", "set", "the", "dominant", "calculation", "in", "the", "evaluation", "of", "the", "pro", "led", "deviance", "equation", "34", "or", "reml", "criterion", "equation", "41", "is", "this", "sparse", "cholesky", "factorization", "equation", "18", "the", "factorization", "is", "performed", "in", "two", "phases", "symbolic", "phase", "and", "numeric", "phase", "the", "symbolic", "phase", "in", "which", "the", "ll", "reducing", "permu", "tationpis", "determined", "along", "with", "the", "positions", "of", "the", "nonzeros", "in", "does", "not", "depend", "on", "the", "value", "of", "it", "only", "depends", "on", "the", "positions", "of", "the", "nonzeros", "in", "the", "numeric", "phase", "uses", "to", "determine", "the", "numeric", "values", "of", "the", "nonzeros", "in", "using", "this", "factorization", "the", "solution", "proceeds", "by", "the", "following", "steps", "cu", "latticetop", "latticetopwy", "48", "rzx", "latticetop", "latticetopwx", "49", "latticetop", "xrx", "latticetopwx", "latticetop", "zxrzx", "50", "parenleftbig", "latticetop", "xrx", "parenrightbig", "hatwide", "latticetopwy", "rzxcu", "51", "latticetop", "pu", "cu", "rzx", "hatwide", "52", "which", "can", "be", "solved", "using", "the", "matrixpackage", "with", "cu", "as", "vector", "solve", "solve", "lambdat", "ztwy", "system", "system", "rzx", "as", "vector", "solve", "solve", "lambdat", "ztwx", "system", "system", "rxtrx", "as", "xtwx", "crossprod", "rzx", "dpomatrix", "beta", "as", "vector", "solve", "rxtrx", "xtwy", "crossprod", "rzx", "cu", "as", "vector", "solve", "solve", "cu", "rzx", "beta", "system", "lt", "system", "pt", "notice", "the", "nested", "calls", "to", "solve", "the", "inner", "calls", "of", "the", "rst", "two", "assignments", "determine", "and", "apply", "the", "permutation", "matrix", "system", "whereas", "the", "outer", "calls", "actually", "solve", "the", "equation", "system", "in", "the", "assignment", "to", "the", "nesting", "is", "reversed", "in", "order", "to", "return", "to", "the", "original", "permutation", "pls", "step", "iii", "update", "linear", "predictor", "and", "residuals", "the", "next", "step", "is", "to", "compute", "the", "linear", "predictor", "equation", "13", "and", "the", "weighted", "resid", "uals", "with", "new", "values", "for", "hatwide", "and", "yobs", "inlme4purer", "these", "quantities", "can", "be", "computed", "as", "as", "vector", "crossprod", "lambdat", "mu", "as", "vector", "crossprod", "zt", "beta", "offset", "wtres", "sqrtw", "mu", "where", "brepresents", "the", "current", "estimate", "of", "yobs", "pls", "step", "iv", "compute", "pro", "led", "deviance", "finally", "the", "updated", "linear", "predictor", "and", "weighted", "residuals", "can", "be", "used", "to", "compute", "the", "pro", "led", "deviance", "or", "reml", "criterion", "which", "in", "lme4purer", "proceeds", "as", "journal", "of", "statistical", "software", "23", "pwrss", "sum", "wtres", "sum", "logdet", "determinant", "logarithm", "true", "modulus", "if", "reml", "logdet", "logdet", "determinant", "rxtrx", "logarithm", "true", "modulus", "attributes", "logdet", "null", "profdev", "logdet", "degfree", "log", "pi", "pwrss", "log", "degfree", "thepro", "leddevianceconsistsofthreecomponents", "log", "determinant", "ofcholeskyfactor", "ization", "logdet", "the", "degrees", "of", "freedom", "degfree", "and", "the", "penalized", "weighted", "residual", "sum", "of", "squares", "pwrss", "sparse", "matrix", "methods", "in", "tting", "linear", "mixed", "models", "an", "instance", "of", "the", "pls", "problem", "17", "must", "be", "solved", "at", "each", "evaluation", "of", "the", "objective", "function", "during", "the", "optimization", "section", "with", "respect", "to", "because", "this", "operation", "must", "be", "performed", "many", "times", "it", "is", "worthwhile", "considering", "how", "to", "provide", "ective", "evaluation", "methods", "for", "objects", "and", "calculations", "involving", "the", "sparse", "matrices", "associated", "with", "random", "ects", "terms", "sections", "thecholmod", "library", "of", "cfunctions", "chen", "davis", "hager", "and", "rajamanickam", "2008", "on", "which", "the", "sparse", "matrix", "capabilities", "of", "the", "matrixpackage", "for", "rand", "the", "sparse", "cholesky", "factorization", "in", "juliaare", "based", "allows", "for", "separation", "of", "the", "symbolic", "and", "numeric", "phases", "thus", "we", "perform", "the", "symbolic", "phase", "as", "part", "of", "establishing", "the", "structure", "representing", "the", "model", "section2", "furthermore", "because", "cholmod", "functionsallowforupdating", "directly", "from", "the", "matrix", "latticetop", "latticetopwithout", "actually", "forming", "latticetop", "latticetopz", "iwe", "generate", "and", "store", "latticetop", "instead", "ofz", "note", "that", "we", "have", "ignored", "the", "weights", "matrix", "for", "simplicity", "we", "can", "update", "latticetop", "latticetopdirectly", "from", "without", "forming", "and", "multiplying", "two", "sparse", "matrices", "although", "such", "direct", "approach", "is", "used", "in", "the", "mixedmodels", "package", "for", "julia", "inlme4we", "rst", "update", "latticetop", "then", "form", "the", "sparse", "product", "latticetop", "latticetop", "third", "alternative", "which", "we", "employ", "inlme4purer", "is", "to", "compute", "and", "save", "the", "cross", "products", "of", "the", "model", "matrices", "xandz", "and", "the", "response", "before", "starting", "the", "iterations", "to", "allow", "for", "case", "weights", "we", "save", "the", "productsx", "latticetopwx", "latticetopwy", "latticetopwx", "latticetopwyandz", "latticetopwz", "see", "table", "we", "wish", "to", "use", "structures", "and", "algorithms", "that", "allow", "us", "to", "take", "new", "value", "of", "and", "evaluate", "thel", "equation", "18", "ciently", "the", "key", "to", "doing", "so", "is", "the", "special", "structure", "of", "latticetop", "latticetopw1", "to", "understand", "why", "this", "matrix", "and", "not", "its", "transpose", "is", "of", "interest", "we", "describe", "the", "sparse", "matrix", "structures", "used", "in", "juliaand", "in", "the", "matrixpackage", "for", "dense", "matrices", "are", "stored", "in", "rand", "in", "juliaas", "one", "dimensional", "array", "of", "contiguous", "storage", "locations", "addressed", "in", "column", "major", "order", "this", "means", "that", "elements", "in", "the", "same", "column", "are", "in", "adjacent", "storage", "locations", "whereas", "elements", "in", "the", "same", "row", "can", "be", "widely", "separated", "in", "memory", "for", "this", "reason", "algorithms", "that", "work", "column", "wise", "are", "preferred", "to", "those", "that", "work", "row", "wise", "although", "sparse", "matrix", "can", "be", "stored", "in", "tripletformat", "where", "the", "row", "position", "column", "position", "and", "element", "value", "of", "the", "nonzeros", "are", "recorded", "as", "triplets", "the", "preferred", "storage", "forms", "for", "actual", "computation", "with", "sparse", "matrices", "are", "compressed", "sparse", "column", "csc", "or", "compressed", "sparse", "row", "csr", "davis", "2006", "chapter", "the", "cholmod", "and", "more", "generally", "thesuitesparse", "package", "of", "clibraries", "davis", "et", "al", "2015", "uses", "the", "csc", "storage", "format", "in", "this", "format", "the", "nonzero", "elements", "in", "column", "are", "in", "adjacent", "storage", "locations", "and", "access", "to", "all", "the", "elements", "in", "column", "is", "much", "easier", "than", "access", "to", "those", "in", "row", "similar", "to", "dense", "24", "linear", "mixed", "models", "with", "lme4", "matrices", "stored", "in", "column", "major", "order", "the", "matrices", "zandz", "have", "the", "property", "that", "the", "number", "of", "nonzeros", "in", "each", "row", "summationtextk", "1pi", "isconstant", "forcscmatriceswewantconsistencyinthecolumnsratherthantherows", "which", "is", "why", "we", "work", "with", "latticetopand", "latticetop", "latticetoprather", "than", "their", "transposes", "an", "arbitrary", "nsparse", "matrix", "in", "csc", "format", "is", "expressed", "as", "two", "vectors", "of", "indices", "the", "row", "indices", "and", "the", "column", "pointers", "and", "numeric", "vector", "of", "the", "nonzero", "values", "the", "elements", "of", "the", "row", "indices", "and", "the", "nonzeros", "are", "aligned", "and", "are", "ordered", "rst", "by", "increasing", "column", "number", "then", "by", "increasing", "row", "number", "within", "column", "the", "column", "pointers", "are", "vector", "of", "sizen", "1giving", "the", "location", "of", "the", "start", "of", "each", "column", "in", "the", "vectors", "of", "row", "indices", "and", "nonzeros", "nonlinear", "optimization", "module", "the", "objective", "function", "module", "produces", "function", "which", "implements", "the", "penalized", "least", "squares", "algorithm", "for", "particular", "mixed", "model", "the", "next", "step", "is", "to", "optimize", "this", "function", "over", "the", "covariance", "parameters", "which", "is", "nonlinear", "optimization", "problem", "the", "lme4", "package", "separates", "the", "cient", "computational", "linear", "algebra", "required", "to", "compute", "pro", "led", "likelihoods", "and", "deviances", "for", "given", "value", "of", "from", "the", "nonlinear", "optimization", "algorithms", "which", "use", "general", "purpose", "nonlinear", "optimizers", "one", "bene", "of", "this", "separation", "is", "that", "it", "allows", "for", "experimentation", "with", "di", "erent", "nonlinear", "optimizers", "throughout", "the", "development", "of", "lme4", "the", "default", "optimizers", "and", "control", "param", "eters", "have", "changed", "in", "response", "to", "feedback", "from", "users", "about", "both", "ciency", "and", "convergence", "properties", "lme4incorporates", "two", "built", "in", "optimization", "choices", "an", "implementation", "of", "the", "nelder", "mead", "simplex", "algorithm", "adapted", "from", "steven", "johnson", "nlopt", "clibrary", "johnson", "2014", "and", "wrapper", "for", "powell", "bobyqa", "algorithm", "implemented", "in", "the", "minqapackage", "bates", "mullen", "nash", "and", "varadhan", "2014", "as", "wrapper", "around", "powell", "original", "fortran", "code", "powell", "2009", "more", "generally", "lme4allows", "any", "user", "speci", "ed", "optimizer", "that", "can", "work", "with", "an", "objective", "function", "does", "not", "require", "gradient", "function", "to", "be", "speci", "ed", "allows", "box", "constraints", "on", "the", "parameters", "and", "conforms", "to", "some", "simple", "rules", "about", "argument", "names", "and", "structure", "of", "the", "output", "an", "internal", "wrapper", "allows", "the", "use", "of", "the", "op", "timxpackage", "nash", "and", "varadhan", "2011", "although", "the", "only", "optimizers", "provided", "via", "optimx", "that", "satisfy", "the", "constraints", "above", "are", "the", "nlminband", "bfgs", "algorithms", "that", "are", "them", "selves", "wrappers", "around", "the", "versions", "provided", "in", "base", "several", "other", "algorithms", "from", "steven", "johnson", "nloptpackage", "are", "also", "available", "via", "the", "nloptrwrapper", "package", "alternate", "implementations", "of", "nelder", "mead", "and", "bobyqa", "and", "powell", "cobyla", "algorithm", "this", "exibility", "assists", "with", "diagnosing", "convergence", "problems", "it", "is", "easy", "to", "switch", "among", "several", "algorithms", "to", "determine", "whether", "the", "problem", "lies", "in", "failure", "of", "the", "nonlinear", "opti", "mizationstage", "asopposedtoacaseofmodelmisspeci", "cationorunidenti", "abilityoraproblem", "with", "the", "underlying", "pls", "algorithm", "to", "date", "we", "have", "only", "observed", "pls", "failures", "which", "arise", "ifx", "latticetopwx", "latticetop", "zxrzxbecomes", "singular", "during", "an", "evaluation", "of", "the", "objective", "function", "with", "badly", "scaled", "problems", "problems", "with", "continuous", "predictors", "that", "take", "very", "large", "or", "very", "small", "numerical", "range", "of", "values", "the", "requirement", "for", "optimizers", "that", "can", "handle", "box", "constraints", "stems", "from", "our", "decision", "to", "parameterize", "the", "variance", "covariance", "matrix", "in", "constrained", "space", "in", "order", "to", "allow", "for", "singular", "ts", "in", "contrast", "to", "the", "approach", "taken", "in", "the", "nlmepackage", "pinheiro", "et", "al", "2015", "journal", "of", "statistical", "software", "25", "which", "goes", "to", "some", "lengths", "to", "use", "an", "unconstrained", "variance", "covariance", "parameterization", "thelog", "cholesky", "parameterization", "pinheiro", "and", "bates", "1996", "we", "instead", "use", "the", "cholesky", "parameterization", "but", "require", "the", "elements", "of", "corresponding", "to", "the", "diagonal", "elements", "of", "the", "cholesky", "factor", "to", "be", "non", "negative", "with", "these", "constraints", "the", "variance", "covariance", "matrix", "is", "singular", "if", "and", "only", "if", "any", "of", "the", "diagonal", "elements", "is", "exactly", "zero", "singular", "ts", "are", "common", "in", "practical", "data", "analysis", "situations", "especially", "with", "small", "to", "medium", "sized", "data", "sets", "and", "complex", "variance", "covariance", "models", "so", "being", "able", "to", "singular", "model", "is", "an", "advantage", "when", "the", "best", "tting", "model", "lies", "on", "the", "boundary", "of", "constrained", "space", "approaches", "that", "try", "to", "remove", "the", "constraints", "by", "tting", "parameters", "on", "transformed", "scale", "will", "often", "give", "rise", "to", "convergence", "warnings", "as", "the", "algorithm", "tries", "to", "nd", "maximum", "on", "an", "asymptotically", "at", "surface", "bolker", "et", "al", "2013", "in", "principle", "the", "likelihood", "surfaces", "we", "are", "trying", "to", "optimize", "over", "are", "smooth", "but", "in", "practice", "using", "gradient", "information", "in", "optimization", "may", "or", "may", "not", "be", "worth", "the", "ort", "in", "special", "cases", "we", "have", "closed", "form", "solution", "for", "the", "gradients", "equations", "45", "47", "but", "in", "general", "we", "will", "have", "to", "approximate", "them", "by", "nite", "di", "erences", "which", "is", "expensive", "and", "has", "limited", "accuracy", "we", "have", "considered", "using", "automatic", "di", "erentiation", "approaches", "to", "compute", "the", "gradients", "more", "ciently", "but", "this", "strategy", "requires", "great", "deal", "of", "additional", "machinery", "and", "would", "have", "drawbacks", "in", "terms", "of", "memory", "requirements", "for", "large", "problems", "this", "is", "the", "primary", "reason", "for", "our", "switching", "to", "derivative", "free", "optimizers", "such", "as", "bobyqa", "and", "nelder", "mead", "in", "the", "current", "version", "of", "lme4", "although", "as", "discussed", "above", "derivative", "based", "optimizers", "based", "on", "nite", "di", "erencing", "are", "available", "as", "an", "alternative", "there", "is", "most", "likely", "further", "room", "for", "improvement", "in", "the", "nonlinear", "optimization", "module", "for", "example", "some", "speed", "up", "could", "be", "gained", "by", "using", "parallel", "implementations", "of", "derivative", "free", "optimizers", "that", "evaluated", "several", "trial", "points", "at", "once", "klein", "and", "neira", "2013", "in", "practice", "users", "most", "often", "have", "optimization", "di", "culties", "with", "poorly", "scaled", "or", "centered", "data", "we", "are", "working", "to", "implement", "appropriate", "diagnostic", "tests", "and", "warnings", "to", "detect", "these", "situations", "output", "module", "here", "we", "describe", "some", "of", "the", "methods", "in", "lme4for", "exploring", "tted", "linear", "mixed", "models", "ta", "ble", "which", "are", "represented", "as", "objects", "of", "the", "s4", "class", "lmermod", "we", "begin", "by", "describing", "the", "theory", "underlying", "these", "methods", "section", "and", "then", "continue", "the", "sleepstudy", "example", "introduced", "in", "section", "to", "illustrate", "these", "ideas", "in", "practice", "theory", "underlying", "the", "output", "module", "covariance", "matrix", "of", "the", "xed", "ect", "coe", "cients", "in", "the", "lmfunction", "the", "variance", "covariance", "matrix", "of", "the", "coe", "cients", "is", "the", "inverse", "of", "the", "cross", "product", "of", "the", "model", "matrix", "times", "the", "residual", "variance", "chambers", "1993", "the", "inverse", "cross", "product", "matrix", "is", "computed", "by", "rst", "inverting", "the", "upper", "triangular", "matrix", "resulting", "from", "the", "qr", "decomposition", "of", "the", "model", "matrix", "and", "then", "taking", "its", "cross", "product", "var", "parenleftbigg", "bracketleftbigg", "yobs", "bracketrightbigg", "parenrightbigg", "bracketleftbigg", "latticetop", "rzx", "0rx", "bracketrightbigg", "bracketleftbigg", "latticetop", "zxr", "latticetop", "bracketrightbigg", "53", "26", "linear", "mixed", "models", "with", "lme4", "because", "of", "normality", "the", "marginal", "covariance", "matrix", "of", "is", "just", "the", "lower", "right", "by", "pblock", "ofvar", "parenleftbigg", "bracketleftbigg", "yobs", "bracketrightbigg", "parenrightbigg", "this", "lower", "right", "block", "is", "var", "2r", "latticetop", "54", "which", "follows", "from", "the", "schur", "complement", "identity", "horn", "and", "zhang", "2005", "theorem", "this", "matrix", "can", "be", "extracted", "from", "tted", "mermod", "object", "as", "rx", "getme", "fm1", "rx", "sigma2", "sigma", "fm1", "sigma2", "chol2inv", "rx", "46", "574573", "451097", "451097", "389463", "which", "could", "be", "computed", "with", "lme4asvcov", "fm1", "the", "square", "root", "diagonal", "of", "this", "covariance", "matrix", "contains", "the", "estimates", "of", "the", "standard", "errorsof", "xed", "ectscoe", "cients", "thesestandarderrorsareusedtoconstructwaldcon", "dence", "intervals", "with", "confint", "method", "wald", "such", "con", "dence", "intervals", "are", "approximate", "and", "depend", "on", "the", "assumption", "that", "the", "likelihood", "pro", "le", "of", "the", "xed", "ects", "is", "linear", "on", "the", "scale", "pro", "ling", "the", "theory", "of", "likelihood", "pro", "les", "is", "straightforward", "the", "deviance", "or", "likelihood", "pro", "le", "2lp", "for", "focal", "model", "parameter", "pis", "the", "minimum", "value", "of", "the", "deviance", "conditioned", "on", "particular", "value", "of", "for", "each", "parameter", "of", "interest", "our", "goal", "is", "to", "evaluate", "the", "de", "viance", "pro", "le", "for", "many", "points", "optimizing", "over", "all", "of", "the", "non", "focal", "parameters", "each", "time", "over", "wide", "enough", "range", "and", "with", "high", "enough", "resolution", "to", "evaluate", "the", "shape", "of", "the", "pro", "le", "in", "particular", "whether", "it", "is", "quadratic", "which", "would", "allow", "use", "of", "wald", "con", "dence", "intervals", "and", "tests", "and", "to", "nd", "the", "values", "of", "psuch", "that", "2lp", "2l", "hatwidep", "which", "represent", "the", "pro", "le", "con", "dence", "intervals", "while", "pro", "le", "con", "dence", "intervals", "rely", "on", "the", "asymptotic", "dis", "tribution", "of", "the", "minimum", "deviance", "this", "is", "much", "weaker", "assumption", "than", "the", "log", "quadratic", "likelihood", "surface", "required", "by", "wald", "tests", "an", "additional", "challenge", "in", "pro", "ling", "arises", "when", "we", "want", "to", "compute", "pro", "les", "for", "quantities", "of", "interest", "that", "are", "not", "parameters", "of", "our", "pls", "function", "we", "have", "two", "problems", "in", "using", "the", "deviance", "function", "de", "ned", "above", "to", "pro", "le", "linear", "mixed", "models", "first", "parameterization", "of", "the", "random", "ects", "variance", "covariance", "matrix", "in", "terms", "of", "standard", "deviations", "and", "correla", "tions", "or", "variances", "and", "covariances", "is", "much", "more", "familiar", "to", "users", "and", "much", "more", "relevant", "as", "output", "of", "statistical", "model", "than", "the", "parameters", "of", "the", "relative", "covariance", "factor", "users", "are", "interested", "in", "inferences", "on", "variances", "or", "standard", "deviations", "not", "on", "second", "the", "xed", "ects", "coe", "cients", "and", "the", "residual", "standard", "deviation", "both", "of", "which", "are", "also", "of", "interest", "to", "users", "are", "pro", "led", "out", "in", "the", "sense", "used", "above", "of", "the", "deviance", "function", "section", "so", "we", "have", "to", "nd", "strategy", "for", "estimating", "the", "deviance", "for", "values", "of", "and", "2other", "than", "the", "pro", "led", "values", "journal", "of", "statistical", "software", "27", "to", "handle", "the", "rst", "problem", "we", "create", "new", "version", "of", "the", "deviance", "function", "that", "rst", "takes", "vector", "of", "standard", "deviations", "and", "correlations", "and", "value", "of", "the", "residual", "standard", "devi", "ation", "maps", "them", "to", "vector", "and", "then", "computes", "the", "pls", "as", "before", "it", "uses", "the", "speci", "ed", "residual", "standard", "deviation", "rather", "than", "the", "pls", "estimate", "of", "the", "standard", "deviation", "equa", "tion", "33", "in", "the", "deviance", "calculation", "we", "compute", "pro", "le", "likelihood", "for", "the", "xed", "ects", "parameters", "which", "are", "pro", "led", "out", "of", "the", "deviance", "calculation", "by", "adding", "an", "set", "to", "the", "linear", "predictor", "for", "the", "focal", "element", "of", "the", "resulting", "function", "is", "not", "useful", "for", "general", "nonlinear", "optimization", "one", "can", "easily", "wander", "into", "parameter", "regimes", "corresponding", "to", "in", "feasible", "non", "positive", "semide", "nite", "variance", "covariance", "matrices", "but", "it", "serves", "for", "likelihood", "pro", "ling", "where", "one", "focal", "parameter", "is", "varied", "at", "time", "and", "the", "optimization", "over", "the", "other", "parameters", "is", "likely", "to", "start", "close", "to", "an", "optimum", "in", "practice", "the", "profile", "method", "systematically", "varies", "the", "parameters", "in", "model", "assessing", "the", "best", "possible", "that", "can", "be", "obtained", "with", "one", "parameter", "xed", "at", "speci", "value", "and", "comparing", "this", "to", "the", "globally", "optimal", "which", "is", "the", "original", "model", "that", "allowed", "all", "the", "parameters", "to", "vary", "the", "models", "are", "compared", "according", "to", "the", "change", "in", "the", "deviance", "which", "is", "the", "likelihood", "ratio", "test", "statistic", "we", "apply", "signed", "square", "root", "transformation", "to", "this", "statistic", "and", "plot", "the", "resulting", "function", "which", "we", "call", "the", "pro", "le", "zeta", "function", "or", "versus", "the", "parameter", "value", "the", "signed", "aspect", "of", "this", "transformation", "means", "that", "is", "positive", "where", "the", "deviation", "from", "the", "parameter", "estimate", "is", "positive", "and", "negative", "otherwise", "leading", "to", "monotonically", "increasing", "function", "which", "is", "zero", "at", "the", "global", "optimum", "value", "can", "be", "compared", "to", "the", "quantiles", "of", "the", "standard", "normal", "distribution", "for", "example", "95", "pro", "le", "deviance", "con", "dence", "interval", "on", "the", "parameter", "consists", "of", "the", "values", "for", "which", "96", "96", "because", "the", "process", "of", "pro", "ling", "tted", "model", "can", "be", "computationally", "intensive", "it", "involves", "re", "tting", "the", "model", "many", "times", "one", "should", "exercise", "caution", "with", "complex", "models", "to", "large", "data", "sets", "the", "standard", "approach", "to", "this", "computational", "challenge", "is", "to", "compute", "at", "limited", "number", "of", "parameter", "values", "and", "to", "ll", "in", "the", "gaps", "by", "tting", "an", "interpolation", "spline", "often", "one", "is", "able", "to", "invert", "the", "spline", "to", "obtain", "function", "from", "to", "the", "focal", "parameter", "which", "is", "necessary", "in", "order", "to", "construct", "pro", "le", "con", "dence", "intervals", "however", "even", "if", "the", "points", "themselves", "are", "monotonic", "it", "is", "possible", "to", "obtain", "non", "monotonic", "interpolation", "curves", "in", "such", "case", "lme4", "falls", "back", "to", "linear", "interpolation", "with", "warning", "the", "last", "part", "of", "the", "technical", "speci", "cation", "for", "computing", "pro", "les", "is", "deciding", "on", "strategy", "for", "choosing", "points", "to", "sample", "in", "one", "way", "or", "another", "one", "wants", "to", "start", "at", "the", "estimated", "value", "for", "each", "parameter", "and", "work", "outward", "either", "until", "constraint", "is", "reached", "value", "of", "for", "standard", "deviation", "parameter", "or", "value", "of", "1for", "correlation", "parameter", "or", "until", "su", "ciently", "large", "deviation", "from", "the", "minimum", "deviance", "is", "attained", "lme4", "pro", "ler", "chooses", "cuto", "based", "on", "the", "maxcritical", "value", "of", "the", "2distribution", "with", "number", "of", "degrees", "of", "freedom", "equal", "to", "the", "totalnumber", "of", "parameters", "in", "the", "model", "where", "maxis", "set", "to", "05", "by", "default", "the", "pro", "le", "computation", "initially", "adjusts", "the", "focal", "parameter", "piby", "an", "amount", "epsilon1", "01", "pifrom", "its", "ml", "or", "reml", "estimate", "pi", "or", "by", "epsilon1", "001if", "piis", "zero", "as", "in", "the", "case", "of", "singular", "variance", "covariance", "model", "the", "local", "slope", "of", "the", "likelihood", "pro", "le", "pi", "epsilon1", "pi", "epsilon1is", "used", "to", "pick", "the", "next", "point", "to", "evaluate", "extrapolating", "the", "local", "slope", "to", "nd", "new", "epsilon1that", "would", "be", "expected", "to", "correspond", "to", "the", "desired", "step", "size", "equal", "to", "8by", "default", "so", "that", "16", "points", "would", "be", "used", "to", "cover", "the", "pro", "le", "in", "both", "directions", "if", "the", "log", "likelihood", "surface", "were", "exactly", "quadratic", "some", "fail", "safe", "testing", "is", "done", "to", "ensure", "that", "the", "step", "chosen", "is", "always", "positive", "and", "less", "than", "maximum", "if", "deviance", "is", "ever", "detected", "28", "linear", "mixed", "models", "with", "lme4", "that", "is", "lower", "than", "that", "of", "the", "ml", "deviance", "which", "can", "occur", "if", "the", "initial", "was", "wrong", "due", "to", "numerical", "problems", "the", "pro", "ler", "issues", "an", "error", "and", "stops", "parametric", "bootstrapping", "to", "avoid", "the", "asymptotic", "assumptions", "of", "the", "likelihood", "ratio", "test", "at", "the", "cost", "of", "greatly", "in", "creased", "computation", "time", "one", "can", "estimate", "con", "dence", "intervals", "by", "parametric", "bootstrapping", "that", "is", "by", "simulating", "data", "from", "the", "tted", "model", "re", "tting", "the", "model", "and", "extracting", "the", "new", "estimated", "parameters", "or", "any", "other", "quantities", "of", "interest", "this", "task", "is", "quite", "straightfor", "ward", "since", "there", "is", "already", "simulate", "method", "and", "refitfunction", "which", "re", "estimates", "the", "re", "ml", "parameters", "for", "new", "data", "starting", "from", "the", "previous", "re", "ml", "estimates", "and", "re", "using", "the", "previously", "computed", "model", "structures", "including", "the", "ll", "reducing", "permutation", "for", "ciency", "the", "bootmer", "function", "is", "thus", "fairly", "thin", "wrapper", "around", "simulate", "refitloop", "with", "small", "amount", "of", "additional", "logic", "for", "parallel", "computation", "and", "error", "catching", "some", "of", "the", "ideas", "of", "bootmer", "are", "adapted", "from", "merboot", "nchez", "espigares", "and", "oca", "2009", "more", "ambitious", "framework", "for", "bootstrapping", "lme4model", "ts", "which", "unfortunately", "seems", "to", "be", "unavailable", "at", "present", "conditional", "variances", "of", "random", "ects", "it", "is", "useful", "to", "clarify", "that", "the", "conditional", "covariance", "concept", "in", "lme4is", "based", "on", "simpli", "cation", "of", "the", "linear", "mixed", "model", "in", "particular", "we", "simplify", "the", "model", "by", "assuming", "that", "the", "quantities", "and", "are", "known", "set", "at", "their", "estimated", "values", "in", "fact", "the", "only", "way", "to", "de", "ne", "the", "conditional", "covariance", "is", "at", "xed", "parameter", "values", "our", "approximation", "here", "is", "using", "the", "estimated", "parameter", "values", "for", "the", "unknown", "true", "parameter", "values", "in", "this", "simpli", "ed", "case", "uis", "the", "only", "quantity", "in", "the", "statistical", "model", "that", "is", "both", "random", "and", "unknown", "given", "this", "simpli", "ed", "linear", "mixed", "model", "standard", "result", "in", "bayesian", "linear", "regression", "mod", "eling", "gelman", "et", "al", "2013", "implies", "that", "the", "conditional", "distribution", "of", "the", "spherical", "random", "ects", "given", "the", "observed", "response", "vector", "is", "gaussian", "yobs", "yobs", "hatwide", "2v", "55", "where", "parenleftbig", "latticetop", "hatwide", "latticetopwz", "hatwide", "iq", "parenrightbig", "parenleftbig", "hatwide", "parenrightbig", "latticetop", "parenleftbig", "hatwide", "parenrightbig", "56", "is", "the", "unscaled", "conditional", "variance", "and", "yobs", "latticetop", "hatwide", "latticetopw", "parenleftbig", "yobs", "hatwide", "parenrightbig", "57", "is", "the", "conditional", "mean", "mode", "note", "that", "in", "practice", "the", "inverse", "in", "equation", "56", "does", "not", "get", "computed", "directly", "but", "rather", "an", "cient", "method", "is", "used", "that", "exploits", "the", "sparse", "structures", "the", "random", "ects", "coe", "cient", "vector", "is", "often", "of", "greater", "interest", "the", "conditional", "covari", "ance", "matrix", "ofbmay", "be", "expressed", "as", "hatwide", "hatwide", "latticetop", "hatwide", "58", "the", "hat", "matrix", "the", "hat", "matrix", "is", "useful", "object", "in", "linear", "model", "diagnostics", "cook", "and", "weisberg", "1982", "in", "general", "hrelates", "the", "observed", "and", "tted", "response", "vectors", "but", "we", "speci", "cally", "de", "ne", "it", "as", "journal", "of", "statistical", "software", "29", "parenleftbig", "parenrightbig", "yobs", "59", "to", "ndhwe", "note", "that", "parenleftbig", "parenrightbig", "bracketleftbig", "bracketrightbig", "bracketleftbigg", "yobs", "hatwide", "bracketrightbigg", "60", "next", "we", "get", "an", "expression", "for", "bracketleftbigg", "yobs", "hatwide", "bracketrightbigg", "by", "solving", "the", "normal", "equations", "equation", "17", "bracketleftbigg", "yobs", "hatwide", "bracketrightbigg", "bracketleftbigg", "latticetop", "rzx", "0rx", "bracketrightbigg", "bracketleftbigg", "latticetop", "zxr", "latticetop", "bracketrightbigg", "bracketleftbigg", "latticetop", "latticetop", "latticetop", "bracketrightbigg", "yobs", "61", "by", "the", "schur", "complement", "identity", "horn", "and", "zhang", "2005", "bracketleftbigg", "latticetop", "rzx", "0rx", "bracketrightbigg", "parenleftbig", "latticetop", "parenrightbig", "parenleftbig", "latticetop", "parenrightbig", "1rzxr", "62", "therefore", "we", "may", "write", "the", "hat", "matrix", "as", "latticetop", "lcl", "latticetop", "rcr", "63", "where", "cl", "latticetop", "latticetopw1", "64", "and", "latticetop", "xcr", "latticetopw1", "latticetop", "zxcl", "65", "the", "trace", "of", "the", "hat", "matrix", "is", "often", "used", "as", "measure", "of", "the", "ective", "degrees", "of", "freedom", "vaida", "and", "blanchard", "2005", "using", "relationship", "between", "the", "trace", "and", "vec", "operators", "the", "trace", "ofhmay", "be", "expressed", "as", "tr", "bardblvec", "cl", "bardbl2", "bardblvec", "cr", "bardbl2", "66", "using", "the", "output", "module", "the", "user", "interface", "for", "the", "output", "module", "largely", "consists", "of", "set", "of", "methods", "table", "for", "objects", "of", "class", "mermod", "which", "is", "the", "class", "of", "objects", "returned", "by", "lmer", "in", "addition", "to", "these", "methods", "the", "getmefunction", "can", "be", "used", "to", "extract", "various", "objects", "from", "tted", "mixed", "model", "inlme4", "here", "we", "illustrate", "the", "use", "of", "several", "of", "these", "methods", "updating", "tted", "mixed", "models", "to", "illustrate", "the", "updatemethod", "for", "mermod", "objects", "we", "construct", "random", "intercept", "only", "model", "this", "task", "could", "be", "done", "in", "several", "ways", "but", "we", "choose", "to", "rst", "remove", "the", "random", "ects", "term", "days", "subject", "and", "add", "new", "term", "with", "random", "intercept", "fm3", "update", "fm1", "days", "subject", "subject", "formula", "fm3", "30", "linear", "mixed", "models", "with", "lme4", "generic", "brief", "description", "of", "return", "value", "anova", "decomposition", "of", "xed", "ects", "contributions", "or", "model", "comparison", "as", "function", "function", "returning", "pro", "led", "deviance", "or", "reml", "criterion", "coef", "sum", "of", "the", "random", "and", "xed", "ects", "for", "each", "level", "confint", "con", "dence", "intervals", "on", "linear", "mixed", "model", "parameters", "deviance", "minus", "twice", "maximum", "log", "likelihood", "use", "remlcrit", "for", "the", "reml", "criterion", "df", "residual", "residual", "degrees", "of", "freedom", "drop1", "drop", "allowable", "single", "terms", "from", "the", "model", "extractaic", "generalized", "akaike", "information", "criterion", "fitted", "fitted", "values", "given", "conditional", "modes", "equation", "13", "fixef", "estimates", "of", "the", "xed", "ects", "coe", "cients", "hatwide", "formula", "mixed", "model", "formula", "of", "tted", "model", "loglik", "maximum", "log", "likelihood", "model", "frame", "data", "required", "to", "the", "model", "model", "matrix", "fixed", "ects", "model", "matrix", "ngrps", "number", "of", "levels", "in", "each", "grouping", "factor", "nobs", "number", "of", "observations", "plot", "diagnostic", "plots", "for", "mixed", "model", "ts", "predict", "various", "types", "of", "predicted", "values", "print", "basic", "printout", "of", "mixed", "model", "objects", "profile", "pro", "led", "likelihood", "over", "various", "model", "parameters", "ranef", "conditional", "modes", "of", "the", "random", "ects", "refit", "model", "re", "tted", "to", "new", "set", "of", "observations", "of", "the", "response", "variable", "refitml", "model", "re", "tted", "by", "maximum", "likelihood", "residuals", "various", "types", "of", "residual", "values", "sigma", "residual", "standard", "deviation", "simulate", "simulated", "data", "from", "tted", "mixed", "model", "summary", "summary", "of", "mixed", "model", "terms", "terms", "representation", "of", "mixed", "model", "update", "an", "updated", "model", "using", "revised", "formula", "or", "other", "arguments", "varcorr", "estimated", "random", "ects", "variances", "standard", "deviations", "and", "correlations", "vcov", "covariance", "matrix", "of", "the", "xed", "ects", "estimates", "weights", "prior", "weights", "used", "in", "model", "tting", "table", "list", "of", "currently", "available", "methods", "for", "objects", "of", "the", "class", "mermod", "reaction", "days", "subject", "model", "summary", "and", "associated", "accessors", "the", "summary", "method", "for", "mermod", "objects", "provides", "information", "about", "the", "model", "here", "we", "consider", "the", "output", "of", "summary", "fm1", "in", "four", "steps", "the", "rst", "few", "lines", "of", "output", "indicate", "that", "the", "model", "was", "tted", "by", "reml", "as", "well", "as", "the", "value", "of", "the", "reml", "criterion", "equation", "39", "at", "convergence", "which", "may", "also", "be", "extracted", "using", "remlcrit", "fm1", "the", "beginning", "of", "the", "journal", "of", "statistical", "software", "31", "summary", "also", "reproduces", "the", "model", "formula", "and", "the", "scaled", "pearson", "residuals", "linear", "mixed", "model", "fit", "by", "reml", "quotesingle", "ts1lmermod", "quotesingle", "ts1", "formula", "reaction", "days", "days", "subject", "data", "sleepstudy", "reml", "criterion", "at", "convergence", "1743", "scaled", "residuals", "min", "1q", "median", "3q", "max", "9536", "4634", "0231", "4634", "1793", "this", "information", "may", "also", "be", "obtained", "using", "standard", "accessor", "functions", "formula", "fm1", "remlcrit", "fm1", "quantile", "residuals", "fm1", "pearson", "scaled", "true", "the", "second", "piece", "of", "the", "summary", "output", "provides", "information", "regarding", "the", "random", "ects", "and", "residual", "variation", "random", "effects", "groups", "name", "variance", "std", "dev", "corr", "subject", "intercept", "612", "09", "24", "740", "days", "35", "07", "922", "07", "residual", "654", "94", "25", "592", "number", "of", "obs", "180", "groups", "subject", "18", "which", "can", "also", "be", "accessed", "using", "print", "vc", "varcorr", "fm1", "comp", "variance", "std", "dev", "nobs", "fm1", "ngrps", "fm1", "sigma", "fm1", "the", "print", "method", "for", "objects", "returned", "by", "varcorr", "hides", "the", "internal", "structure", "of", "these", "varcorr", "mermod", "objects", "the", "internal", "structure", "of", "an", "object", "of", "this", "class", "is", "list", "of", "matrices", "one", "for", "each", "random", "ects", "term", "the", "standard", "deviations", "and", "correlation", "ma", "trices", "for", "each", "term", "are", "stored", "as", "attributes", "stddevand", "correlation", "respectively", "of", "the", "variance", "covariance", "matrix", "and", "the", "residual", "standard", "deviation", "is", "stored", "as", "attribute", "sc", "for", "programming", "use", "these", "objects", "can", "be", "summarized", "di", "erently", "using", "their", "as", "data", "frame", "method", "as", "data", "frame", "varcorr", "fm1", "grp", "var1", "var2", "vcov", "sdcor", "subject", "intercept", "na", "612", "089963", "24", "74045195", "subject", "days", "na", "35", "071661", "92213312", "subject", "intercept", "days", "604306", "06555113", "residual", "na", "na", "654", "941028", "25", "59181564", "32", "linear", "mixed", "models", "with", "lme4", "which", "contains", "one", "row", "for", "each", "variance", "or", "covariance", "parameter", "the", "grpcolumn", "gives", "the", "grouping", "factor", "associated", "with", "this", "parameter", "the", "var1and", "var2columns", "give", "the", "names", "of", "the", "variables", "associated", "with", "the", "parameter", "var2is", "na", "unless", "it", "is", "covariance", "parameter", "the", "vcovcolumn", "gives", "the", "variances", "and", "covariances", "and", "the", "sdcorcolumn", "gives", "these", "numbers", "on", "the", "standard", "deviation", "and", "correlation", "scales", "the", "next", "chunk", "of", "output", "gives", "the", "xed", "ects", "estimates", "fixed", "effects", "estimate", "std", "error", "value", "intercept", "251", "405", "825", "36", "84", "days", "10", "467", "546", "77", "note", "that", "there", "are", "no", "pvalues", "the", "xed", "ects", "point", "estimates", "may", "be", "obtained", "separately", "viafixef", "fm1", "conditional", "modes", "of", "the", "random", "ects", "coe", "cients", "can", "be", "obtained", "with", "ranef", "see", "section", "for", "information", "on", "the", "theory", "finally", "we", "have", "the", "correlations", "between", "the", "xed", "ects", "estimates", "correlation", "of", "fixed", "effects", "intr", "days", "138", "the", "full", "variance", "covariance", "matrix", "of", "the", "xed", "ects", "estimates", "can", "be", "obtained", "in", "the", "usual", "rway", "with", "the", "vcovmethod", "section", "alternatively", "coef", "summary", "fm1", "will", "return", "the", "full", "xed", "ects", "parameter", "table", "as", "shown", "in", "the", "summary", "diagnostic", "plots", "lme4provides", "tools", "for", "generating", "most", "of", "the", "standard", "graphical", "diagnostic", "plots", "with", "the", "exception", "of", "those", "incorporating", "in", "uence", "measures", "cook", "distance", "and", "leverage", "plots", "in", "way", "modeled", "on", "the", "diagnostic", "graphics", "of", "nlme", "pinheiro", "and", "bates", "2000", "in", "particular", "the", "familiar", "plotmethod", "in", "base", "rfor", "linear", "models", "objects", "of", "class", "lm", "can", "be", "used", "to", "create", "the", "standard", "tted", "vs", "residual", "plots", "plot", "fm1", "type", "smooth", "scale", "location", "plots", "plot", "fm1", "sqrt", "abs", "resid", "fitted", "type", "smooth", "and", "quantile", "quantile", "plots", "from", "lattice", "qqmath", "fm1", "id", "05", "in", "contrast", "to", "the", "plotmethod", "for", "lm", "objects", "these", "scale", "location", "and", "plots", "are", "based", "on", "raw", "rather", "than", "standardized", "residuals", "in", "addition", "to", "these", "standard", "diagnostic", "plots", "which", "examine", "the", "validity", "of", "various", "assump", "tions", "linearity", "homoscedasticity", "normality", "at", "the", "level", "of", "the", "residuals", "one", "can", "also", "use", "thedotplot", "and", "qqmathmethods", "for", "the", "conditional", "modes", "ranef", "mer", "objects", "gen", "erated", "by", "ranef", "fit", "to", "check", "for", "interesting", "patterns", "and", "normality", "in", "the", "conditional", "journal", "of", "statistical", "software", "33", "modes", "lme4does", "not", "provide", "in", "uence", "diagnostics", "but", "these", "and", "other", "useful", "diagnostic", "procedures", "are", "available", "in", "the", "dependent", "packages", "hlmdiag", "andin", "uence", "me", "loy", "and", "hofmann", "2014", "nieuwenhuis", "te", "grotenhuis", "and", "pelzer", "2012", "finally", "posterior", "predictive", "simulation", "gelman", "and", "hill", "2006", "is", "generally", "useful", "diagnostic", "tool", "adapted", "from", "bayesian", "methods", "for", "exploring", "model", "users", "pick", "some", "summary", "statistic", "of", "interest", "they", "then", "compute", "the", "summary", "statistic", "for", "an", "ensemble", "of", "simulations", "and", "see", "where", "the", "observed", "data", "falls", "within", "the", "simulated", "distribution", "if", "the", "observed", "data", "is", "extreme", "we", "might", "conclude", "that", "the", "model", "is", "poor", "representation", "of", "reality", "for", "example", "using", "the", "sleep", "study", "and", "choosing", "the", "interquartile", "range", "of", "the", "reaction", "times", "as", "the", "summary", "statistic", "iqrvec", "sapply", "simulate", "fm1", "1000", "iqr", "obsval", "iqr", "sleepstudy", "reaction", "post", "pred", "mean", "obsval", "obsval", "iqrvec", "the", "one", "tailed", "posterior", "predictive", "pvalue", "of", "78", "indicates", "that", "the", "model", "represents", "the", "data", "adequately", "at", "least", "for", "this", "summary", "statistic", "in", "contrast", "to", "the", "full", "bayesian", "case", "the", "procedure", "described", "here", "does", "not", "allow", "for", "the", "uncertainty", "in", "the", "estimated", "parameters", "however", "it", "should", "be", "reasonable", "approximation", "when", "the", "residual", "variation", "is", "large", "sequential", "decomposition", "and", "model", "comparison", "objects", "of", "class", "mermod", "have", "an", "anovamethod", "which", "returns", "fstatistics", "corresponding", "to", "the", "sequential", "decomposition", "of", "the", "contributions", "of", "xed", "ects", "terms", "in", "order", "to", "illustrate", "this", "sequential", "anova", "decomposition", "we", "model", "with", "orthogonal", "linear", "and", "quadratic", "daysterms", "fm4", "lmer", "reaction", "polydays", "polydays", "polydays", "polydays", "subject", "within", "sleepstudy", "polydays", "poly", "days", "anova", "fm4", "analysis", "of", "variance", "table", "df", "sum", "sq", "mean", "sq", "value", "polydays", "23874", "23874", "46", "0757", "polydays", "340", "340", "6567", "the", "relative", "magnitudes", "of", "the", "two", "sums", "of", "squares", "indicate", "that", "the", "quadratic", "term", "explains", "much", "less", "variation", "than", "the", "linear", "term", "furthermore", "the", "magnitudes", "of", "the", "two", "fstatistics", "strongly", "suggest", "signi", "cance", "of", "the", "linear", "term", "but", "not", "the", "quadratic", "term", "notice", "that", "this", "is", "only", "an", "informal", "assessment", "of", "signi", "cance", "as", "there", "are", "no", "pvalues", "associated", "with", "these", "fstatistics", "an", "issue", "discussed", "in", "more", "detail", "in", "the", "next", "subsection", "computing", "pvalues", "29", "to", "understand", "how", "these", "quantities", "are", "computed", "let", "ricontain", "the", "rows", "of", "rx", "equa", "tion", "18", "associated", "with", "the", "ith", "xed", "ects", "term", "then", "the", "sum", "of", "squares", "for", "term", "iis", "ssi", "hatwide", "latticetopr", "latticetop", "iri", "hatwide", "67", "34", "linear", "mixed", "models", "with", "lme4", "ifdfiis", "the", "number", "of", "columns", "in", "ri", "then", "thefstatistic", "for", "term", "iis", "fi", "ssi", "hatwide", "2dfi", "68", "for", "multiple", "arguments", "the", "anovamethod", "returns", "model", "comparison", "statistics", "anova", "fm1", "fm2", "fm3", "refitting", "model", "with", "ml", "instead", "of", "reml", "data", "sleepstudy", "models", "fm3", "reaction", "days", "subject", "fm2", "reaction", "days", "subject", "days", "subject", "fm1", "reaction", "days", "days", "subject", "df", "aic", "bic", "loglik", "deviance", "chisq", "chi", "df", "pr", "chisq", "fm3", "1802", "1814", "897", "04", "1794", "fm2", "1762", "1778", "876", "00", "1752", "42", "0754", "782e", "11", "fm1", "1763", "1783", "875", "97", "1751", "0639", "8004", "the", "output", "shows", "2statistics", "representing", "the", "di", "erence", "in", "deviance", "between", "successive", "models", "as", "well", "as", "pvalues", "based", "on", "likelihood", "ratio", "test", "comparisons", "in", "this", "case", "the", "sequentialcomparisonshowsthataddingalineare", "ectoftimeuncorrelatedwiththeintercept", "leads", "to", "an", "enormous", "and", "signi", "cant", "drop", "in", "deviance", "deviance", "42", "10", "10", "while", "the", "further", "addition", "of", "correlation", "between", "the", "slope", "and", "intercept", "leads", "to", "trivial", "and", "non", "signi", "cant", "change", "in", "deviance", "deviance", "06", "for", "objects", "of", "class", "lmermod", "the", "default", "behavior", "is", "to", "re", "the", "models", "with", "ml", "if", "tted", "with", "reml", "true", "which", "is", "necessary", "in", "order", "to", "get", "sensible", "answers", "when", "comparing", "models", "that", "di", "er", "in", "their", "xed", "ects", "this", "can", "be", "controlled", "via", "the", "refitargument", "computing", "pvalues", "one", "of", "the", "more", "controversial", "design", "decisions", "of", "lme4has", "been", "to", "omit", "the", "output", "of", "pvalues", "associated", "with", "sequential", "anova", "decompositions", "of", "xed", "ects", "the", "absence", "of", "analytical", "results", "for", "null", "distributions", "of", "parameter", "estimates", "in", "complex", "situations", "unbalanced", "or", "partially", "crossed", "designs", "is", "long", "standing", "problem", "in", "mixed", "model", "inference", "while", "the", "null", "distributions", "and", "the", "sampling", "distributions", "of", "non", "null", "estimates", "are", "asymptotically", "normal", "these", "distributions", "are", "not", "tdistributed", "for", "nite", "size", "samples", "nor", "are", "the", "corre", "sponding", "null", "distributions", "of", "di", "erences", "in", "scaled", "deviances", "fdistributed", "thus", "approximate", "methods", "for", "computing", "the", "approximate", "degrees", "of", "freedom", "for", "tdistributions", "or", "the", "denom", "inator", "degrees", "of", "freedom", "for", "fstatistics", "satterthwaite", "1946", "kenward", "and", "roger", "1997", "are", "at", "bestad", "hocsolutions", "however", "computing", "nite", "size", "corrected", "pvalues", "is", "sometimes", "necessary", "therefore", "although", "the", "package", "does", "not", "provide", "them", "except", "via", "parametric", "bootstrapping", "section", "we", "have", "provided", "help", "page", "to", "guide", "users", "in", "nding", "appropriate", "methods", "help", "pvalues", "journal", "of", "statistical", "software", "35", "this", "help", "page", "provides", "pointers", "to", "other", "packages", "that", "provide", "machinery", "for", "calculating", "pvalues", "associated", "with", "mermod", "objects", "it", "also", "suggests", "framing", "the", "inference", "problem", "as", "likelihood", "ratio", "test", "achieved", "by", "supplying", "multiple", "mermod", "objects", "to", "the", "anovamethod", "as", "well", "as", "alternatives", "to", "pvalues", "such", "as", "con", "dence", "intervals", "previous", "versions", "of", "lme4provided", "the", "mcmcsamp", "function", "which", "generated", "markov", "chain", "monte", "carlo", "sample", "from", "the", "posterior", "distribution", "of", "the", "parameters", "assuming", "at", "priors", "due", "to", "di", "culty", "in", "constructing", "version", "of", "mcmcsamp", "that", "was", "reliable", "even", "in", "cases", "where", "the", "estimated", "random", "ects", "variances", "were", "near", "zero", "mcmcsamp", "has", "been", "withdrawn", "computing", "con", "dence", "intervals", "as", "described", "above", "section", "lme4provides", "con", "dence", "intervals", "using", "confint", "via", "wald", "approximations", "for", "xed", "ects", "parameters", "only", "likelihood", "pro", "ling", "or", "parametric", "bootstrapping", "the", "boot", "type", "argument", "selects", "the", "bootstrap", "con", "dence", "interval", "type", "as", "is", "typical", "for", "computationally", "intensive", "pro", "le", "con", "dence", "intervals", "in", "the", "intervals", "can", "be", "computed", "either", "directly", "from", "tted", "mermod", "objects", "in", "which", "case", "pro", "ling", "is", "done", "as", "an", "interim", "step", "or", "from", "previously", "computed", "likelihood", "pro", "le", "of", "class", "thpr", "for", "theta", "pro", "le", "parametric", "bootstrapping", "con", "dence", "intervals", "use", "thin", "wrapper", "around", "thebootmer", "function", "that", "passes", "the", "results", "to", "boot", "ci", "from", "the", "bootpackage", "canty", "and", "ripley", "2015", "davison", "and", "hinkley", "1997", "for", "con", "dence", "interval", "calculation", "in", "the", "running", "sleep", "study", "example", "the", "95", "con", "dence", "intervals", "estimated", "by", "all", "three", "methods", "are", "quite", "similar", "the", "largest", "change", "is", "26", "di", "erence", "in", "con", "dence", "interval", "widths", "between", "pro", "le", "and", "parametric", "bootstrap", "methods", "for", "the", "correlation", "between", "the", "intercept", "and", "slope", "random", "ects", "54", "98", "vs", "48", "68", "general", "pro", "le", "zeta", "and", "related", "plots", "lme4provides", "several", "functions", "built", "on", "latticegraphics", "sarkar", "2008", "for", "plotting", "the", "pro", "le", "zeta", "functions", "section", "and", "other", "related", "quantities", "thepro", "le", "zeta", "plot", "figure", "xyplot", "is", "simply", "plot", "of", "the", "pro", "le", "zeta", "function", "for", "each", "model", "parameter", "linearity", "of", "this", "plot", "for", "given", "parameter", "implies", "that", "the", "likelihood", "pro", "le", "is", "quadratic", "and", "thus", "that", "wald", "approximations", "would", "be", "reasonably", "accurate", "thepro", "le", "density", "plot", "figure", "densityplot", "displays", "an", "approximation", "of", "the", "probability", "density", "function", "of", "the", "sampling", "distribution", "for", "each", "parameter", "these", "densities", "are", "derived", "by", "setting", "the", "cumulative", "distribution", "function", "to", "be", "where", "is", "the", "of", "the", "standard", "normal", "distribution", "this", "is", "not", "quite", "the", "same", "as", "evaluating", "the", "distribution", "of", "the", "estimator", "of", "the", "parameter", "which", "for", "mixed", "models", "can", "be", "very", "di", "cult", "but", "it", "gives", "reasonable", "approximation", "if", "the", "pro", "le", "zeta", "plot", "is", "linear", "then", "the", "pro", "le", "density", "plot", "will", "be", "gaussian", "thepro", "le", "pairs", "plot", "figure", "splom", "gives", "an", "approximation", "of", "the", "two", "dimensional", "pro", "les", "of", "pairs", "of", "parameters", "interpolated", "from", "the", "univariate", "pro", "les", "as", "described", "in", "bates", "and", "watts", "1988", "chapter", "the", "pro", "le", "pairs", "plot", "shows", "two", "dimensional", "50", "80", "90", "95", "and", "99", "marginal", "con", "dence", "regions", "based", "on", "the", "likelihood", "ratio", "as", "well", "as", "the", "pro", "le", "traces", "which", "indicate", "the", "conditional", "estimates", "of", "each", "parameter", "36", "linear", "mixed", "models", "with", "lme4", "1012", "20", "30", "40", "10", "32224262830", "240", "250", "260", "270", "intercept", "68101214", "1012days", "figure", "pro", "le", "zeta", "plot", "xyplot", "prof", "obj", "for", "xed", "values", "of", "the", "other", "parameters", "while", "panels", "above", "the", "diagonal", "show", "pro", "les", "withrespecttotheoriginalparameters", "withrandom", "ectsparametersonthestandard", "deviation", "correlation", "scale", "as", "for", "all", "pro", "le", "plots", "the", "panels", "below", "the", "diagonal", "show", "plots", "on", "the", "scale", "the", "below", "diagonal", "panels", "allow", "us", "to", "see", "distortions", "from", "an", "elliptical", "shape", "due", "to", "nonlinearity", "of", "the", "traces", "separately", "from", "the", "one", "dimensional", "distortions", "caused", "by", "poor", "choice", "of", "scale", "for", "the", "parameters", "the", "scales", "provide", "in", "some", "sense", "the", "best", "possible", "set", "of", "single", "parameter", "transformations", "for", "assessing", "the", "contours", "on", "the", "scales", "the", "extent", "of", "contour", "on", "the", "horizontal", "axis", "is", "exactly", "the", "same", "as", "the", "extent", "on", "the", "vertical", "axis", "and", "both", "are", "centered", "about", "zero", "for", "users", "who", "want", "to", "build", "their", "own", "graphical", "displays", "of", "the", "pro", "le", "there", "is", "method", "for", "as", "data", "frame", "that", "converts", "pro", "le", "thpr", "objects", "to", "more", "convenient", "format", "computing", "tted", "and", "predicted", "values", "simulating", "because", "mixed", "models", "involve", "random", "coe", "cients", "one", "must", "always", "clarify", "whether", "predic", "tions", "should", "be", "based", "on", "the", "marginal", "distribution", "of", "the", "response", "variable", "or", "on", "the", "distri", "bution", "that", "is", "conditional", "on", "the", "modes", "of", "the", "random", "ects", "equation", "12", "the", "fitted", "method", "retrieves", "tted", "values", "that", "are", "conditional", "on", "all", "of", "the", "modes", "of", "the", "random", "ects", "thepredict", "method", "returns", "the", "same", "values", "by", "default", "but", "also", "allows", "for", "predictions", "to", "be", "made", "conditional", "on", "di", "erent", "sets", "of", "random", "ects", "for", "example", "if", "the", "re", "form", "argument", "is", "set", "to", "null", "the", "default", "then", "the", "predictions", "are", "conditional", "on", "all", "random", "ects", "in", "the", "model", "if", "re", "form", "is", "0orna", "then", "the", "predictions", "are", "made", "at", "the", "population", "level", "all", "random", "ects", "values", "set", "to", "zero", "in", "models", "with", "multiple", "random", "ects", "the", "user", "can", "give", "re", "form", "as", "formula", "that", "speci", "es", "which", "random", "ects", "are", "conditioned", "on", "lme4also", "provides", "simulate", "method", "which", "allows", "similar", "exibility", "in", "conditioning", "on", "journal", "of", "statistical", "software", "37", "density", "000", "020", "040", "06", "1020304050", "00", "20", "40", "60", "81", "01", "00", "10", "20", "46810", "30", "000", "050", "100", "150", "200", "25", "2224262830", "000", "010", "020", "030", "040", "050", "06", "230240250260270", "intercept", "000", "050", "100", "150", "200", "25", "6810121416days", "figure", "pro", "le", "density", "plot", "densityplot", "prof", "obj", "random", "ects", "in", "addition", "it", "allows", "the", "user", "to", "choose", "via", "the", "use", "uargument", "between", "conditioning", "on", "the", "tted", "conditional", "modes", "or", "choosing", "new", "set", "of", "simulated", "condi", "tional", "modes", "zero", "mean", "normal", "deviates", "chosen", "according", "to", "the", "estimated", "random", "ects", "variance", "covariance", "matrices", "finally", "the", "simulate", "method", "has", "method", "for", "formula", "objects", "which", "allows", "for", "de", "novo", "simulation", "in", "the", "absence", "of", "tted", "model", "in", "this", "case", "the", "user", "must", "specify", "the", "random", "ects", "xed", "ects", "and", "residual", "standard", "devia", "tion", "parameters", "via", "the", "newparams", "argument", "the", "standard", "simulation", "method", "based", "on", "mermod", "object", "is", "the", "basis", "of", "parametric", "bootstrapping", "section", "and", "posterior", "predictive", "simulation", "section", "de", "novosimulation", "based", "on", "formula", "provides", "exible", "framework", "for", "power", "analysis", "conclusion", "mixed", "modeling", "is", "an", "extremely", "useful", "but", "computationally", "intensive", "technique", "computa", "tional", "limitations", "are", "especially", "important", "because", "mixed", "models", "are", "commonly", "applied", "to", "moderately", "large", "data", "sets", "104", "106observations", "by", "developing", "an", "cient", "general", "and", "now", "well", "documented", "platform", "for", "tted", "mixed", "models", "in", "we", "hope", "to", "provide", "both", "practical", "tool", "for", "end", "users", "interested", "in", "analyzing", "data", "and", "reusable", "modular", "framework", "for", "downstream", "developers", "interested", "in", "extending", "the", "class", "of", "models", "that", "can", "be", "easily", "and", "ciently", "analyzed", "in", "wehavelearnedmuchaboutlinearmixedmodelsintheprocessofdeveloping", "lme4", "bothfrom", "our", "own", "attempts", "to", "develop", "robust", "and", "reliable", "procedures", "and", "from", "the", "broad", "community", "oflme4users", "we", "have", "attempted", "to", "describe", "many", "of", "these", "lessons", "here", "in", "moving", "forward", "our", "main", "priorities", "are", "to", "maintain", "the", "reference", "implementation", "of", "lme4on", "the", "compre", "38", "linear", "mixed", "models", "with", "lme4", "scatter", "plot", "matrix", "sig011020304050", "10", "sig02", "50", "00", "51", "51", "0123", "sig03", "46810810", "0123", "sigma", "2224262830262830", "0123", "intercept", "230240250260270250260270", "0123days", "6810121416", "0123", "figure", "pro", "le", "pairs", "plot", "splom", "prof", "obj", "hensive", "rarchive", "network", "cran", "developing", "relatively", "few", "new", "features", "to", "improve", "the", "exibility", "ciency", "and", "scalability", "of", "mixed", "model", "analysis", "across", "multiple", "compatible", "implementations", "including", "both", "the", "mixedmodels", "package", "for", "juliaand", "the", "experimental", "exlambda", "branch", "of", "lme4", "acknowledgments", "rune", "haubo", "christensen", "henrik", "singmann", "fabian", "scheipl", "vincent", "dorie", "and", "bin", "dai", "contributed", "ideas", "and", "code", "to", "the", "current", "version", "of", "lme4", "the", "large", "community", "of", "lme4", "users", "has", "exercised", "the", "software", "discovered", "bugs", "and", "made", "many", "useful", "suggestions", "ren", "jsgaardparticipatedinusefuldiscussionsandxixiaandchristianzinggexercisedthecode", "and", "reported", "problems", "we", "would", "like", "to", "thank", "the", "ban", "international", "research", "station", "for", "hosting", "working", "group", "on", "lme4", "and", "an", "nserc", "discovery", "grant", "and", "nserc", "postdoctoral", "fellowship", "for", "funding", "journal", "of", "statistical", "software", "39", "references", "bates", "2015", "mixedmodels", "ajuliapackage", "for", "fitting", "statistical", "mixed", "ects", "models", "juliapackage", "version", "22", "url", "https", "github", "com", "dmbates", "mixedmodels", "jl", "bates", "maechler", "2015", "matrix", "sparse", "and", "dense", "matrix", "classes", "and", "methods", "package", "version", "url", "http", "cran", "project", "org", "package", "matrix", "bates", "maechler", "bolker", "walker", "2015", "lme4", "linear", "mixed", "ects", "models", "using", "eigenand", "s4", "rpackage", "version", "10", "url", "http", "cran", "project", "org", "package", "lme4", "bates", "mullen", "km", "nash", "jc", "varadhan", "2014", "minqa", "derivative", "free", "optimization", "algorithms", "by", "quadratic", "approximation", "rpackage", "version", "url", "http", "cran", "project", "org", "package", "minqa", "bates", "walker", "2013", "lme4purer", "lme4in", "pure", "rpackage", "version", "url", "https", "github", "com", "lme4", "lme4purer", "bates", "dm", "debroy", "2004", "linear", "mixed", "models", "and", "penalized", "least", "squares", "journal", "of", "multivariate", "analysis", "91", "17", "doi", "10", "1016", "jmva", "2004", "04", "013", "bates", "dm", "watts", "dg", "1988", "nonlinear", "regression", "analysis", "and", "its", "applications", "john", "wiley", "sons", "hoboken", "nj", "doi", "10", "1002", "9780470316757", "belenky", "wesensten", "nj", "thorne", "dr", "thomas", "ml", "sing", "hc", "redmond", "dp", "russo", "mb", "balkin", "tj", "2003", "patterns", "of", "performance", "degradation", "and", "restoration", "during", "sleep", "restriction", "and", "subsequent", "recovery", "sleep", "dose", "response", "study", "journal", "of", "sleep", "research", "12", "12", "doi", "10", "1046", "1365", "2869", "2003", "00337", "bezanson", "karpinski", "shah", "vb", "edelman", "2012", "julia", "fast", "dynamic", "language", "for", "technical", "computing", "arxiv", "1209", "5145", "cs", "pl", "url", "http", "arxiv", "org", "abs", "1209", "5145", "bolker", "bm", "gardner", "maunder", "berg", "cw", "brooks", "comita", "crone", "cubaynes", "davies", "de", "valpine", "ford", "gimenez", "ry", "kim", "ej", "lennert", "cody", "magnusson", "martell", "nash", "nielsen", "regetz", "skaug", "zipkin", "2013", "strategies", "for", "fitting", "nonlinear", "ecological", "models", "in", "ad", "model", "builder", "and", "bugs", "methods", "in", "ecology", "and", "evolution", "501", "512", "doi", "10", "1111", "2041", "210x", "12044", "canty", "ripley", "2015", "boot", "bootstrap", "plus", "functions", "rpackage", "version", "17", "url", "http", "cran", "project", "org", "package", "boot", "chambers", "jm", "1993", "linear", "models", "in", "jm", "chambers", "tj", "hastie", "eds", "statistical", "models", "ins", "chapter", "pp", "95", "144", "chapman", "hall", "chen", "davis", "ta", "hager", "ww", "rajamanickam", "2008", "algorithm", "887", "cholmod", "supernodal", "sparse", "cholesky", "factorization", "and", "update", "downdate", "acm", "transactions", "on", "mathematical", "software", "35", "22", "22", "14", "doi", "10", "1145", "1391989", "1391995", "chung", "rabe", "hesketh", "dorie", "gelman", "liu", "2013", "nondegenerate", "penalized", "likelihoodestimatorforvarianceparametersinmultilevelmodels", "psychometrika", "78", "685", "709", "40", "linear", "mixed", "models", "with", "lme4", "cook", "rd", "weisberg", "1982", "residuals", "and", "in", "uence", "in", "regression", "chapman", "and", "hall", "new", "york", "davis", "2006", "direct", "methods", "for", "sparse", "linear", "systems", "siam", "philadelphia", "pa", "doi", "10", "1137", "9780898718881", "davis", "ta", "et", "al", "2015", "suitesparse", "suite", "of", "sparse", "matrix", "software", "version", "url", "http", "www", "suitesparse", "com", "davison", "ac", "hinkley", "dv", "1997", "bootstrap", "methods", "and", "their", "applications", "cambridge", "university", "press", "cambridge", "england", "doran", "bates", "bliese", "dowling", "2007", "estimating", "the", "multilevel", "rasch", "model", "with", "the", "lme4package", "journal", "of", "statistical", "software", "20", "18", "doi", "10", "18637", "jss", "v020", "i02", "dorie", "2015", "blme", "bayesian", "linear", "mixed", "ects", "models", "rpackage", "version", "url", "http", "cran", "project", "org", "package", "blme", "efron", "morris", "1977", "stein", "paradox", "in", "statistics", "scienti", "american", "236", "119", "127", "doi", "10", "1038", "scientificamerican0577", "119", "gelman", "2005", "analysis", "of", "variance", "why", "it", "is", "more", "important", "than", "ever", "the", "annals", "of", "statistics", "33", "53", "doi", "10", "1214", "009053604000001048", "gelman", "carlin", "jb", "stern", "hs", "dunson", "db", "vehtari", "rubin", "db", "2013", "bayesian", "data", "analysis", "crc", "press", "gelman", "hill", "2006", "data", "analysis", "using", "regression", "and", "multilevel", "hierarchical", "models", "cambridge", "university", "press", "cambridge", "england", "golub", "gh", "pereyra", "1973", "the", "di", "erentiation", "of", "pseudo", "inverses", "and", "nonlinear", "least", "squaresproblemswhosevariablesseparate", "siam", "journal", "on", "numerical", "analysis", "10", "413", "432", "doi", "10", "1137", "0710036", "guennebaud", "jacob", "and", "others", "2015", "eigen3", "url", "http", "eigen", "tuxfamily", "org", "henderson", "jr", "cr", "1982", "analysis", "of", "covariance", "in", "the", "mixed", "model", "higher", "level", "nonho", "mogeneous", "andrandomregressions", "biometrics", "38", "623", "640", "doi", "10", "2307", "2530044", "hornra", "zhangf", "2005", "basicpropertiesoftheschurcomplement", "infzhang", "ed", "the", "schur", "complement", "and", "its", "applications", "volume", "of", "numerical", "methods", "and", "algorithms", "pp", "17", "46", "springer", "verlag", "doi", "10", "1007", "387", "24273", "johnson", "sg", "2014", "the", "nloptnonlinear", "optimization", "package", "url", "http", "ab", "initio", "mit", "edu", "nlopt", "kenward", "mg", "roger", "jh", "1997", "small", "sample", "inference", "for", "fixed", "ects", "from", "restricted", "maximum", "likelihood", "biometrics", "53", "983", "997", "doi", "10", "2307", "2533558", "khatri", "cg", "rao", "cr", "1968", "solutions", "to", "some", "functional", "equations", "and", "their", "applications", "tocharacterizationofprobabilitydistributions", "sankhy", "the", "indian", "journal", "of", "statistics", "30", "167", "180", "journal", "of", "statistical", "software", "41", "klein", "neira", "2013", "nelder", "mead", "simplex", "optimization", "routine", "for", "large", "scale", "prob", "lems", "distributed", "memory", "implementation", "computational", "economics", "43", "447", "461", "doi", "10", "1007", "s10614", "013", "9377", "laird", "nm", "ware", "jh", "1982", "random", "ects", "models", "for", "longitudinal", "data", "biometrics", "38", "963", "974", "doi", "10", "2307", "2529876", "loy", "hofmann", "2014", "hlmdiag", "suite", "of", "diagnostics", "for", "hierarchical", "linear", "models", "inr", "journal", "of", "statistical", "software", "56", "28", "doi", "10", "18637", "jss", "v056", "i05", "nash", "jc", "varadhan", "2011", "unifying", "optimization", "algorithms", "to", "aid", "software", "system", "users", "optimxforr", "journal", "of", "statistical", "software", "43", "14", "doi", "10", "18637", "jss", "v043", "i09", "nieuwenhuis", "te", "grotenhuis", "pelzer", "2012", "in", "uence", "me", "tools", "for", "detecting", "in", "ential", "data", "in", "mixed", "ects", "models", "the", "rjournal", "38", "47", "pinheiro", "bates", "debroy", "sarkar", "rcore", "team", "2015", "nlme", "linear", "and", "nonlinear", "mixed", "ects", "models", "rpackage", "version", "122", "url", "http", "cran", "project", "org", "package", "nlme", "pinheiro", "jc", "bates", "dm", "1996", "unconstrained", "parametrizations", "for", "variance", "covariance", "matrices", "statistics", "and", "computing", "289", "296", "doi", "10", "1007", "bf00140873", "pinheiro", "jc", "bates", "dm", "2000", "mixed", "ects", "models", "in", "sands", "plus", "springer", "verlag", "powell", "mjd", "2009", "the", "bobyqa", "algorithm", "for", "bound", "constrained", "optimization", "with", "out", "derivatives", "technical", "report", "damtp", "2009", "na06", "centre", "for", "mathematical", "sci", "ences", "university", "of", "cambridge", "cambridge", "england", "url", "http", "www", "damtp", "cam", "ac", "uk", "user", "na", "na", "papers", "na2009", "06", "pdf", "rcore", "team", "2015", "language", "and", "environment", "for", "statistical", "computing", "rfounda", "tion", "for", "statistical", "computing", "vienna", "austria", "url", "http", "www", "project", "org", "nchez", "espigares", "ja", "oca", "2009", "an", "rimplementation", "of", "bootstrap", "procedures", "for", "mixed", "models", "conference", "presentation", "use", "accessed", "2014", "05", "25", "url", "http", "www", "project", "org", "conferences", "user", "2009", "slides", "sanchezespigares", "ocana", "pdf", "sarkar", "2008", "lattice", "multivariate", "data", "visualization", "with", "springer", "verlag", "new", "york", "url", "http", "lmdvr", "forge", "project", "org", "satterthwaite", "fe", "1946", "an", "approximate", "distribution", "of", "estimates", "of", "variance", "compo", "nents", "biometrics", "bulletin", "110", "114", "doi", "10", "2307", "3002019", "vaida", "blanchard", "2005", "conditional", "akaike", "information", "for", "mixed", "ects", "models", "biometrika", "92", "351", "370", "doi", "10", "1093", "biomet", "92", "351", "wood", "scheipl", "2014", "gamm4", "generalized", "additive", "mixed", "models", "using", "mgcvandlme4", "rpackage", "version", "url", "http", "cran", "project", "org", "package", "gamm4", "42", "linear", "mixed", "models", "with", "lme4", "modularization", "examples", "the", "modularized", "functions", "in", "lme4allow", "for", "ner", "control", "of", "the", "various", "steps", "in", "tting", "mixed", "models", "table", "the", "main", "advantage", "of", "these", "functions", "is", "the", "ability", "to", "extend", "the", "class", "of", "models", "that", "lmeris", "capable", "of", "tting", "in", "general", "there", "are", "three", "steps", "to", "this", "process", "construct", "mixed", "model", "formula", "that", "is", "similar", "to", "the", "intended", "model", "usingthemodularfunctions", "hookintoandmodifythe", "ttingprocesssothatthedesired", "model", "is", "estimated", "use", "the", "estimated", "parameter", "values", "to", "make", "inferences", "note", "that", "the", "many", "tools", "of", "the", "output", "module", "become", "unavailable", "for", "su", "ciently", "extensive", "departures", "from", "the", "class", "of", "models", "tted", "by", "lmer", "therefore", "this", "last", "inference", "step", "may", "be", "more", "involved", "in", "the", "modular", "approach", "than", "with", "inference", "from", "models", "tted", "by", "lmer", "here", "we", "provide", "two", "examples", "that", "illustrate", "this", "process", "zero", "slope", "slope", "covariance", "models", "consider", "the", "following", "mixed", "model", "formula", "form", "respvar", "explvar1", "explvar2", "groupfac", "in", "which", "we", "have", "xed", "intercept", "and", "two", "random", "ects", "terms", "each", "with", "random", "slope", "andintercept", "the", "lmerfunction", "would", "thisformula", "todata", "byestimating", "anunstructured", "3covariance", "matrix", "giving", "the", "variances", "and", "covariances", "among", "the", "intercept", "and", "the", "two", "slopes", "it", "is", "not", "possible", "to", "use", "the", "current", "version", "of", "lmerto", "model", "with", "the", "following", "two", "properties", "the", "slopes", "are", "uncorrelated", "and", "the", "intercept", "is", "correlated", "with", "both", "of", "the", "slopes", "we", "illustrate", "the", "use", "of", "the", "modular", "functions", "in", "lme4to", "such", "model", "simulate", "from", "zero", "slope", "slope", "covariance", "model", "we", "simulate", "data", "from", "such", "model", "using", "balanced", "design", "with", "single", "grouping", "factor", "we", "uselme4", "utilities", "for", "constructing", "template", "from", "the", "model", "formula", "with", "which", "to", "conduct", "these", "simulations", "we", "simulate", "balanced", "design", "with", "500", "levels", "to", "the", "grouping", "factor", "and", "20", "observations", "per", "group", "set", "seed", "dat", "mkdatatemplate", "form", "ngrps", "500", "npergrp", "20", "rfunc", "rnorm", "head", "dat", "groupfac", "respvar", "explvar1", "explvar2", "6264538", "8043316", "2353485", "1836433", "0565257", "2448250", "8356286", "0353958", "6421869", "5952808", "1855604", "9348085", "3295078", "5004395", "0386957", "8204684", "5249887", "2835501", "journal", "of", "statistical", "software", "43", "the", "initial", "parameters", "for", "this", "model", "may", "be", "obtained", "using", "mkparstemplate", "pars", "mkparstemplate", "form", "dat", "beta", "intercept", "theta", "groupfac", "intercept", "groupfac", "explvar1", "intercept", "groupfac", "explvar2", "intercept", "groupfac", "explvar1", "groupfac", "explvar2", "explvar1", "groupfac", "explvar2", "sigma", "we", "wish", "to", "simulate", "random", "ects", "from", "the", "following", "covariance", "matrix", "vc", "matrix", "here", "the", "intercept", "is", "correlated", "with", "each", "of", "the", "two", "slopes", "but", "the", "slopes", "are", "uncorre", "lated", "the", "thetavector", "that", "corresponds", "to", "this", "covariance", "matrix", "can", "be", "computed", "using", "lme4", "facilities", "for", "converting", "between", "various", "representations", "of", "co", "variance", "structures", "see", "vcconv", "pars", "theta", "vv", "to", "cv", "mlist2vec", "vc", "with", "these", "new", "parameters", "installed", "we", "simulate", "response", "variable", "dat", "respvar", "simulate", "form", "newdata", "dat", "newparams", "pars", "family", "gaussian", "indeed", "this", "data", "set", "appears", "to", "contain", "intercept", "slope", "correlations", "but", "not", "slope", "slope", "cor", "relations", "as", "we", "see", "using", "the", "lmlistfunction", "formlm", "form", "formlm", "findbars", "form", "print", "formlm", "respvar", "explvar1", "explvar2", "groupfac", "cor", "sapply", "lmlist", "formlm", "dat", "coef", "intercept", "explvar1", "explvar2", "intercept", "0000000", "52889639", "42648559", "explvar1", "5288964", "00000000", "06094783", "explvar2", "4264856", "06094783", "00000000", "44", "linear", "mixed", "models", "with", "lme4", "this", "lmlistfunction", "computes", "ordinary", "linear", "models", "for", "each", "level", "of", "the", "grouping", "factor", "next", "we", "show", "how", "to", "proper", "mixed", "model", "to", "these", "data", "fitting", "zero", "slope", "slope", "covariance", "model", "the", "main", "challenge", "with", "tting", "zero", "slope", "slope", "model", "is", "the", "need", "to", "gure", "out", "which", "cholesky", "decompositions", "correspond", "to", "variance", "covariance", "matrices", "with", "structural", "zeros", "between", "the", "slopes", "there", "are", "two", "general", "approaches", "to", "solving", "this", "problem", "the", "rst", "is", "to", "reorder", "the", "rows", "and", "columns", "of", "the", "covariance", "matrix", "so", "that", "the", "intercept", "column", "comes", "last", "in", "this", "case", "setting", "the", "second", "component", "of", "the", "covariance", "parameter", "vector", "to", "zero", "will", "achieve", "the", "desired", "covariance", "structure", "however", "we", "consider", "second", "approach", "which", "retains", "the", "ordering", "produced", "by", "the", "lformula", "function", "intercept", "rst", "slope", "and", "second", "slope", "the", "covariance", "structure", "for", "the", "random", "ects", "in", "this", "model", "is", "given", "by", "the", "following", "covariance", "matrix", "and", "its", "associated", "cholesky", "decomposition", "12", "13", "21", "20", "31", "10", "40", "69", "where", "the", "parameters", "give", "the", "standard", "deviations", "and", "covariances", "and", "the", "parameters", "are", "the", "elements", "of", "the", "cholesky", "decomposition", "the", "key", "feature", "of", "this", "covariance", "matrix", "is", "the", "structural", "zero", "indicating", "no", "covariance", "between", "the", "two", "slopes", "therefore", "in", "order", "to", "ensure", "the", "structural", "zero", "we", "must", "have", "70", "to", "represent", "this", "restriction", "in", "rwe", "introduce", "length", "ve", "vector", "phi", "which", "we", "convert", "into", "an", "appropriate", "thetavector", "using", "the", "following", "function", "phitotheta", "function", "phi", "theta5", "phi", "phi", "phi", "phi", "theta5", "phi", "we", "may", "therefore", "optimize", "the", "structured", "model", "by", "optimizing", "over", "phiinstead", "of", "theta", "we", "begin", "to", "construct", "an", "appropriate", "objective", "function", "for", "such", "an", "optimization", "by", "taking", "the", "rst", "two", "modular", "steps", "resulting", "in", "deviance", "function", "of", "theta", "lf", "lformula", "formula", "form", "data", "dat", "reml", "true", "devf", "do", "call", "mklmerdevfun", "lf", "this", "deviance", "function", "is", "function", "of", "the", "unconstrained", "thetavector", "but", "we", "require", "deviance", "function", "of", "the", "constrained", "phivector", "we", "therefore", "construct", "wrapper", "around", "the", "deviance", "function", "as", "follows", "devfwrap", "function", "phi", "devf", "phitotheta", "phi", "finally", "we", "optimize", "the", "deviance", "function", "journal", "of", "statistical", "software", "45", "opt", "bobyqa", "par", "lf", "retrms", "theta", "fn", "devfwrap", "lower", "lf", "retrms", "lower", "to", "extract", "and", "label", "the", "estimated", "covariance", "matrix", "of", "the", "random", "ects", "we", "may", "use", "the", "conversion", "functions", "vcconv", "and", "the", "column", "names", "of", "the", "random", "ects", "model", "matrix", "cnms", "we", "construct", "this", "estimated", "matrix", "and", "compare", "it", "with", "the", "true", "matrix", "used", "to", "simulate", "the", "data", "vcest", "vec2mlist", "cv", "to", "vv", "phitotheta", "opt", "par", "dimnames", "vcest", "rep", "lf", "retrms", "cnms", "round", "vcest", "groupfac", "groupfac", "intercept", "explvar1", "explvar2", "intercept", "00", "57", "42", "explvar1", "57", "11", "00", "explvar2", "42", "00", "99", "vc", "we", "see", "that", "the", "estimated", "covariance", "matrix", "provides", "good", "estimate", "of", "the", "true", "matrix", "additive", "models", "it", "is", "possible", "to", "interpret", "additive", "models", "as", "particular", "class", "of", "mixed", "models", "wood", "and", "scheipl", "2014", "the", "main", "bene", "of", "this", "approach", "is", "that", "it", "bypasses", "the", "need", "to", "select", "smoothness", "parameter", "using", "cross", "validation", "or", "generalized", "cross", "validation", "however", "it", "is", "inconvenient", "to", "specify", "additive", "models", "using", "the", "lme4formula", "interface", "the", "gamm4", "package", "wraps", "the", "modularized", "functions", "of", "lme4within", "more", "convenient", "interface", "wood", "and", "scheipl", "2014", "in", "particular", "the", "strategy", "involves", "the", "following", "steps", "convert", "gamm4formula", "into", "an", "lme4formula", "that", "approximates", "the", "intended", "model", "parse", "this", "formula", "using", "lformula", "modify", "the", "resulting", "transposed", "random", "ects", "model", "matrix", "latticetop", "so", "that", "the", "intended", "additive", "model", "results", "fit", "the", "resulting", "model", "using", "the", "remaining", "modularized", "functions", "table", "here", "we", "illustrate", "this", "general", "strategy", "using", "simple", "simulated", "data", "set", "46", "linear", "mixed", "models", "with", "lme4", "50", "00", "51", "xyfitted", "generating", "figure", "data", "and", "predictions", "from", "the", "generating", "and", "tted", "model", "library", "gamm4", "library", "splines", "set", "seed", "100", "psimulation", "pstatistical", "rnorm", "bsimulation", "ns", "psimulation", "bstatistical", "ns", "pstatistical", "beta", "rnorm", "psimulation", "as", "numeric", "bsimulation", "beta", "rnorm", "sd", "where", "psimulation", "isthenumberofcolumnsinthesimulationmodelmatrixand", "pstatistical", "is", "the", "number", "of", "columns", "in", "the", "statistical", "model", "matrix", "weplottheresultingdataalongwiththepredictionsfromthegeneratingmodel", "seefigure6", "par", "mar", "las", "bty", "plot", "las", "lines", "order", "bsimulation", "beta", "order", "we", "now", "set", "up", "an", "approximate", "lme4model", "formula", "and", "parse", "it", "using", "lformula", "pseudogroups", "as", "factor", "rep", "pstatistical", "length", "parsedformula", "lformula", "pseudogroups", "we", "now", "insert", "spline", "basis", "into", "the", "parsedformula", "object", "parsedformula", "retrms", "within", "parsedformula", "retrms", "bt", "as", "matrix", "bstatistical", "journal", "of", "statistical", "software", "47", "50", "00", "51", "xy", "figure", "data", "and", "predictions", "from", "the", "generating", "model", "cnms", "pseudogroups", "spline", "zt", "as", "bt", "class", "zt", "finally", "we", "continue", "with", "the", "remaining", "modular", "steps", "deviancefunction", "do", "call", "mklmerdevfun", "parsedformula", "optimizeroutput", "optimizelmer", "deviancefunction", "mspline", "mkmermod", "rho", "environment", "deviancefunction", "opt", "optimizeroutput", "retrms", "parsedformula", "retrms", "fr", "parsedformula", "fr", "mspline", "linear", "mixed", "model", "fit", "by", "reml", "quotesingle", "ts1lmermod", "quotesingle", "ts1", "reml", "criterion", "at", "convergence", "60", "734", "random", "effects", "groups", "name", "std", "dev", "pseudogroups", "spline", "2930", "residual", "3001", "number", "of", "obs", "100", "groups", "pseudogroups", "fixed", "effects", "intercept", "03712", "17137", "computing", "the", "tted", "values", "of", "this", "additive", "model", "requires", "some", "custom", "code", "and", "illustrates", "the", "general", "principle", "that", "methods", "for", "mermod", "objects", "constructed", "from", "modular", "ts", "should", "only", "be", "used", "if", "the", "user", "knows", "what", "she", "is", "doing", "48", "linear", "mixed", "models", "with", "lme4", "xnew", "seq", "min", "max", "length", "100", "newbstatistical", "predict", "bstatistical", "xnew", "yhat", "cbind", "xnew", "getme", "mspline", "fixef", "newbstatistical", "getme", "mspline", "par", "mar", "las", "bty", "plot", "lines", "xnew", "yhat", "lines", "order", "bsimulation", "beta", "order", "lty", "legend", "topright", "bty", "fitted", "generating", "lty", "col", "for", "the", "resulting", "plot", "see", "figure", "liation", "douglas", "bates", "department", "of", "statistics", "university", "of", "wisconsin", "1300", "university", "ave", "madison", "wi", "53706", "united", "states", "of", "america", "mail", "bates", "stat", "wisc", "edu", "martin", "chler", "seminar", "statistik", "hg", "16", "eth", "zurich", "8092", "zurich", "switzerland", "mail", "maechler", "stat", "math", "ethz", "ch", "benjamin", "bolker", "departments", "of", "mathematics", "statistics", "and", "biology", "mcmaster", "university", "1280", "main", "street", "hamilton", "on", "l8s", "4k1", "canada", "mail", "bolker", "mcmaster", "ca", "steven", "walker", "department", "of", "mathematics", "statistics", "mcmaster", "university", "1280", "main", "street", "hamilton", "on", "l8s", "4k1", "canada", "mail", "scwalker", "math", "mcmaster", "ca", "journal", "of", "statistical", "software", "http", "www", "jstatsoft", "org", "published", "by", "the", "foundation", "for", "open", "access", "statistics", "http", "www", "foastat", "org", "october", "2015", "volume", "67", "issue", "submitted", "2014", "06", "30", "doi", "10", "18637", "jss", "v067", "i01", "accepted", "2015", "01", "23"], "citations": ["[1]", "[3]", "[2]", "[4]", "[5]", "(Bates 2015)", "(Belenky et al.2003)", "(Chambers 1993)", "(Johnson\n2014)", "(Powell 2009)", "(Pinheiro et al.2015)", "(Bolker et al.2013)", "(Gelman et al.2013)", "Bates D (2015). MixedModels : AJuliaPackage for Fitting (Statistical) Mixed-Eects Models .", "Bates D, Maechler M (2015). Matrix: Sparse and Dense Matrix Classes and Methods .R", "Bates D, Maechler M, Bolker B, Walker S (2015). lme4: Linear Mixed-Eects Models Using", "Bates D, Mullen KM, Nash JC, Varadhan R (2014). minqa: Derivative-Free Optimization", "Bates D, Walker S (2013). lme4pureR :lme4in Pure R.Rpackage version 0.1-0, URL", "Bates DM, DebRoy S (2004). Linear Mixed Models and Penalized Least Squares. Journal", "of Multivariate Analysis ,91(1), 117. doi:10.1016/j.jmva.2004.04.013 .", "Bates DM, Watts DG (1988). Nonlinear Regression Analysis and Its Applications . John Wiley", "Balkin TJ (2003). Patterns of Performance Degradation and Restoration During Sleep", "Bezanson J, Karpinski S, Shah VB, Edelman A (2012).  Julia: A Fast Dynamic Language for", "A, Martell S, Nash J, Nielsen A, Regetz J, Skaug H, Zipkin E (2013). Strategies for Fitting", "Canty A, Ripley B (2015). boot: Bootstrap R(S-PLUS) Functions .Rpackage version 1.3-17,", "Chambers JM (1993). Linear Models. In JM Chambers, TJ Hastie (eds.), Statistical Models", "Chen Y, Davis TA, Hager WW, Rajamanickam S (2008). Algorithm 887: CHOLMOD ,", "Chung Y, Rabe-Hesketh S, Dorie V, Gelman A, Liu J (2013). A Nondegenerate Penalized", "Cook RD, Weisberg S (1982). Residuals and Inuence in Regression . Chapman and Hall,", "Davis T (2006). Direct Methods for Sparse Linear Systems . SIAM, Philadelphia, PA. doi:", "Davis TA, et al.(2015). SuiteSparse : A Suite of Sparse Matrix Software . Version 4.4-5, URL", "Davison AC, Hinkley DV (1997). Bootstrap Methods and Their Applications . Cambridge", "Doran H, Bates D, Bliese P, Dowling M (2007). Estimating the Multilevel Rasch Model:", "Dorie V (2015). blme: Bayesian Linear Mixed-Eects Models .Rpackage version 1.0-4, URL", "Efron B, Morris C (1977). Steins Paradox in Statistics. Scientic American ,236, 119127.", "Gelman A (2005). Analysis of Variance  Why It Is More Important than Ever. The Annals", "Gelman A, Carlin JB, Stern HS, Dunson DB, Vehtari A, Rubin DB (2013). Bayesian Data", "Gelman A, Hill J (2006). Data Analysis Using Regression and Multilevel/Hierarchical Models .", "Golub GH, Pereyra V (1973). The Dierentiation of Pseudo-Inverses and Nonlinear Least", "Guennebaud G, Jacob B, and others (2015). Eigen3. URL http://eigen.tuxfamily.org/ .", "Henderson Jr CR (1982). Analysis of Covariance in the Mixed Model: Higher-Level, Nonho-", "Johnson SG (2014). The NLoptNonlinear-Optimization Package. URL http://", "Kenward MG, Roger JH (1997). Small Sample Inference for Fixed Eects from Restricted", "Khatri CG, Rao CR (1968). Solutions to Some Functional Equations and Their Applications", "Klein K, Neira J (2013). Nelder-Mead Simplex Optimization Routine for Large-Scale Prob-", "Laird NM, Ware JH (1982). Random-Eects Models for Longitudinal Data. Biometrics ,", "Loy A, Hofmann H (2014).  HLMdiag : A Suite of Diagnostics for Hierarchical Linear Models", "Nash JC, Varadhan R (2011). Unifying Optimization Algorithms to Aid Software System", "Nieuwenhuis R, Te Grotenhuis M, Pelzer B (2012).  Inuence.ME : Tools for Detecting Inu-", "Pinheiro J, Bates D, DebRoy S, Sarkar D, RCore Team (2015). nlme: Linear and Nonlinear", "Pinheiro JC, Bates DM (1996). Unconstrained Parametrizations for Variance-Covariance", "Pinheiro JC, Bates DM (2000). Mixed-Eects Models in SandS-PLUS. Springer-Verlag.", "Powell MJD (2009). The BOBYQA Algorithm for Bound Constrained Optimization With-", "out Derivatives. Technical Report DAMTP 2009/NA06 , Centre for Mathematical Sci-", "RCore Team (2015). R: A Language and Environment for Statistical Computing .RFounda-", "Snchez-Espigares JA, Ocaa J (2009). An RImplementation of Bootstrap Procedures for", "Mixed Models. Conference presentation, use R! Accessed 2014-05-25, URL http://www.", "Sarkar D (2008). lattice: Multivariate Data Visualization with R. Springer-Verlag, New York.", "Satterthwaite FE (1946). An Approximate Distribution of Estimates of Variance Compo-", "Vaida F, Blanchard S (2005). Conditional Akaike Information for Mixed-Eects Models.", "Wood S, Scheipl F (2014). gamm4: Generalized Additive Mixed Models Using mgcvandlme4."]}
{"doc_id": 10, "url": "https://www.bmj.com/content/bmj/372/bmj.n71.full.pdf", "title": "The PRISMA 2020 statement: an updated guideline for reporting systematic reviews", "title_tokens": ["the", "prisma", "2020", "statement", "an", "updated", "guideline", "for", "reporting", "systematic", "reviews"], "page_rank": {"cited_by_count": 76381}}
{"doc_id": 11, "url": "http://dl.acm.org/ft_gateway.cfm?id=3065386&type=pdf", "title": "ImageNet classification with deep convolutional neural networks", "title_tokens": ["imagenet", "classification", "with", "deep", "convolutional", "neural", "networks"], "page_rank": {"cited_by_count": 75536}}
